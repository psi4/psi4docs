<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->






<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>psi4.driver.wrapper_database</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/psi4.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

    
    
     
        <script src="../../../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../../../_static/cloud.base.js"></script>
    

    
     
        <script src="../../../_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="../../../_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../../index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/_modules/psi4/driver/wrapper_database.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/9842f7b">1.7a1.dev134</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="../../../index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">psi4.driver.wrapper_database</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for psi4.driver.wrapper_database</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># @BEGIN LICENSE</span>
<span class="c1">#</span>
<span class="c1"># Psi4: an open-source quantum chemistry software package</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2007-2022 The Psi4 Developers.</span>
<span class="c1">#</span>
<span class="c1"># The copyrights for code used from other parties are included in</span>
<span class="c1"># the corresponding files.</span>
<span class="c1">#</span>
<span class="c1"># This file is part of Psi4.</span>
<span class="c1">#</span>
<span class="c1"># Psi4 is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU Lesser General Public License as published by</span>
<span class="c1"># the Free Software Foundation, version 3.</span>
<span class="c1">#</span>
<span class="c1"># Psi4 is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU Lesser General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU Lesser General Public License along</span>
<span class="c1"># with Psi4; if not, write to the Free Software Foundation, Inc.,</span>
<span class="c1"># 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="c1">#</span>
<span class="c1"># @END LICENSE</span>
<span class="c1">#</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module with database functionality.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;database&quot;</span><span class="p">,</span>
    <span class="s2">&quot;db&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DB_RGT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DB_RXN&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">psi4</span> <span class="kn">import</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">psi4.driver</span> <span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">psi4.driver</span> <span class="kn">import</span> <span class="n">p4util</span>
<span class="kn">from</span> <span class="nn">psi4.driver.driver</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># never import aliases into this file</span>


<span class="c1">#########################</span>
<span class="c1">##  Start of Database  ##</span>
<span class="c1">#########################</span>

<span class="n">DB_RGT</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">DB_RXN</span> <span class="o">=</span> <span class="p">{}</span>


<div class="viewcode-block" id="database"><a class="viewcode-back" href="../../../db.html#psi4.driver.wrapper_database.database">[docs]</a><span class="k">def</span> <span class="nf">database</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">db_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Function to access the molecule objects and reference energies of</span>
<span class="sd">    popular chemical databases.</span>

<span class="sd">    :aliases: db()</span>

<span class="sd">    :returns: (*float*) Mean absolute deviation of the database in kcal/mol</span>

<span class="sd">    :PSI variables:</span>

<span class="sd">    .. hlist::</span>
<span class="sd">       :columns: 1</span>

<span class="sd">       * :psivar:`db_name DATABASE MEAN SIGNED DEVIATION`</span>
<span class="sd">       * :psivar:`db_name DATABASE MEAN ABSOLUTE DEVIATION`</span>
<span class="sd">       * :psivar:`db_name DATABASE ROOT-MEAN-SQUARE DEVIATION`</span>
<span class="sd">       * Python dictionaries of results accessible as ``DB_RGT`` and ``DB_RXN``.</span>

<span class="sd">    .. note:: It is very easy to make a database from a collection of xyz files</span>
<span class="sd">        using the script :source:`psi4/share/psi4/scripts/ixyz2database.py`.</span>
<span class="sd">        See :ref:`sec:createDatabase` for details.</span>

<span class="sd">    .. caution:: Some features are not yet implemented. Buy a developer some coffee.</span>

<span class="sd">       - In sow/reap mode, use only global options (e.g., the local option set by ``set scf scf_type df`` will not be respected).</span>

<span class="sd">    .. note:: To access a database that is not embedded in a |PSIfour|</span>
<span class="sd">        distribution, add the path to the directory containing the database</span>
<span class="sd">        to the environment variable :envvar:`PYTHONPATH`.</span>

<span class="sd">    :type name: str</span>
<span class="sd">    :param name: ``&#39;scf&#39;`` || ``&#39;sapt0&#39;`` || ``&#39;ccsd(t)&#39;`` || etc.</span>

<span class="sd">        First argument, usually unlabeled. Indicates the computational method</span>
<span class="sd">        to be applied to the database. May be any valid argument to</span>
<span class="sd">        :py:func:`psi4.driver.energy`.</span>

<span class="sd">    :type db_name: str</span>
<span class="sd">    :param db_name: ``&#39;BASIC&#39;`` || ``&#39;S22&#39;`` || ``&#39;HTBH&#39;`` || etc.</span>

<span class="sd">        Second argument, usually unlabeled. Indicates the requested database</span>
<span class="sd">        name, matching (case insensitive) the name of a python file in</span>
<span class="sd">        ``psi4/share/databases`` or :envvar:`PYTHONPATH`.  Consult that</span>
<span class="sd">        directory for available databases and literature citations.</span>

<span class="sd">    :type func: :ref:`function &lt;op_py_function&gt;`</span>
<span class="sd">    :param func: |dl| ``energy`` |dr| || ``optimize`` || ``cbs``</span>

<span class="sd">        Indicates the type of calculation to be performed on each database</span>
<span class="sd">        member. The default performs a single-point ``energy(&#39;name&#39;)``, while</span>
<span class="sd">        ``optimize`` perfoms a geometry optimization on each reagent, and</span>
<span class="sd">        ``cbs`` performs a compound single-point energy. If a nested series</span>
<span class="sd">        of python functions is intended (see :ref:`sec:intercalls`), use</span>
<span class="sd">        keyword ``db_func`` instead of ``func``.</span>

<span class="sd">    :type mode: str</span>
<span class="sd">    :param mode: |dl| ``&#39;continuous&#39;`` |dr| || ``&#39;sow&#39;`` || ``&#39;reap&#39;``</span>

<span class="sd">        Indicates whether the calculations required to complete the</span>
<span class="sd">        database are to be run in one file (``&#39;continuous&#39;``) or are to be</span>
<span class="sd">        farmed out in an embarrassingly parallel fashion</span>
<span class="sd">        (``&#39;sow&#39;``/``&#39;reap&#39;``).  For the latter, run an initial job with</span>
<span class="sd">        ``&#39;sow&#39;`` and follow instructions in its output file.</span>

<span class="sd">    :type cp: :ref:`boolean &lt;op_py_boolean&gt;`</span>
<span class="sd">    :param cp: ``&#39;on&#39;`` || |dl| ``&#39;off&#39;`` |dr|</span>

<span class="sd">        Indicates whether counterpoise correction is employed in computing</span>
<span class="sd">        interaction energies. Use this option and NOT the ``bsse_type=&quot;cp&quot;``</span>
<span class="sd">        function for BSSE correction in database().  Option available</span>
<span class="sd">        (See :ref:`sec:availableDatabases`) only for databases of bimolecular complexes.</span>

<span class="sd">    :type rlxd: :ref:`boolean &lt;op_py_boolean&gt;`</span>
<span class="sd">    :param rlxd: ``&#39;on&#39;`` || |dl| ``&#39;off&#39;`` |dr|</span>

<span class="sd">        Indicates whether correction for deformation energy is</span>
<span class="sd">        employed in computing interaction energies.  Option available</span>
<span class="sd">        (See :ref:`sec:availableDatabases`) only for databases of bimolecular complexes</span>
<span class="sd">        with non-frozen monomers, e.g., HBC6.</span>

<span class="sd">    :type symm: :ref:`boolean &lt;op_py_boolean&gt;`</span>
<span class="sd">    :param symm: |dl| ``&#39;on&#39;`` |dr| || ``&#39;off&#39;``</span>

<span class="sd">        Indicates whether the native symmetry of the database reagents is</span>
<span class="sd">        employed (``&#39;on&#39;``) or whether it is forced to :math:`C_1` symmetry</span>
<span class="sd">        (``&#39;off&#39;``). Some computational methods (e.g., SAPT) require no</span>
<span class="sd">        symmetry, and this will be set by database().</span>

<span class="sd">    :type zpe: :ref:`boolean &lt;op_py_boolean&gt;`</span>
<span class="sd">    :param zpe: ``&#39;on&#39;`` || |dl| ``&#39;off&#39;`` |dr|</span>

<span class="sd">        Indicates whether zero-point-energy corrections are appended to</span>
<span class="sd">        single-point energy values. Option valid only for certain</span>
<span class="sd">        thermochemical databases. Disabled until Hessians ready.</span>

<span class="sd">    :type benchmark: str</span>
<span class="sd">    :param benchmark: |dl| ``&#39;default&#39;`` |dr| || ``&#39;S22A&#39;`` || etc.</span>

<span class="sd">        Indicates whether a non-default set of reference energies, if</span>
<span class="sd">        available (See :ref:`sec:availableDatabases`), are employed for the</span>
<span class="sd">        calculation of error statistics.</span>

<span class="sd">    :type tabulate: List[str]</span>
<span class="sd">    :param tabulate: |dl| ``[]`` |dr| || ``[&#39;scf total energy&#39;, &#39;natom&#39;]`` || etc.</span>

<span class="sd">        Indicates whether to form tables of variables other than the</span>
<span class="sd">        primary requested energy.  Available for any PSI variable.</span>

<span class="sd">    :type subset: Union[str, List[str]]</span>
<span class="sd">    :param subset:</span>

<span class="sd">        Indicates a subset of the full database to run. This is a very</span>
<span class="sd">        flexible option and can be used in three distinct ways, outlined</span>
<span class="sd">        below. Note that two take a string and the last takes an array.</span>
<span class="sd">        See :ref:`sec:availableDatabases` for available values.</span>

<span class="sd">        * ``&#39;small&#39;`` || ``&#39;large&#39;`` || ``&#39;equilibrium&#39;``</span>
<span class="sd">            Calls predefined subsets of the requested database, either</span>
<span class="sd">            ``&#39;small&#39;``, a few of the smallest database members,</span>
<span class="sd">            ``&#39;large&#39;``, the largest of the database members, or</span>
<span class="sd">            ``&#39;equilibrium&#39;``, the equilibrium geometries for a database</span>
<span class="sd">            composed of dissociation curves.</span>
<span class="sd">        * ``&#39;BzBz_S&#39;`` || ``&#39;FaOOFaON&#39;`` || ``&#39;ArNe&#39;`` ||  ``&#39;HB&#39;`` || etc.</span>
<span class="sd">            For databases composed of dissociation curves, or otherwise</span>
<span class="sd">            divided into subsets, individual curves and subsets can be</span>
<span class="sd">            called by name. Consult the database python files for available</span>
<span class="sd">            molecular systems (case insensitive).</span>
<span class="sd">        * ``[1,2,5]`` || ``[&#39;1&#39;,&#39;2&#39;,&#39;5&#39;]`` || ``[&#39;BzMe-3.5&#39;, &#39;MeMe-5.0&#39;]`` || etc.</span>
<span class="sd">            Specify a list of database members to run. Consult the</span>
<span class="sd">            database python files for available molecular systems.  This</span>
<span class="sd">            is the only portion of database input that is case sensitive;</span>
<span class="sd">            choices for this keyword must match the database python file.</span>

<span class="sd">    :examples:</span>

<span class="sd">    &gt;&gt;&gt; # [1] Two-stage SCF calculation on short, equilibrium, and long helium dimer</span>
<span class="sd">    &gt;&gt;&gt; db(&#39;scf&#39;,&#39;RGC10&#39;,cast_up=&#39;sto-3g&#39;,subset=[&#39;HeHe-0.85&#39;,&#39;HeHe-1.0&#39;,&#39;HeHe-1.5&#39;], tabulate=[&#39;scf total energy&#39;,&#39;natom&#39;])</span>

<span class="sd">    &gt;&gt;&gt; # [2] Counterpoise-corrected interaction energies for three complexes in S22</span>
<span class="sd">    &gt;&gt;&gt; #     Error statistics computed wrt an old benchmark, S22A</span>
<span class="sd">    &gt;&gt;&gt; database(&#39;mp2&#39;,&#39;S22&#39;,cp=1,subset=[16,17,8],benchmark=&#39;S22A&#39;)</span>

<span class="sd">    &gt;&gt;&gt; # [3] SAPT0 on the neon dimer dissociation curve</span>
<span class="sd">    &gt;&gt;&gt; db(&#39;sapt0&#39;,subset=&#39;NeNe&#39;,cp=0,symm=0,db_name=&#39;RGC10&#39;)</span>

<span class="sd">    &gt;&gt;&gt; # [4] Optimize system 1 in database S22, producing tables of scf and mp2 energy</span>
<span class="sd">    &gt;&gt;&gt; db(&#39;mp2&#39;,&#39;S22&#39;,db_func=optimize,subset=[1], tabulate=[&#39;mp2 total energy&#39;,&#39;current energy&#39;])</span>

<span class="sd">    &gt;&gt;&gt; # [5] CCSD on the smallest systems of HTBH, a hydrogen-transfer database</span>
<span class="sd">    &gt;&gt;&gt; database(&#39;ccsd&#39;,&#39;HTBH&#39;,subset=&#39;small&#39;, tabulate=[&#39;ccsd total energy&#39;, &#39;mp2 total energy&#39;])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lowername</span> <span class="o">=</span> <span class="n">name</span>  <span class="c1">#TODO</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">kwargs_lower</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Wrap any positional arguments into kwargs (for intercalls among wrappers)</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span> <span class="c1">#.lower()</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="s1">&#39;db_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="n">db_name</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;db_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">db_name</span>

    <span class="c1"># Establish function to call</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;db_func&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="n">energy</span><span class="p">))</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;db_func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
    <span class="c1"># Bounce to CP if bsse kwarg (someday)</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bsse_type&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database: Cannot specify bsse_type for database. Use the cp keyword withing database instead.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">allowoptexceeded</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;allowoptexceeded&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">optstash</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">OptionsState</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;WRITER_FILE_LABEL&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;SCF&#39;</span><span class="p">,</span> <span class="s1">&#39;REFERENCE&#39;</span><span class="p">])</span>

    <span class="c1"># Wrapper wholly defines molecule. discard any passed-in</span>
    <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;molecule&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Paths to search for database files: here + PSIPATH + library + PYTHONPATH</span>
    <span class="n">db_paths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">db_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
    <span class="n">db_paths</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PSIPATH&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">pathsep</span><span class="p">))</span>
    <span class="n">db_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">get_datadir</span><span class="p">(),</span> <span class="s1">&#39;databases&#39;</span><span class="p">))</span>
    <span class="n">db_paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
    <span class="n">db_paths</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">,</span> <span class="n">db_paths</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">db_paths</span>
    <span class="c1"># TODO this should be modernized a la interface_cfour</span>

    <span class="c1"># Define path and load module for requested database</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">import_ignorecase</span><span class="p">(</span><span class="n">db_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">database</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Python module for database </span><span class="si">%s</span><span class="s1"> failed to load</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Search path that was tried:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Python module loading problem for database &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dbse</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">dbse</span>
        <span class="n">HRXN</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN</span>
        <span class="n">ACTV</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">ACTV</span>
        <span class="n">RXNM</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">RXNM</span>
        <span class="n">BIND</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">BIND</span>
        <span class="n">TAGL</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">TAGL</span>
        <span class="n">GEOS</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">GEOS</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">DATA</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">DATA</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">DATA</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">user_writer_file_label</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">get_global_option</span><span class="p">(</span><span class="s1">&#39;WRITER_FILE_LABEL&#39;</span><span class="p">)</span>
    <span class="n">user_reference</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">get_global_option</span><span class="p">(</span><span class="s1">&#39;REFERENCE&#39;</span><span class="p">)</span>

    <span class="c1"># Configuration based upon e_name &amp; db_name options</span>
    <span class="c1">#   Force non-supramolecular if needed</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">lowername</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^.*sapt&#39;</span><span class="p">,</span> <span class="n">lowername</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">database</span><span class="o">.</span><span class="n">ACTV_SA</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Database </span><span class="si">%s</span><span class="s1"> not suitable for non-supramolecular calculation.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ACTV</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">ACTV_SA</span>
    <span class="c1">#   Force open-shell if needed</span>
    <span class="n">openshell_override</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">user_reference</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;RHF&#39;</span><span class="p">,</span> <span class="s1">&#39;RKS&#39;</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">database</span><span class="o">.</span><span class="n">isOS</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p4util</span><span class="o">.</span><span class="n">yes</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">isOS</span><span class="p">)):</span>
                <span class="n">openshell_override</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Some reagents in database </span><span class="si">%s</span><span class="s1"> require an open-shell reference; will be reset to UHF/UKS as needed.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>

    <span class="c1"># Configuration based upon database keyword options</span>
    <span class="c1">#   Option symmetry- whether symmetry treated normally or turned off (currently req&#39;d for dfmp2 &amp; dft)</span>
    <span class="n">db_symm</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;symm&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="n">symmetry_override</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">db_symm</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">symmetry_override</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">db_symm</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Symmetry mode &#39;</span><span class="si">%s</span><span class="s2">&#39; not valid.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_symm</span><span class="p">))</span>

    <span class="c1">#   Option mode of operation- whether db run in one job or files farmed out</span>
    <span class="n">db_mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;db_mode&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="s1">&#39;continuous&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;db_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">db_mode</span>

    <span class="k">if</span> <span class="n">db_mode</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">db_mode</span> <span class="o">==</span> <span class="s1">&#39;sow&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">db_mode</span> <span class="o">==</span> <span class="s1">&#39;reap&#39;</span><span class="p">:</span>
        <span class="n">db_linkage</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;linkage&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">db_linkage</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database execution mode &#39;reap&#39; requires a linkage option.&quot;&quot;&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Database execution mode &#39;</span><span class="si">%s</span><span class="s2">&#39; not valid.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_mode</span><span class="p">))</span>

    <span class="c1">#   Option counterpoise- whether for interaction energy databases run in bsse-corrected or not</span>
    <span class="n">db_cp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cp&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">db_cp</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">database</span><span class="o">.</span><span class="n">ACTV_CP</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Counterpoise correction mode &#39;yes&#39; invalid for database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ACTV</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">ACTV_CP</span>
    <span class="k">elif</span> <span class="n">db_cp</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Counterpoise correction mode &#39;</span><span class="si">%s</span><span class="s2">&#39; not valid.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_cp</span><span class="p">))</span>

    <span class="c1">#   Option relaxed- whether for non-frozen-monomer interaction energy databases include deformation correction or not?</span>
    <span class="n">db_rlxd</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rlxd&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">db_rlxd</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">db_cp</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">database</span><span class="o">.</span><span class="n">ACTV_CPRLX</span>
                <span class="n">database</span><span class="o">.</span><span class="n">RXNM_CPRLX</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Deformation and counterpoise correction mode </span><span class="se">\&#39;</span><span class="s1">yes</span><span class="se">\&#39;</span><span class="s1"> invalid for database </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ACTV</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">ACTV_CPRLX</span>
                <span class="n">RXNM</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">RXNM_CPRLX</span>
        <span class="k">elif</span> <span class="n">db_cp</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">database</span><span class="o">.</span><span class="n">ACTV_RLX</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Deformation correction mode </span><span class="se">\&#39;</span><span class="s1">yes</span><span class="se">\&#39;</span><span class="s1"> invalid for database </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ACTV</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">ACTV_RLX</span>
    <span class="k">elif</span> <span class="n">db_rlxd</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
    <span class="c1">#elif no.match(str(db_rlxd)):</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Deformation correction mode </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> not valid.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_rlxd</span><span class="p">))</span>

    <span class="c1">#   Option zero-point-correction- whether for thermochem databases jobs are corrected by zpe</span>
    <span class="n">db_zpe</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;zpe&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">db_zpe</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Zero-point-correction mode </span><span class="se">\&#39;</span><span class="s1">yes</span><span class="se">\&#39;</span><span class="s1"> not yet implemented.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">db_zpe</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Zero-point-correction </span><span class="se">\&#39;</span><span class="s1">mode</span><span class="se">\&#39;</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> not valid.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_zpe</span><span class="p">))</span>

    <span class="c1">#   Option benchmark- whether error statistics computed wrt alternate reference energies</span>
    <span class="n">db_benchmark</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;benchmark&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">db_benchmark</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;benchmark&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">db_benchmark</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BIND</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">getattr_ignorecase</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="s1">&#39;BIND_&#39;</span> <span class="o">+</span> <span class="n">db_benchmark</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">BIND</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;Special benchmark </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> not available for database </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_benchmark</span><span class="p">,</span> <span class="n">db_name</span><span class="p">))</span>

    <span class="c1">#   Option tabulate- whether tables of variables other than primary energy method are formed</span>
    <span class="c1"># TODO db(func=cbs,tabulate=[non-current-energy])  # broken</span>
    <span class="n">db_tabulate</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="s1">&#39;tabulate&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">db_tabulate</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tabulate&#39;</span><span class="p">]</span>

    <span class="c1">#   Option subset- whether all of the database or just a portion is run</span>
    <span class="n">db_subset</span> <span class="o">=</span> <span class="n">HRXN</span>
    <span class="k">if</span> <span class="s1">&#39;subset&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">db_subset</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;subset&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">db_subset</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">db_subset</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;small&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">database</span><span class="o">.</span><span class="n">HRXN_SM</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Special subset &#39;small&#39; not available for database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">HRXN</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN_SM</span>
        <span class="k">elif</span> <span class="n">db_subset</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;large&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">database</span><span class="o">.</span><span class="n">HRXN_LG</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Special subset &#39;large&#39; not available for database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">HRXN</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN_LG</span>
        <span class="k">elif</span> <span class="n">db_subset</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;equilibrium&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">database</span><span class="o">.</span><span class="n">HRXN_EQ</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Special subset &#39;equilibrium&#39; not available for database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">HRXN</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">HRXN_EQ</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">HRXN</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">getattr_ignorecase</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">db_subset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">HRXN</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">HRXN</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">getattr_ignorecase</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="s1">&#39;HRXN_&#39;</span> <span class="o">+</span> <span class="n">db_subset</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">HRXN</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Special subset &#39;</span><span class="si">%s</span><span class="s2">&#39; not available for database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_subset</span><span class="p">,</span> <span class="n">db_name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">db_subset</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
                <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Subset element &#39;</span><span class="si">%s</span><span class="s2">&#39; not a member of database </span><span class="si">%s</span><span class="s2">.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">),</span> <span class="n">db_name</span><span class="p">))</span>
        <span class="n">HRXN</span> <span class="o">=</span> <span class="n">temp</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dbse</span><span class="p">,</span> <span class="n">rxn</span><span class="p">)])</span>
    <span class="n">HSYS</span> <span class="o">=</span> <span class="n">p4util</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="p">[]))</span>

    <span class="c1"># Sow all the necessary reagent computations</span>
    <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">p4util</span><span class="o">.</span><span class="n">banner</span><span class="p">((</span><span class="s2">&quot;Database </span><span class="si">%s</span><span class="s2"> Computation&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">)))</span>
    <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1">#   write index of calcs to output file</span>
    <span class="n">instructions</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">    The database single-job procedure has been selected through mode=&#39;continuous&#39;.</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">instructions</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;    Calculations for the reagents will proceed in the order below and will be followed</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">instructions</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;    by summary results for the database.</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rgt</span> <span class="ow">in</span> <span class="n">HSYS</span><span class="p">:</span>
        <span class="n">instructions</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;                    </span><span class="si">%-s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rgt</span><span class="p">)</span>
    <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="n">instructions</span><span class="p">)</span>

    <span class="c1">#   Loop through chemical systems</span>
    <span class="n">ERGT</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ERXN</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">VRGT</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">VRXN</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">rgt</span> <span class="ow">in</span> <span class="n">HSYS</span><span class="p">:</span>
        <span class="n">VRGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">p4util</span><span class="o">.</span><span class="n">banner</span><span class="p">(</span><span class="s1">&#39; Database </span><span class="si">{}</span><span class="s1"> Computation: Reagent </span><span class="si">{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">   </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">db_name</span><span class="p">,</span> <span class="n">rgt</span><span class="p">,</span> <span class="n">TAGL</span><span class="p">[</span><span class="n">rgt</span><span class="p">]))</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">molecule</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">GEOS</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
        <span class="n">molecule</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">rgt</span><span class="p">)</span>
        <span class="n">molecule</span><span class="o">.</span><span class="n">update_geometry</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">symmetry_override</span><span class="p">:</span>
            <span class="n">molecule</span><span class="o">.</span><span class="n">reset_point_group</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">)</span>
            <span class="n">molecule</span><span class="o">.</span><span class="n">fix_orientation</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">molecule</span><span class="o">.</span><span class="n">fix_com</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">molecule</span><span class="o">.</span><span class="n">update_geometry</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">openshell_override</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">user_reference</span> <span class="o">==</span> <span class="s1">&#39;RHF&#39;</span><span class="p">:</span>
                <span class="n">core</span><span class="o">.</span><span class="n">set_global_option</span><span class="p">(</span><span class="s1">&#39;REFERENCE&#39;</span><span class="p">,</span> <span class="s1">&#39;UHF&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">user_reference</span> <span class="o">==</span> <span class="s1">&#39;RKS&#39;</span><span class="p">:</span>
                <span class="n">core</span><span class="o">.</span><span class="n">set_global_option</span><span class="p">(</span><span class="s1">&#39;REFERENCE&#39;</span><span class="p">,</span> <span class="s1">&#39;UKS&#39;</span><span class="p">)</span>

        <span class="n">core</span><span class="o">.</span><span class="n">set_global_option</span><span class="p">(</span><span class="s1">&#39;WRITER_FILE_LABEL&#39;</span><span class="p">,</span> <span class="n">user_writer_file_label</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">user_writer_file_label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">rgt</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allowoptexceeded</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ERGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="n">molecule</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ConvergenceError</span><span class="p">:</span>
                <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimization exceeded cycles for </span><span class="si">{</span><span class="n">rgt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">ERGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ERGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="n">molecule</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_variables</span><span class="p">()</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s2">&quot;   Database Contributions Map:</span><span class="se">\n</span><span class="s2">   </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">75</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
            <span class="n">db_rxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rgt</span> <span class="ow">in</span> <span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">]:</span>
                <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;   reagent </span><span class="si">{}</span><span class="s1"> contributes by </span><span class="si">{:.4f}</span><span class="s1"> to reaction </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rgt</span><span class="p">,</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">rgt</span><span class="p">],</span> <span class="n">db_rxn</span><span class="p">))</span>
        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">envv</span> <span class="ow">in</span> <span class="n">db_tabulate</span><span class="p">:</span>
            <span class="n">VRGT</span><span class="p">[</span><span class="n">rgt</span><span class="p">][</span><span class="n">envv</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="n">envv</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">set_global_option</span><span class="p">(</span><span class="s2">&quot;REFERENCE&quot;</span><span class="p">,</span> <span class="n">user_reference</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
        <span class="c1">#core.opt_clean()</span>
        <span class="n">core</span><span class="o">.</span><span class="n">clean_variables</span><span class="p">()</span>

    <span class="c1"># Reap all the necessary reaction computations</span>
    <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">p4util</span><span class="o">.</span><span class="n">banner</span><span class="p">((</span><span class="s2">&quot;Database </span><span class="si">%s</span><span class="s2"> Results&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">)))</span>
    <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">maxactv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
        <span class="n">maxactv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)]))</span>
    <span class="n">maxrgt</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">maxactv</span><span class="p">)</span>
    <span class="n">table_delimit</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">62</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">maxrgt</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="c1">#   find any reactions that are incomplete</span>
    <span class="n">FAIL</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
        <span class="n">db_rxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ERGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span> <span class="o">&lt;</span> <span class="mf">1.0e-12</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">allowoptexceeded</span><span class="p">:</span>
                    <span class="n">FAIL</span><span class="p">[</span><span class="n">rxn</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1">#   tabulate requested process::environment variables</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   For each VARIABLE requested by tabulate, a &#39;Reaction Value&#39; will be formed from</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   &#39;Reagent&#39; values according to weightings &#39;Wt&#39;, as for the REQUESTED ENERGY below.</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   Depending on the nature of the variable, this may or may not make any physical sense.</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
        <span class="n">db_rxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
        <span class="n">VRXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">envv</span> <span class="ow">in</span> <span class="n">db_tabulate</span><span class="p">:</span>
        <span class="n">envv</span> <span class="o">=</span> <span class="n">envv</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">   ==&gt; </span><span class="si">%s</span><span class="s2"> &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">envv</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="n">_tblhead</span><span class="p">(</span><span class="n">maxrgt</span><span class="p">,</span> <span class="n">table_delimit</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
            <span class="n">db_rxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">FAIL</span><span class="p">[</span><span class="n">rxn</span><span class="p">]:</span>
                <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2">   </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%8s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_rxn</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
                    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span><span class="si">%16.8f</span><span class="s2"> </span><span class="si">%2.0f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VRGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]][</span><span class="n">envv</span><span class="p">],</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">VRXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">envv</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
                    <span class="n">VRXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">envv</span><span class="p">]</span> <span class="o">+=</span> <span class="n">VRGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]][</span><span class="n">envv</span><span class="p">]</span> <span class="o">*</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>

                <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2">        </span><span class="si">%16.8f</span><span class="s2">                  &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_rxn</span><span class="p">,</span> <span class="n">VRXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">envv</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
                    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span><span class="si">%16.8f</span><span class="s2"> </span><span class="si">%2.0f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VRGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]][</span><span class="n">envv</span><span class="p">],</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">   </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_delimit</span><span class="p">)</span>

    <span class="c1">#   tabulate primary requested energy variable with statistics</span>
    <span class="n">count_rxn</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">minDerror</span> <span class="o">=</span> <span class="mf">100000.0</span>
    <span class="n">maxDerror</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">MSDerror</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">MADerror</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">RMSDerror</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">   ==&gt; </span><span class="si">%s</span><span class="s2"> &lt;==</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Requested Energy&#39;</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="n">_tblhead</span><span class="p">(</span><span class="n">maxrgt</span><span class="p">,</span> <span class="n">table_delimit</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rxn</span> <span class="ow">in</span> <span class="n">HRXN</span><span class="p">:</span>
        <span class="n">db_rxn</span> <span class="o">=</span> <span class="n">dbse</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">FAIL</span><span class="p">[</span><span class="n">rxn</span><span class="p">]:</span>
            <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2">   </span><span class="si">%8.4f</span><span class="s2"> </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%10s</span><span class="s2"> </span><span class="si">%10s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_rxn</span><span class="p">,</span> <span class="n">BIND</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">],</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
                <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span><span class="si">%16.8f</span><span class="s2"> </span><span class="si">%2.0f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ERGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ERXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
                <span class="n">ERXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ERGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">hartree2kcalmol</span> <span class="o">*</span> <span class="n">ERXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">]</span> <span class="o">-</span> <span class="n">BIND</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">]</span>

            <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2">   </span><span class="si">%8.4f</span><span class="s2"> </span><span class="si">%8.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_rxn</span><span class="p">,</span> <span class="n">BIND</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">],</span> <span class="n">constants</span><span class="o">.</span><span class="n">hartree2kcalmol</span> <span class="o">*</span> <span class="n">ERXN</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">],</span>
                <span class="n">error</span><span class="p">,</span> <span class="n">error</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">cal2J</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">])):</span>
                <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span><span class="si">%16.8f</span><span class="s2"> </span><span class="si">%2.0f</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ERGT</span><span class="p">[</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">RXNM</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">ACTV</span><span class="p">[</span><span class="n">db_rxn</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">minDerror</span><span class="p">):</span>
                <span class="n">minDerror</span> <span class="o">=</span> <span class="n">error</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">maxDerror</span><span class="p">):</span>
                <span class="n">maxDerror</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">MSDerror</span> <span class="o">+=</span> <span class="n">error</span>
            <span class="n">MADerror</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">RMSDerror</span> <span class="o">+=</span> <span class="n">error</span> <span class="o">*</span> <span class="n">error</span>
            <span class="n">count_rxn</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">   </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_delimit</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">count_rxn</span><span class="p">:</span>

        <span class="n">MSDerror</span> <span class="o">/=</span> <span class="nb">float</span><span class="p">(</span><span class="n">count_rxn</span><span class="p">)</span>
        <span class="n">MADerror</span> <span class="o">/=</span> <span class="nb">float</span><span class="p">(</span><span class="n">count_rxn</span><span class="p">)</span>
        <span class="n">RMSDerror</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">RMSDerror</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">count_rxn</span><span class="p">))</span>

        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%23s</span><span class="s2"> </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Minimal Dev&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">minDerror</span><span class="p">,</span> <span class="n">minDerror</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">cal2J</span><span class="p">)</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%23s</span><span class="s2"> </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Maximal Dev&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">maxDerror</span><span class="p">,</span> <span class="n">maxDerror</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">cal2J</span><span class="p">)</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%23s</span><span class="s2"> </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Mean Signed Dev&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">MSDerror</span><span class="p">,</span> <span class="n">MSDerror</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">cal2J</span><span class="p">)</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%23s</span><span class="s2"> </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Mean Absolute Dev&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">MADerror</span><span class="p">,</span> <span class="n">MADerror</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">cal2J</span><span class="p">)</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%23s</span><span class="s2"> </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;RMS Dev&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">RMSDerror</span><span class="p">,</span> <span class="n">RMSDerror</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">cal2J</span><span class="p">)</span>
        <span class="n">tables</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">table_delimit</span><span class="p">)</span>

        <span class="n">core</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> DATABASE MEAN SIGNED DEVIATION&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">),</span> <span class="n">MSDerror</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> DATABASE MEAN ABSOLUTE DEVIATION&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">),</span> <span class="n">MADerror</span><span class="p">)</span>
        <span class="n">core</span><span class="o">.</span><span class="n">set_variable</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> DATABASE ROOT-MEAN-SQUARE DEVIATION&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">db_name</span><span class="p">),</span> <span class="n">RMSDerror</span><span class="p">)</span>

        <span class="n">core</span><span class="o">.</span><span class="n">print_out</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span>
        <span class="n">finalenergy</span> <span class="o">=</span> <span class="n">MADerror</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">finalenergy</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">optstash</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>

    <span class="n">DB_RGT</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">DB_RGT</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">VRGT</span><span class="p">)</span>
    <span class="n">DB_RXN</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">DB_RXN</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">VRXN</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">finalenergy</span></div>


<span class="k">def</span> <span class="nf">_tblhead</span><span class="p">(</span><span class="n">tbl_maxrgt</span><span class="p">,</span> <span class="n">tbl_delimit</span><span class="p">,</span> <span class="n">ttype</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Function that prints the header for the changable-width results tables in db().</span>
<span class="sd">    *tbl_maxrgt* is the number of reagent columns the table must plan for. *tbl_delimit*</span>
<span class="sd">    is a string of dashes of the correct length to set off the table. *ttype* is 1 for</span>
<span class="sd">    tables comparing the computed values to the reference or 2 for simple tabulation</span>
<span class="sd">    and sum of the computed values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tbl_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;   </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tbl_delimit</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ttype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2"> </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%21s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Reaction&#39;</span><span class="p">,</span> <span class="s1">&#39;Reaction Energy&#39;</span><span class="p">,</span> <span class="s1">&#39;Reaction Error&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ttype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2">     </span><span class="si">%19s</span><span class="s2"> </span><span class="si">%17s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Reaction&#39;</span><span class="p">,</span> <span class="s1">&#39;Reaction Value&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tbl_maxrgt</span><span class="p">):</span>
        <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Reagent &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">ttype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%23s</span><span class="s2">   </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%8s</span><span class="s2"> </span><span class="si">%10s</span><span class="s2"> </span><span class="si">%10s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Ref&#39;</span><span class="p">,</span> <span class="s1">&#39;Calc&#39;</span><span class="p">,</span> <span class="s1">&#39;[kcal/mol]&#39;</span><span class="p">,</span> <span class="s1">&#39;[kJ/mol]&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ttype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="si">%65s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tbl_maxrgt</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ttype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;[Eh] Wt&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ttype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="si">%20s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;Value Wt&#39;</span><span class="p">)</span>
    <span class="n">tbl_str</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">   </span><span class="si">%s</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tbl_delimit</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tbl_str</span>

<span class="c1">##  Aliases  ##</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">database</span>

<span class="c1">#######################</span>
<span class="c1">##  End of Database  ##</span>
<span class="c1">#######################</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../../index.html" title="index">
          <img class="logo" src="../../../_static/psi4square.png" alt="Logo"/>
        </a></p><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="../../../search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../../../index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/_modules/psi4/driver/wrapper_database.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/9842f7b">1.7a1.dev134</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="../../../index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">psi4.driver.wrapper_database</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2007-2022, The Psi4 Project.
      Last updated on Monday, 05 December 2022 10:01PM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>