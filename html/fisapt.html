<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->





<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>F/I-SAPT: Functional Group and/or Intramolecular SAPT</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/psi4.css?v=5cda37dd" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="_static/documentation_options.js?v=2fca9341"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ADC: Ab Initio Polarization Propagator" href="adc.html" />
    <link rel="prev" title="SAPT: Symmetry-Adapted Perturbation Theory" href="sapt.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="adc.html" title="ADC: Ab Initio Polarization Propagator"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="sapt.html" title="SAPT: Symmetry-Adapted Perturbation Theory"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/fisapt.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/b5f5dea">1.9a1.dev43</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="methods.html" accesskey="U">Theoretical Methods: SCF to FCI</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">F/I-SAPT: Functional Group and/or Intramolecular SAPT</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="f-i-sapt-functional-group-and-or-intramolecular-sapt">
<span id="sec-fisapt"></span><span id="index-0"></span><h1>F/I-SAPT: Functional Group and/or Intramolecular SAPT<a class="headerlink" href="#f-i-sapt-functional-group-and-or-intramolecular-sapt" title="Link to this heading">¶</a></h1>
<p><em>Code author: Robert M. Parrish</em></p>
<p><em>Section author: Robert M. Parrish</em></p>
<p><em>Module:</em> <a class="reference internal" href="autodir_options_c/module__fisapt.html#apdx-fisapt"><span class="std std-ref">Keywords</span></a>, <a class="reference internal" href="autodir_psivariables/module__fisapt.html#apdx-fisapt-psivar"><span class="std std-ref">PSI Variables</span></a>, <a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/src/psi4/fisapt">FISAPT</a></p>
<p>The FISAPT module provides two extensions to standard SAPT theory to allow for
(1) an effective two-body partition of the various SAPT terms to localized
chemical functional groups (F-SAPT) and (2) a means to compute the SAPT
interaction between two moieties within the embedding field of a third body
(I-SAPT). F-SAPT is designed to provide additional insight into the chemical
origins of a noncovalent interaction, while I-SAPT allows for one to perform
a SAPT analysis for intramolecular interactions. F-SAPT and I-SAPT can be
deployed together in this module, yielding “F/I-SAPT.” All F/I-SAPT computations
in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> use density-fitted SAPT0 as the underlying SAPT methodology. Interested
users should consult the manual page for Ed Hohenstein’s <a class="reference internal" href="sapt.html#sec-sapt"><span class="std std-ref">SAPT0</span></a> code
and the SAPT literature to understand the specifics of SAPT0 before beginning
with F/I-SAPT0.</p>
<p>F-SAPT is detailed over two papers: <a class="reference internal" href="bibliography.html#parrish-2014-044115" id="id1"><span>[Parrish:2014:044115]</span></a> on our much-earlier
“atomic” SAPT (A-SAPT) and <a class="reference internal" href="bibliography.html#parrish-2014-4417" id="id2"><span>[Parrish:2014:4417]</span></a> on the finished “functional
group” SAPT (F-SAPT). An additional paper describes how to use F-SAPT to analyze
differences under functional group substitutions <a class="reference internal" href="bibliography.html#parrish-2014-17386" id="id3"><span>[Parrish:2014:17386]</span></a>.  I-SAPT
is explained in <a class="reference internal" href="bibliography.html#parrish-2015-051103" id="id4"><span>[Parrish:2015:051103]</span></a>. There is also a reasonably-detailed
review of the aims of A/F/I-SAPT and the existing state-of-the-art in the field
in the introduction chapter on partitioned SAPT methods in <a class="reference external" href="https://smartech.gatech.edu/handle/1853/53850">Parrish’s thesis</a>.</p>
<p>The scripts discussed below are located in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/share/psi4/fsapt">psi4/psi4/share/psi4/fsapt</a>.</p>
<section id="f-sapt-a-representative-example">
<h2>F-SAPT: A Representative Example<a class="headerlink" href="#f-sapt-a-representative-example" title="Link to this heading">¶</a></h2>
<p>Below, we show an example of using F-SAPT0/jun-cc-pVDZ to analyze the
distribution of the intermolecular interaction energy components between the
various hydroxyl and phenyl moieties of the phenol dimer. This example is
explicitly included in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/fsapt1/input.dat">fsapt1</a>. A video
lecture explaining this example is available <a class="reference external" href="https://www.youtube.com/watch?v=J22J0wh4mVo&amp;index=1&amp;list=PLg_zUQpVYlA1Tc1X_HgAbqnFcHNydqN7W">F-SAPT#1</a>,
while an additional video describing how to plot the order-1 F-SAPT analysis
with PyMol and perform a “difference F-SAPT”
analysis is available <a class="reference external" href="https://www.youtube.com/watch?v=fqlzXsayec0&amp;index=2&amp;list=PLg_zUQpVYlA1Tc1X_HgAbqnFcHNydqN7W">F-SAPT#2</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span> <span class="mi">1</span> <span class="n">GB</span>

<span class="n">molecule</span> <span class="n">mol</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">O</span>    <span class="o">-</span><span class="mf">1.3885044</span>    <span class="mf">1.9298523</span>   <span class="o">-</span><span class="mf">0.4431206</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">0.5238121</span>    <span class="mf">1.9646519</span>   <span class="o">-</span><span class="mf">0.0064609</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">2.0071056</span>    <span class="mf">0.7638459</span>   <span class="o">-</span><span class="mf">0.1083509</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">1.4630807</span>   <span class="o">-</span><span class="mf">0.1519120</span>    <span class="mf">0.7949930</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">2.1475789</span>   <span class="o">-</span><span class="mf">1.3295094</span>    <span class="mf">1.0883677</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">3.3743208</span>   <span class="o">-</span><span class="mf">1.6031427</span>    <span class="mf">0.4895864</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">3.9143727</span>   <span class="o">-</span><span class="mf">0.6838545</span>   <span class="o">-</span><span class="mf">0.4091028</span>
<span class="n">C</span>    <span class="o">-</span><span class="mf">3.2370496</span>    <span class="mf">0.4929609</span>   <span class="o">-</span><span class="mf">0.7096126</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">0.5106510</span>    <span class="mf">0.0566569</span>    <span class="mf">1.2642563</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">1.7151135</span>   <span class="o">-</span><span class="mf">2.0321452</span>    <span class="mf">1.7878417</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">3.9024664</span>   <span class="o">-</span><span class="mf">2.5173865</span>    <span class="mf">0.7197947</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">4.8670730</span>   <span class="o">-</span><span class="mf">0.8822939</span>   <span class="o">-</span><span class="mf">0.8811319</span>
<span class="n">H</span>    <span class="o">-</span><span class="mf">3.6431662</span>    <span class="mf">1.2134345</span>   <span class="o">-</span><span class="mf">1.4057590</span>
<span class="o">--</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">O</span>     <span class="mf">1.3531168</span>    <span class="mf">1.9382724</span>    <span class="mf">0.4723133</span>
<span class="n">H</span>     <span class="mf">1.7842846</span>    <span class="mf">2.3487495</span>    <span class="mf">1.2297110</span>
<span class="n">C</span>     <span class="mf">2.0369747</span>    <span class="mf">0.7865043</span>    <span class="mf">0.1495491</span>
<span class="n">C</span>     <span class="mf">1.5904026</span>    <span class="mf">0.0696860</span>   <span class="o">-</span><span class="mf">0.9574153</span>
<span class="n">C</span>     <span class="mf">2.2417367</span>   <span class="o">-</span><span class="mf">1.1069765</span>   <span class="o">-</span><span class="mf">1.3128110</span>
<span class="n">C</span>     <span class="mf">3.3315674</span>   <span class="o">-</span><span class="mf">1.5665603</span>   <span class="o">-</span><span class="mf">0.5748636</span>
<span class="n">C</span>     <span class="mf">3.7696838</span>   <span class="o">-</span><span class="mf">0.8396901</span>    <span class="mf">0.5286439</span>
<span class="n">C</span>     <span class="mf">3.1224836</span>    <span class="mf">0.3383498</span>    <span class="mf">0.8960491</span>
<span class="n">H</span>     <span class="mf">0.7445512</span>    <span class="mf">0.4367983</span>   <span class="o">-</span><span class="mf">1.5218583</span>
<span class="n">H</span>     <span class="mf">1.8921463</span>   <span class="o">-</span><span class="mf">1.6649726</span>   <span class="o">-</span><span class="mf">2.1701843</span>
<span class="n">H</span>     <span class="mf">3.8330227</span>   <span class="o">-</span><span class="mf">2.4811537</span>   <span class="o">-</span><span class="mf">0.8566666</span>
<span class="n">H</span>     <span class="mf">4.6137632</span>   <span class="o">-</span><span class="mf">1.1850101</span>    <span class="mf">1.1092635</span>
<span class="n">H</span>     <span class="mf">3.4598854</span>    <span class="mf">0.9030376</span>    <span class="mf">1.7569489</span>
<span class="n">symmetry</span> <span class="n">c1</span>
<span class="n">no_reorient</span>
<span class="n">no_com</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="p">{</span>
<span class="n">basis</span>         <span class="n">jun</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span>
<span class="n">scf_type</span> <span class="n">df</span>
<span class="n">guess</span> <span class="n">sad</span>
<span class="n">freeze_core</span> <span class="n">true</span>
<span class="p">}</span>

<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;fisapt0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This file runs a DF-HF computation on the full dimer using <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s existing
SCF code. The monomer SCF computations are performed inside the FISAPT module,
following which a complete DF-SAPT0 computation is performed. Additional bits of
analysis are performed to generate the order-2 partition of the SAPT terms to
the level of nuclei and localized occupied orbitals – this generally does not
incur much additional overhead beyond a standard SAPT0 computations. The
nuclear/orbital partition data is written to the folder <code class="file docutils literal notranslate"><span class="pre">fsapt/</span></code> in the same
directory as the input file (this can be changed by <a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_FSAPT_FILEPATH-FISAPT"><span class="xref std std-term">FISAPT_FSAPT_FILEPATH</span></a>).</p>
<p>One obtains the desired F-SAPT partition by post-processing the data in
<code class="file docutils literal notranslate"><span class="pre">fsapt/</span></code>. Within this dir, the user is expected to provide the ASCII files
<code class="file docutils literal notranslate"><span class="pre">fA.dat</span></code> and <code class="file docutils literal notranslate"><span class="pre">fB.dat</span></code>, which describe the assignment of atoms to chemical
functional groups using 1-based ordering. <em>E.g.</em>, for the problem at hand,
<code class="file docutils literal notranslate"><span class="pre">fA.dat</span></code> contains:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">OH</span> <span class="mi">1</span> <span class="mi">2</span>
<span class="n">PH</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span>
</pre></div>
</div>
<p>while <code class="file docutils literal notranslate"><span class="pre">fB.dat</span></code> contains:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">OH</span> <span class="mi">14</span> <span class="mi">15</span>
<span class="n">PH</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span> <span class="mi">19</span> <span class="mi">20</span> <span class="mi">21</span> <span class="mi">22</span> <span class="mi">23</span> <span class="mi">24</span> <span class="mi">25</span> <span class="mi">26</span>
</pre></div>
</div>
<p>At this point, the user should run the <code class="docutils literal notranslate"><span class="pre">fsapt.py</span></code> post-processing script in
the <code class="docutils literal notranslate"><span class="pre">fsapt</span></code> directory as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fsapt</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>This will generate, among other files, the desired functional-group partition in
<code class="docutils literal notranslate"><span class="pre">fsapt.dat</span></code>. For our problem, the bottom of this file contains the finished
partition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Frag1</span>     <span class="n">Frag2</span>          <span class="n">Elst</span>      <span class="n">Exch</span>     <span class="n">IndAB</span>     <span class="n">IndBA</span>      <span class="n">Disp</span>     <span class="n">Total</span>
<span class="n">OH</span>        <span class="n">OH</span>           <span class="o">-</span><span class="mf">8.425</span>     <span class="mf">6.216</span>    <span class="o">-</span><span class="mf">0.583</span>    <span class="o">-</span><span class="mf">1.512</span>    <span class="o">-</span><span class="mf">1.249</span>    <span class="o">-</span><span class="mf">5.553</span>
<span class="n">OH</span>        <span class="n">PH</span>            <span class="mf">1.392</span>     <span class="mf">0.716</span>     <span class="mf">0.222</span>    <span class="o">-</span><span class="mf">0.348</span>    <span class="o">-</span><span class="mf">0.792</span>     <span class="mf">1.189</span>
<span class="n">PH</span>        <span class="n">OH</span>           <span class="o">-</span><span class="mf">2.742</span>     <span class="mf">0.749</span>    <span class="o">-</span><span class="mf">0.147</span>    <span class="o">-</span><span class="mf">0.227</span>    <span class="o">-</span><span class="mf">0.674</span>    <span class="o">-</span><span class="mf">3.040</span>
<span class="n">PH</span>        <span class="n">PH</span>            <span class="mf">0.680</span>     <span class="mf">2.187</span>     <span class="mf">0.007</span>    <span class="o">-</span><span class="mf">0.208</span>    <span class="o">-</span><span class="mf">2.400</span>     <span class="mf">0.266</span>
<span class="n">OH</span>        <span class="n">All</span>          <span class="o">-</span><span class="mf">7.033</span>     <span class="mf">6.931</span>    <span class="o">-</span><span class="mf">0.362</span>    <span class="o">-</span><span class="mf">1.860</span>    <span class="o">-</span><span class="mf">2.040</span>    <span class="o">-</span><span class="mf">4.364</span>
<span class="n">PH</span>        <span class="n">All</span>          <span class="o">-</span><span class="mf">2.062</span>     <span class="mf">2.936</span>    <span class="o">-</span><span class="mf">0.140</span>    <span class="o">-</span><span class="mf">0.435</span>    <span class="o">-</span><span class="mf">3.074</span>    <span class="o">-</span><span class="mf">2.774</span>
<span class="n">All</span>       <span class="n">OH</span>          <span class="o">-</span><span class="mf">11.167</span>     <span class="mf">6.965</span>    <span class="o">-</span><span class="mf">0.730</span>    <span class="o">-</span><span class="mf">1.739</span>    <span class="o">-</span><span class="mf">1.923</span>    <span class="o">-</span><span class="mf">8.594</span>
<span class="n">All</span>       <span class="n">PH</span>            <span class="mf">2.072</span>     <span class="mf">2.903</span>     <span class="mf">0.229</span>    <span class="o">-</span><span class="mf">0.556</span>    <span class="o">-</span><span class="mf">3.191</span>     <span class="mf">1.456</span>
<span class="n">All</span>       <span class="n">All</span>          <span class="o">-</span><span class="mf">9.095</span>     <span class="mf">9.867</span>    <span class="o">-</span><span class="mf">0.501</span>    <span class="o">-</span><span class="mf">2.295</span>    <span class="o">-</span><span class="mf">5.114</span>    <span class="o">-</span><span class="mf">7.138</span>
</pre></div>
</div>
<p>Note that the assignment of linking sigma bond contributions is a small point of
ambiguity in F-SAPT. The <code class="docutils literal notranslate"><span class="pre">fsapt.dat</span></code> file presents the “links-by-charge”
assignment at the top and the “links by 50-50” assignment at the bottom. We
generally prefer the latter, but both generally give qualitatively identical
energetic partitions.</p>
<p>Users should check the files <code class="docutils literal notranslate"><span class="pre">fragA.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">fragB.dat</span></code> to ensure that
there is not too much charge delocalization from one fragment to another. This
is presented in the “Orbital Check” section in these files – a value larger than
0.1 docc is an indication that the picture of localizable functional groups may
be breaking down. We also <em>strongly discourage</em> the cutting of double,
triple, or aromatic bonding motifs when partitioning the molecule into fragments
– cuts across only simple sigma bonds are encouraged.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>November 2022, previous to QCEngine v0.26.0 and Psi4
v1.7.0, there was a scaling inconsistency in the pairwise analysis
such that <a class="reference internal" href="glossary_psivariables.html#psivar-2-BODY-PAIRWISE-DISPERSION-CORRECTION-ANALYSIS"><code class="xref std std-psivar docutils literal notranslate"><span class="pre">2-BODY</span> <span class="pre">PAIRWISE</span> <span class="pre">DISPERSION</span> <span class="pre">CORRECTION</span> <span class="pre">ANALYSIS</span></code></a>
was doubled when generated from dftd3 compared to the output from other
programs (s-dftd3 and dftd4). This shows up in the QCVariable and in the
<code class="docutils literal notranslate"><span class="pre">Empirical_Disp.dat</span></code> file written during <code class="docutils literal notranslate"><span class="pre">energy(&quot;fisapt0-d3&quot;)</span></code> (all
-D3 variants). Fortunately, the <code class="docutils literal notranslate"><span class="pre">fsapt.py</span></code> script compensated
for dftd3 (by far the most used program for this task). Users of the
pairwise analysis should take care to use the new QCEngine
AND <code class="docutils literal notranslate"><span class="pre">fsapt.py</span></code> script distributed with NEW Psi4. <code class="docutils literal notranslate"><span class="pre">fisapt0-d4</span></code> run
with previous Psi4/fsapt.py will be wrong. <code class="docutils literal notranslate"><span class="pre">fisapt0-d3</span></code> run with previous
Psi4/fsapt.py but new QCEngine will be wrong. If you’ve got legacy
calculations, it is extremely easy to check or reanalyze them to
salvage them, so please contact the developers with the circumstances
for guidance.</p>
</div>
</section>
<section id="order-1-visualization-with-pymol">
<h2>Order-1 Visualization with PyMol<a class="headerlink" href="#order-1-visualization-with-pymol" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">fsapt.py</span></code> script above also generates a number of order-1 <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> files
that can be used to get a quick qualitative picture of the F-SAPT partition. The
preferred way to do this is to use PyMol to make plots of the molecular geometry
with the atoms colored according to their order-1 F-SAPT contributions. We have
a set of template <code class="docutils literal notranslate"><span class="pre">.pymol</span></code> scripts to help with this process. These can be
obtained by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy_pymol</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>and then in PyMol:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@run</span><span class="o">.</span><span class="n">pymol</span>
</pre></div>
</div>
<p>This last command runs all of the individual <code class="docutils literal notranslate"><span class="pre">.pymol</span></code> files (<em>e.g.</em>,
<code class="docutils literal notranslate"><span class="pre">Elst.pymol</span></code>), which in turn load in the molecule and order-1 analysis
(contained in the <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> file), set up the visualization, and render a
<code class="docutils literal notranslate"><span class="pre">.png</span></code> image of the scene. Generally the view orientation and some specific
details of the <code class="docutils literal notranslate"><span class="pre">.pymol</span></code> files require some small tweaks to permit
publication-quality renderings.</p>
<a class="reference internal image-reference" href="_images/Total.png"><img alt="Total Order-1 F-SAPT0" class="align-center" src="_images/Total.png" style="width: 360.0px; height: 360.0px;" /></a>
</section>
<section id="difference-f-sapt-analysis">
<h2>Difference F-SAPT Analysis<a class="headerlink" href="#difference-f-sapt-analysis" title="Link to this heading">¶</a></h2>
<p>For those interested in taking the differences between two F-SAPT partitions
(<em>e.g.</em>, to see how a substituent modulates a noncovalent interaction), we have
the <code class="docutils literal notranslate"><span class="pre">fsapt-diff.py</span></code> script to help with this. This is invoked as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fsapt</span><span class="o">-</span><span class="n">diff</span><span class="o">.</span><span class="n">py</span> <span class="n">source</span><span class="o">-</span><span class="n">fsapt</span><span class="o">-</span><span class="n">dir1</span> <span class="n">source</span><span class="o">-</span><span class="n">fsapt</span><span class="o">-</span><span class="n">dir2</span> <span class="n">target</span><span class="o">-</span><span class="n">diff</span><span class="o">-</span><span class="n">fsapt</span><span class="o">-</span><span class="nb">dir</span>
</pre></div>
</div>
<p>Where the use has already performed <code class="docutils literal notranslate"><span class="pre">fsapt.py</span></code> analysis using the same
functional group names in <code class="docutils literal notranslate"><span class="pre">source-fsapt-dir-1</span></code> and <code class="docutils literal notranslate"><span class="pre">source-fsapt-dir-2</span></code>. The
difference F-SAPT partition entries are computed as <span class="math notranslate nohighlight">\(E^{\Delta} = E^{1} -
E^{2}\)</span>, and the geometries for order-1 <code class="docutils literal notranslate"><span class="pre">.pdb</span></code> visualization files are taken
from system 1.</p>
</section>
<section id="i-sapt-a-representative-example">
<h2>I-SAPT: A Representative Example<a class="headerlink" href="#i-sapt-a-representative-example" title="Link to this heading">¶</a></h2>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>As of April 2018, you can’t specify molecule fragments
with an unphysical multiplicity like the singlet OH fragments in
the molecule below, especially as (again in the example below) the
overall molecule needs to be a singlet, which <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> doesn’t at
present let be set independently. For situations like this, use the
temporary input pattern in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/isapt1/input.dat">isapt1</a> .</p>
</div>
<p>Below, we show an example of using I-SAPT0/jun-cc-pVDZ to analyze the
interaction between the two phenol groups in a 2,4-pentanediol molecule.
This example is
explicitly included in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/isapt1/input.dat">isapt1</a>. A video
lecture explaining this example is available
<a class="reference external" href="https://www.youtube.com/watch?v=fD6mu_tTG_c&amp;index=3&amp;list=PLg_zUQpVYlA1Tc1X_HgAbqnFcHNydqN7W">I-SAPT#1</a>,
while an additional video describing how to plot the density and ESP fields from
the I-SAPT embedding procedure is available <a class="reference external" href="https://www.youtube.com/watch?v=hDbonAOD5dY&amp;index=4&amp;list=PLg_zUQpVYlA1Tc1X_HgAbqnFcHNydqN7W">I-SAPT#2</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span> <span class="mi">1</span> <span class="n">GB</span>

<span class="n">molecule</span> <span class="n">mol</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">O</span>          <span class="mf">0.39987</span>        <span class="mf">2.94222</span>       <span class="o">-</span><span class="mf">0.26535</span>
<span class="n">H</span>          <span class="mf">0.05893</span>        <span class="mf">2.05436</span>       <span class="o">-</span><span class="mf">0.50962</span>
<span class="o">--</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">O</span>          <span class="mf">0.48122</span>        <span class="mf">0.30277</span>       <span class="o">-</span><span class="mf">0.77763</span>
<span class="n">H</span>          <span class="mf">0.26106</span>       <span class="o">-</span><span class="mf">0.50005</span>       <span class="o">-</span><span class="mf">1.28451</span>
<span class="o">--</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">C</span>          <span class="mf">2.33048</span>       <span class="o">-</span><span class="mf">1.00269</span>        <span class="mf">0.03771</span>
<span class="n">C</span>          <span class="mf">1.89725</span>        <span class="mf">0.31533</span>       <span class="o">-</span><span class="mf">0.59009</span>
<span class="n">C</span>          <span class="mf">2.28232</span>        <span class="mf">1.50669</span>        <span class="mf">0.29709</span>
<span class="n">C</span>          <span class="mf">1.82204</span>        <span class="mf">2.84608</span>       <span class="o">-</span><span class="mf">0.29432</span>
<span class="n">C</span>          <span class="mf">2.37905</span>        <span class="mf">4.02099</span>        <span class="mf">0.49639</span>
<span class="n">H</span>          <span class="mf">3.41246</span>       <span class="o">-</span><span class="mf">1.03030</span>        <span class="mf">0.19825</span>
<span class="n">H</span>          <span class="mf">2.05362</span>       <span class="o">-</span><span class="mf">1.84372</span>       <span class="o">-</span><span class="mf">0.60709</span>
<span class="n">H</span>          <span class="mf">1.82714</span>       <span class="o">-</span><span class="mf">1.16382</span>        <span class="mf">0.99734</span>
<span class="n">H</span>          <span class="mf">2.36243</span>        <span class="mf">0.42333</span>       <span class="o">-</span><span class="mf">1.57636</span>
<span class="n">H</span>          <span class="mf">3.36962</span>        <span class="mf">1.51414</span>        <span class="mf">0.43813</span>
<span class="n">H</span>          <span class="mf">1.81251</span>        <span class="mf">1.38060</span>        <span class="mf">1.28140</span>
<span class="n">H</span>          <span class="mf">2.14344</span>        <span class="mf">2.92967</span>       <span class="o">-</span><span class="mf">1.33843</span>
<span class="n">H</span>          <span class="mf">3.47320</span>        <span class="mf">4.02400</span>        <span class="mf">0.48819</span>
<span class="n">H</span>          <span class="mf">2.03535</span>        <span class="mf">3.99216</span>        <span class="mf">1.53635</span>
<span class="n">H</span>          <span class="mf">2.02481</span>        <span class="mf">4.96785</span>        <span class="mf">0.07455</span>
<span class="n">symmetry</span> <span class="n">c1</span>
<span class="n">no_reorient</span>
<span class="n">no_com</span>
<span class="p">}</span>

<span class="c1"># =&gt; Standard Options &lt;= #</span>

<span class="nb">set</span> <span class="p">{</span>
<span class="n">basis</span> <span class="n">jun</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span>
<span class="n">scf_type</span> <span class="n">df</span>
<span class="n">guess</span> <span class="n">sad</span>
<span class="n">freeze_core</span> <span class="n">true</span>
<span class="n">fisapt_do_plot</span> <span class="n">true</span>  <span class="c1"># For extra analysis</span>
<span class="p">}</span>

<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;fisapt0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is essentially the same input as for F-SAPT, except that the molecular
system is now divided into <em>three</em> moieties – subsystems A and B whose
intramolecular interaction we wish to compute, and a linking unit C.  This file
runs a DF-HF computation on the full system using <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s existing SCF code.
At the start of the FISAPT code, the occupied orbitals are localized and divided
by charge considerations into A, B, C, and link sets. By default, linking sigma
bonds are assigned to C (this can be changed by the <a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_LINK_ASSIGNMENT-FISAPT"><span class="xref std std-term">FISAPT_LINK_ASSIGNMENT</span></a>
options). Then, non-interacting Hartree–Fock solutions for A and B are optimized
in the embedding field of the linking moiety C. At this point, A and B are not
interacting with each other, but have any potential covalent links or other
interactions with C built in by the embedding.  A standard F-SAPT0 computation
is then performed between A and B, yielding the I-SAPT interaction energy. Any
F-SAPT considerations are also possible when I-SAPT is performed – F and I are
completely direct-product-separable considerations.</p>
</section>
<section id="cube-file-visualization-with-pymol">
<h2>Cube File Visualization with PyMol<a class="headerlink" href="#cube-file-visualization-with-pymol" title="Link to this heading">¶</a></h2>
<p>Setting <a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_DO_PLOT-FISAPT"><span class="xref std std-term">FISAPT_DO_PLOT</span></a> <code class="docutils literal notranslate"><span class="pre">true</span></code> above generates a set of <code class="docutils literal notranslate"><span class="pre">.cube</span></code> files
containing the densities and ESPs of the various subsystems in the I-SAPT
embedding procedure. These can be used to gain a detailed understanding of the
intermolecular partition and the polarization between non-interacting and
Hartree–Fock-interacting moieties. We have developed a set of template
<code class="docutils literal notranslate"><span class="pre">.pymol</span></code> scripts to help with this process. These can be obtained by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy_pymol2</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>and then in PyMol:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@run</span><span class="o">.</span><span class="n">pymol</span>
</pre></div>
</div>
<p>This last command runs all of the individual <code class="docutils literal notranslate"><span class="pre">.pymol</span></code> files (<em>e.g.</em>,
<code class="docutils literal notranslate"><span class="pre">DA.pymol</span></code>), which in turn load in the molecule and cube file data
(contained in the <code class="docutils literal notranslate"><span class="pre">.cube</span></code> file), set up the visualization, and render a
<code class="docutils literal notranslate"><span class="pre">.png</span></code> image of the scene. Generally the view orientation and some specific
details of the <code class="docutils literal notranslate"><span class="pre">.pymol</span></code> files require some small tweaks to permit
publication-quality renderings.</p>
<a class="reference internal image-reference" href="_images/VA.png"><img alt="ESP of monomer A" class="align-center" src="_images/VA.png" style="width: 600.0px; height: 400.0px;" /></a>
</section>
<section id="adding-point-charges-to-f-i-sapt-computations">
<h2>Adding Point Charges to F/I-SAPT Computations<a class="headerlink" href="#adding-point-charges-to-f-i-sapt-computations" title="Link to this heading">¶</a></h2>
<p>Point charges can be added to the interacting subsystems A and B as well
as to the <code class="docutils literal notranslate"><span class="pre">linking</span></code> fragment C. Briefly, the interaction between the point charges in A(B)
and fragment B(A) enters the SAPT0 interaction energy. It explicitly affects the electrostatics
and induction components, and implicitly affects other SAPT0 components by polarizing the orbitals.
If point charges are present in both subsystems A and B, an additional charge-charge interaction
term is also added to the electrostatic energy. When point charges are assigned to subsystem C, the point
charges in C only polarize the orbitals in both fragment A and B. However, the presence of charges in C does not
directly contribute to the SAPT0 interaction energy.</p>
<p>Examples <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/fsapt-ext-abc/input.dat">fsapt-ext-abc</a> and <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/fsapt-ext-abc2/input.dat">fsapt-ext-abc2</a>
illustrate the use of point charges in F/I-SAPT procedure.</p>
</section>
<section id="link-orbital-partitioning-in-i-sapt">
<h2>Link Orbital Partitioning in I-SAPT<a class="headerlink" href="#link-orbital-partitioning-in-i-sapt" title="Link to this heading">¶</a></h2>
<p>The assignment of the A-C and B-C linking electron pairs is controlled by the <a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_LINK_ASSIGNMENT-FISAPT"><span class="xref std std-term">FISAPT_LINK_ASSIGNMENT</span></a>
keyword. The default setting <code class="docutils literal notranslate"><span class="pre">fisapt_link_assignment</span> <span class="pre">c</span></code> assigns the entire pair to the linker C together with
a +1 nuclear charge from the connecting atoms of A/B to preserve the electrical neutrality of each fragment.
However, as already noticed in <a class="reference internal" href="bibliography.html#parrish-2015-051103" id="id5"><span>[Parrish:2015:051103]</span></a>, such a partitioning might result in unphysical dipole
moments at the interfragment boundaries. Imagine, for example, that I-SAPT is used to examine the interaction
of two methyl groups connected by some linker fragment. When the linking bonds are assigned to C, the carbon atoms
of the methyl groups are missing electrons on one of their <em>sp^3</em> hybrid orbitals and a dipole moment appears.
These dipole moments have been observed to lead, in some cases, to I-SAPT energy contributions that do not make
physical sense, for example, to a strongly repulsive electrostatic energy between two fragments connected by an
intramolecular hydrogen bond.</p>
<p>To overcome this issue, Luu and Patkowski proposed a reassignment of the linking electron pairs so that each fragment
(C and A/B) gets one electron <a class="reference internal" href="bibliography.html#luu-2023-356" id="id6"><span>[Luu:2023:356]</span></a>. This electron is placed on a hybrid orbital of the connecting atom
pointing in the direction of the interfragment bond. Several schemes for determining this link hybrid were proposed
in <a class="reference internal" href="bibliography.html#luu-2023-356" id="id7"><span>[Luu:2023:356]</span></a> and they all are implemented in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>. We recommend the so-called <em>SIAO1</em> scheme,
<code class="docutils literal notranslate"><span class="pre">fisapt_link_assignment</span> <span class="pre">siao1</span></code>, as it has been observed to provide consistently meaningful I-SAPT terms and a
smooth basis set convergence. The SIAO1 name implies that the projection to construct the link hybrids happens in the
intrinsic atomic orbital space (as opposed to the SAO1 method where the standard atomic orbital space is used), with
one iteration of fragment orbital optimization and link orbital orthogonalization, a process that very quickly
achieves self-consistency. Altogether, the allowed values for <a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_LINK_ASSIGNMENT-FISAPT"><span class="xref std std-term">FISAPT_LINK_ASSIGNMENT</span></a> are <code class="docutils literal notranslate"><span class="pre">c</span></code> (default),
<code class="docutils literal notranslate"><span class="pre">ab</span></code> (the opposite of <code class="docutils literal notranslate"><span class="pre">c</span></code> where the entire linking pair is assigned to A/B), <code class="docutils literal notranslate"><span class="pre">sao0</span></code>, <code class="docutils literal notranslate"><span class="pre">sao1</span></code>, <code class="docutils literal notranslate"><span class="pre">sao2</span></code>,
<code class="docutils literal notranslate"><span class="pre">siao0</span></code>, <code class="docutils literal notranslate"><span class="pre">siao1</span></code> (recommended for all I-SAPT applications), and <code class="docutils literal notranslate"><span class="pre">siao2</span></code> (essentially identical to <code class="docutils literal notranslate"><span class="pre">siao1</span></code> but
slightly more expensive).</p>
<section id="advanced-i-sapt-keywords-for-saon-siaon-partitionings">
<h3>Advanced I-SAPT Keywords for SAOn/SIAOn Partitionings<a class="headerlink" href="#advanced-i-sapt-keywords-for-saon-siaon-partitionings" title="Link to this heading">¶</a></h3>
<section id="fisapt-link-ortho">
<h4><a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_LINK_ORTHO-FISAPT"><span class="xref std std-term">FISAPT_LINK_ORTHO</span></a><a class="headerlink" href="#fisapt-link-ortho" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Orthogonalization of link orbitals for FISAPT_LINK_ASSIGNMENT=SAOx/SIAOx Link A orthogonalized to A in whole (interacting) molecule or in the (noninteracting) fragment?</p>
<ul class="simple">
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Possible Values</strong>: FRAGMENT, WHOLE, NONE</p></li>
<li><p><strong>Default</strong>: FRAGMENT</p></li>
</ul>
</div></blockquote>
</section>
<section id="fisapt-exch-parperp">
<h4><a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_EXCH_PARPERP-FISAPT"><span class="xref std std-term">FISAPT_EXCH_PARPERP</span></a><a class="headerlink" href="#fisapt-exch-parperp" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Calculate separate exchange corrections for parallel and perpendicular spin coupling of link orbitals? When false, only the averaged out exchange corrections are computed.</p>
<ul class="simple">
<li><p><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">boolean</span></a></p></li>
<li><p><strong>Default</strong>: false</p></li>
</ul>
</div></blockquote>
</section>
<section id="fisapt-cube-linkibos">
<h4><a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_CUBE_LINKIBOS-FISAPT"><span class="xref std std-term">FISAPT_CUBE_LINKIBOS</span></a><a class="headerlink" href="#fisapt-cube-linkibos" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Generate cube files for unsplit link orbitals (IBOs)?</p>
<ul class="simple">
<li><p><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">boolean</span></a></p></li>
<li><p><strong>Default</strong>: false</p></li>
</ul>
</div></blockquote>
</section>
<section id="fisapt-cube-linkihos">
<h4><a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_CUBE_LINKIHOS-FISAPT"><span class="xref std std-term">FISAPT_CUBE_LINKIHOS</span></a><a class="headerlink" href="#fisapt-cube-linkihos" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Generate cube files for split link orbitals (IHOs)?</p>
<ul class="simple">
<li><p><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">boolean</span></a></p></li>
<li><p><strong>Default</strong>: false</p></li>
</ul>
</div></blockquote>
</section>
<section id="fisapt-cube-densmat">
<h4><a class="reference internal" href="autodoc_glossary_options_c.html#term-FISAPT_CUBE_DENSMAT-FISAPT"><span class="xref std std-term">FISAPT_CUBE_DENSMAT</span></a><a class="headerlink" href="#fisapt-cube-densmat" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>Generate cube files for fragment density matrices?</p>
<ul class="simple">
<li><p><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">boolean</span></a></p></li>
<li><p><strong>Default</strong>: false</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>
<section id="other-f-i-sapt-keywords">
<h2>Other F/I-SAPT Keywords<a class="headerlink" href="#other-f-i-sapt-keywords" title="Link to this heading">¶</a></h2>
<p>The input files described above cover roughly 90% of all F/I-SAPT analyses. For
more delicate or involved problems, there are a large number of user options
that permit the customization of the I-SAPT subsystem partition, the convergence
of the IBO localization procedure, numerical thresholds, etc. We have an entire
<a class="reference external" href="https://www.youtube.com/watch?v=KFkPKSUZVfI&amp;index=5&amp;list=PLg_zUQpVYlA1Tc1X_HgAbqnFcHNydqN7W">video tutorial devoted to F/I-SAPT Options</a> .
Direct source-code documentation on these options is available <a class="reference internal" href="autodir_options_c/module__fisapt.html#apdx-fisapt"><span class="std std-ref">here</span></a>.</p>
</section>
<section id="additional-notes">
<h2>Additional Notes<a class="headerlink" href="#additional-notes" title="Link to this heading">¶</a></h2>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In constrast to Ed Hohenstein’s SAPT0 code, FISAPT uses the -JKFIT
auxiliary basis sets for all Fock-type terms (<em>e.g.</em>, electrostatics, exchange,
induction, and core Fock matrix elements in exchange-dispersion), and the -RI
auxiliary basis sets <em>only</em> for the dispersion term. Ed’s code uses the -RI
basis sets for all SAPT terms, which can be problematic for heavy elements.
As such, Ed’s SAPT0 code will yield slightly different results than FISAPT. The
differences should be very minor for up to and including second-row elements,
after which point one needs to use the <a class="reference internal" href="autodoc_glossary_options_c.html#term-DF_BASIS_ELST-SAPT"><span class="xref std std-term">DF_BASIS_ELST</span></a> option in Ed’s code to
provide an accurate result.</p>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">F/I-SAPT: Functional Group and/or Intramolecular SAPT</a><ul>
<li><a class="reference internal" href="#f-sapt-a-representative-example">F-SAPT: A Representative Example</a></li>
<li><a class="reference internal" href="#order-1-visualization-with-pymol">Order-1 Visualization with PyMol</a></li>
<li><a class="reference internal" href="#difference-f-sapt-analysis">Difference F-SAPT Analysis</a></li>
<li><a class="reference internal" href="#i-sapt-a-representative-example">I-SAPT: A Representative Example</a></li>
<li><a class="reference internal" href="#cube-file-visualization-with-pymol">Cube File Visualization with PyMol</a></li>
<li><a class="reference internal" href="#adding-point-charges-to-f-i-sapt-computations">Adding Point Charges to F/I-SAPT Computations</a></li>
<li><a class="reference internal" href="#link-orbital-partitioning-in-i-sapt">Link Orbital Partitioning in I-SAPT</a><ul>
<li><a class="reference internal" href="#advanced-i-sapt-keywords-for-saon-siaon-partitionings">Advanced I-SAPT Keywords for SAOn/SIAOn Partitionings</a><ul>
<li><a class="reference internal" href="#fisapt-link-ortho"><span class="xref std std-term">FISAPT_LINK_ORTHO</span></a></li>
<li><a class="reference internal" href="#fisapt-exch-parperp"><span class="xref std std-term">FISAPT_EXCH_PARPERP</span></a></li>
<li><a class="reference internal" href="#fisapt-cube-linkibos"><span class="xref std std-term">FISAPT_CUBE_LINKIBOS</span></a></li>
<li><a class="reference internal" href="#fisapt-cube-linkihos"><span class="xref std std-term">FISAPT_CUBE_LINKIHOS</span></a></li>
<li><a class="reference internal" href="#fisapt-cube-densmat"><span class="xref std std-term">FISAPT_CUBE_DENSMAT</span></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#other-f-i-sapt-keywords">Other F/I-SAPT Keywords</a></li>
<li><a class="reference internal" href="#additional-notes">Additional Notes</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="adc.html" title="ADC: Ab Initio Polarization Propagator"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="sapt.html" title="SAPT: Symmetry-Adapted Perturbation Theory"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/fisapt.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/b5f5dea">1.9a1.dev43</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="methods.html" >Theoretical Methods: SCF to FCI</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">F/I-SAPT: Functional Group and/or Intramolecular SAPT</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2023, The Psi4 Project.
      Last updated on Wednesday, 23 August 2023 09:57PM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.2.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>