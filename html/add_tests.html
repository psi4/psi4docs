<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->






<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Test Suite</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/psi4.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Debugging and Profiling" href="prog_debug_profile.html" />
    <link rel="prev" title="Integrals in PSI4" href="prog_integrals.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="prog_debug_profile.html" title="Debugging and Profiling"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="prog_integrals.html" title="Integrals in PSI4"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/add_tests.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/3593c4f">1.6a1.dev143</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

        <li class="nav-item nav-item-this"><a href="">Test Suite</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="test-suite">
<span id="faq-add-tests"></span><h1>Test Suite<a class="headerlink" href="#test-suite" title="Permalink to this headline">¶</a></h1>
<p>A test suite plays a vital role in open-source software use and development.</p>
<ul class="simple">
<li><p>For a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> user, tests provide models of inputs that should work
“as-is” and a searchable collection of syntax and capabilities.
The test suite also allows high-quality development snapshots of the
codebase to be built automatically for users.</p></li>
<li><p>For a user who has <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> as part of a complex computational molecular software environment, a test suite alongside installed <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> can be used to show that the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> piece is working.</p></li>
<li><p>For a feature developer, adding tests provides confidence that you
can leave your code untouched and still advertise that the feature works
years later. With tests, proposed changes to <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> that break your
code fall upon the change proposer to fix, rather than being merged
silently and lying in wait for a concientious user to detect and report
and then likely falling upon <em>you</em> to fix.</p></li>
<li><p>For a general developer, the test suite allows confidence in refactoring, switching out underlying libraries, maintenance, and upgrading.</p></li>
</ul>
<section id="ctest-and-pytest-psithon-and-psiapi">
<h2>CTest and pytest, PSIthon and PsiAPI<a class="headerlink" href="#ctest-and-pytest-psithon-and-psiapi" title="Permalink to this headline">¶</a></h2>
<p>In designing a test, sometimes you want it to be a model input for the user in a single file or you don’t want a lot of <code class="docutils literal notranslate"><span class="pre">psi4.</span></code> or Python syntax cluttering the input.
In this case, follow <a class="reference internal" href="#faq-add-psithon-tests"><span class="std std-ref">Adding PSIthon Test Cases</span></a> to prepare as PSIthon (<code class="docutils literal notranslate"><span class="pre">psi4</span> <span class="pre">input.dat</span></code>) for, roughly speaking, running through <strong class="program">ctest</strong>.
The PSIthon/CTest test suite occupies the whole of <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests">psi4/tests</a> <em>except</em> <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests">psi4/tests/pytests</a>.</p>
<p>At other times you want the test to check several variations of a template job or you want to test error handling or you want to focus on PsiAPI rather than PSIthon or you want to control the compute conditions with environment variables.
In this case, follow <a class="reference internal" href="#faq-add-psiapi-tests"><span class="std std-ref">Adding PsiAPI Test Cases</span></a> to prepare as PsiAPI (<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">psi4</span></code>) for, roughly speaking, running through <strong class="program">pytest</strong>.
The PsiAPI/pytest test suite occupies <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests">psi4/tests/pytests</a>.</p>
<p>The above description sounds as if there are two disjoint test suites, and you have to run both <code class="docutils literal notranslate"><span class="pre">ctest</span></code> and <code class="docutils literal notranslate"><span class="pre">pytest</span></code> to fully test <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>.
This has indeed been the case until March 2022.
The difficulty has been that (1) two test suites is unexpected so some developers don’t know to run both; and (2) there are important tests in the PSIthon suite that can’t be run on a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> installation since CTest only works in a build directory.
Now, by adding an extra file to the test directory (<a class="reference internal" href="#faq-psithon-through-pytest"><span class="std std-ref">test_input.py</span></a>), PSIthon tests can also be run through <strong class="program">pytest</strong>.
This hasn’t rolled out to all ~500 PSIthon tests (help wanted), but eventually <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> can be tested with a single command from a build or from an installation.
Therefore, in designing a test, choose its mode based on whether PSIthon or PsiAPI suits it better and whether it’s a simple model for users (probably PSIthon) or for expert users (probably PsiAPI).
Both will continue to work in future, and neither have limitations.</p>
</section>
<section id="test-contents">
<h2>Test Contents<a class="headerlink" href="#test-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Most <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> tests will be integration tests focusing on non-regression of user input to answers, and we insist on having these.
But if you find unit tests helpful, by all means add them to the test suite.</p></li>
<li><p>Most tests should store reference results (from literature or another implementation or a carefully run <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> calculation),
run quantum chemistry, then apply one or more of the <a class="reference internal" href="#faq-comparison-functions"><span class="std std-ref">Comparison Functions</span></a> so that the test will fail if the answer is unexpected.
The functions are the same in CTest and pytest, but in the former they are, for example, <code class="docutils literal notranslate"><span class="pre">compare_matrices(refmat,</span> <span class="pre">mat,</span> <span class="pre">...)</span></code> while in the latter it’s asserted, like <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">compare_matrices(refmat,</span> <span class="pre">mat,</span> <span class="pre">...)</span></code>.
The main advantage of the testing functions is that they provide helpful error printing upon failure. Deep down, they’re NumPy functions.</p></li>
<li><p>In preparing the test case reference values, aim for the converged value rather than many digits from your computer under default convergence conditions.
This will make the test more robust for different OS, different BLAS libraries, and variations in SCF cycles.
Turn energy, density, amplitude, and geometry convergence criteria to very tight levels, and use these results for reference energies, reference geometries, reference cube files, <em>etc.</em>.
Then, either remove or relax the convergence settings, if these are not a vital part of the test.
In choosing the number of digits for <a class="reference internal" href="#psi4.compare_values" title="psi4.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">compare_values()</span></code></a> and other compare_* functions, select a number looser than the convergence set in the test
or the default convergence for the calculation type (energy, gradient, <em>etc.</em>).</p></li>
<li><p>Keep tests as short as possible without sacrificing coverage and variety. Under 30 seconds is a good aim.</p></li>
</ul>
</section>
<section id="adding-psithon-test-cases">
<span id="faq-add-psithon-tests"></span><h2>Adding PSIthon Test Cases<a class="headerlink" href="#adding-psithon-test-cases" title="Permalink to this headline">¶</a></h2>
<p>To create a new test case, first make a folder in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests">psi4/tests</a> or, for an addon, a subfolder under the addon folder.
Use hyphens, not spaces or underscores, in the directory name.
Add the directory name to the list of tests in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/CMakeLists.txt">psi4/tests/CMakeLists.txt</a> or, for an addon, <code class="docutils literal notranslate"><span class="pre">tests/&lt;addon&gt;/CMakeLists.txt</span></code>.
The test directory will need at least two files, <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">input.dat</span></code>.</p>
<section id="cmakelists-txt">
<h3><code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code><a class="headerlink" href="#cmakelists-txt" title="Permalink to this headline">¶</a></h3>
<p>This file adds the test case to the suite. It should have at least the following two uncommented lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">include</span><span class="p">(</span><span class="n">TestingMacros</span><span class="p">)</span>

<span class="c1"># if extra files needed</span>
<span class="c1"># file(COPY grid.dat DESTINATION ${CMAKE_CURRENT_BINARY_DIR})</span>

<span class="n">add_regression_test</span><span class="p">(</span><span class="n">directory_name</span> <span class="s2">&quot;psi;semicolon_separated-list-of-applicable-test-labels&quot;</span><span class="p">)</span>

<span class="c1"># if minutes long</span>
<span class="c1"># set_tests_properties(isapt1 PROPERTIES COST 300)</span>
</pre></div>
</div>
<p>The labels specify which groups of tests include the test case for <code class="docutils literal notranslate"><span class="pre">ctest</span> <span class="pre">-L</span> <span class="pre">label</span></code> purposes. The <code class="docutils literal notranslate"><span class="pre">psi</span></code> label should always be added, but the other labels are test-specific. The method tested should always be included, and this is often sufficient. If adding a test for an already existing module, the labels for other tests of the module will suggest other labels to add.
Labels have been added as developers needed, so they are not systematic or thorough. If you see labels to add or rename, please do.</p>
<p>A test requiring over 15 minutes should be labeled <code class="docutils literal notranslate"><span class="pre">longtests</span></code>. A short test under 30 seconds used for general bug checking should be labeled <code class="docutils literal notranslate"><span class="pre">quicktests</span></code>. A test that confirms <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> is operational should be labeled <code class="docutils literal notranslate"><span class="pre">smoketests</span></code>.</p>
<p>If a test needs extra input files like <code class="docutils literal notranslate"><span class="pre">grid.dat</span></code> or extra reference files for checking against, like <code class="docutils literal notranslate"><span class="pre">fchk</span></code>, specify these in the <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> as shown above. Such tests must be run through <code class="docutils literal notranslate"><span class="pre">ctest</span></code> and don’t usually work when run “by hand” from the objdir via <code class="docutils literal notranslate"><span class="pre">stage/bin/psi4</span> <span class="pre">../tests/directory_name/input.dat</span></code>.</p>
<p>If a test is multiple minutes long, load-balancing a parallel CTest run requires the test to be started early. Use the <code class="docutils literal notranslate"><span class="pre">COST</span></code> line as shown above to set a weighting to about the number of seconds the test takes.</p>
</section>
<section id="input-dat">
<h3><code class="docutils literal notranslate"><span class="pre">input.dat</span></code><a class="headerlink" href="#input-dat" title="Permalink to this headline">¶</a></h3>
<p>The other necessary file is the input file itself, <code class="docutils literal notranslate"><span class="pre">input.dat</span></code>. The input file should be just a simple input file to run the test, with small additions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#! RI-SCF cc-pVTZ energy of water, with Z-matrix input and cc-pVTZ-RI auxiliary basis.</span>
<span class="c1">#! Also a bit more to force a second line.</span>

<span class="n">nucenergy</span> <span class="o">=</span> <span class="mf">8.801466202085710</span>  <span class="c1">#TEST</span>
<span class="n">refenergy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">76.05098402733282</span>  <span class="c1">#TEST</span>

<span class="n">molecule</span> <span class="n">h2o</span> <span class="p">{</span>
   <span class="n">symmetry</span> <span class="n">c1</span>
   <span class="n">O</span>
   <span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span>
   <span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span> <span class="mi">2</span> <span class="mf">104.5</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="p">{</span>
   <span class="n">basis</span> <span class="n">cc</span><span class="o">-</span><span class="n">pVTZ</span>
   <span class="n">scf_type</span> <span class="n">df</span>
   <span class="n">df_basis_scf</span> <span class="n">cc</span><span class="o">-</span><span class="n">pVTZ</span><span class="o">-</span><span class="n">RI</span>
   <span class="n">e_convergence</span> <span class="mi">10</span>
<span class="p">}</span>

<span class="n">thisenergy</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="s2">&quot;hf&quot;</span><span class="p">)</span>

<span class="n">compare_values</span><span class="p">(</span><span class="n">nucenergy</span><span class="p">,</span> <span class="n">h2o</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">(),</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;Nuclear repulsion energy&quot;</span><span class="p">)</span>  <span class="c1">#TEST</span>
<span class="n">compare_values</span><span class="p">(</span><span class="n">refenergy</span><span class="p">,</span> <span class="n">thisenergy</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;Reference energy&quot;</span><span class="p">)</span>  <span class="c1">#TEST</span>
<span class="n">compare_values</span><span class="p">(</span><span class="n">refenergy</span><span class="p">,</span> <span class="n">variable</span><span class="p">(</span><span class="s1">&#39;scf total energy&#39;</span><span class="p">),</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;Reference energy&quot;</span><span class="p">)</span>  <span class="c1">#TEST</span>
</pre></div>
</div>
<p>Of those small modifications, first, note the special comment at the top (starting with the <code class="docutils literal notranslate"><span class="pre">#!</span></code> comment marker). This should be descriptive since it is inlined into the manual (unless <code class="docutils literal notranslate"><span class="pre">!nosample</span></code> in the comment) as a sample input.</p>
<p>Reference values are often assigned to variables for later use.
The compare_values function (along with several relatives in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/driver/p4util/testing.py">psi4/psi4/driver/p4util/testing.py</a> for comparing strings, matrices, etc.) checks that the computed values match these reference values to suitable precision. This function prints an error message and signals that the test failed to the make system, if the values don’t match. Any lines of the input associated with the validation process should be flagged with <code class="docutils literal notranslate"><span class="pre">#TEST</span></code> at the end of each line, so that they can be removed when copying from the tests to the samples directory.</p>
</section>
<section id="output-ref">
<h3><code class="docutils literal notranslate"><span class="pre">output.ref</span></code><a class="headerlink" href="#output-ref" title="Permalink to this headline">¶</a></h3>
<p>When your test case is in final form, run it locally, rename the output to <code class="docutils literal notranslate"><span class="pre">output.ref</span></code>, and check it into the repository alongside <code class="docutils literal notranslate"><span class="pre">input.dat</span></code>.
While this isn’t used for any testing machinery (except for the nearly decommissioned <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/psitest.pl">psi4/tests/psitest.pl</a> for CC tests; full decommission expected by v1.6), it can be handy for users or developers to consult.</p>
</section>
<section id="test-input-py">
<span id="faq-psithon-through-pytest"></span><h3><code class="docutils literal notranslate"><span class="pre">test_input.py</span></code><a class="headerlink" href="#test-input-py" title="Permalink to this headline">¶</a></h3>
<p>Starting March 2022, one can also run tests designed as above for CTest through pytest.
To bring the test to pytest’s notice, add a file to the directory named <code class="docutils literal notranslate"><span class="pre">test_input.py</span></code>.
Below is an example for the <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/ci-property/test_input.py">psi4/tests/ci-property/test_input.py</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">addons</span> <span class="kn">import</span> <span class="o">*</span>

<span class="nd">@ctest_labeler</span><span class="p">(</span><span class="s2">&quot;quick;ci;cas;properties;cart;noc1&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_ci_property</span><span class="p">():</span>
    <span class="n">ctest_runner</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;grid.dat&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>This file contains much the same information as the <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>.
The <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">test_ci_property</span></code> contains the name of the test, now with underscores rather than hyphens.
<code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">test_</span></code> identifies it to pytest as a test.
That part of the function name and the name of the file, <code class="docutils literal notranslate"><span class="pre">test_input.py</span></code> are required, but no further registration with CMake is necessary.
Most tests need only the simple form of the runner line <code class="docutils literal notranslate"><span class="pre">ctest_runner(__file__)</span></code>.
This uses QCEngine machinery to execute <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">psi4</span> <span class="pre">input.dat</span></code>.
If additional input files are needed from the test directory, their names can be added to the the second argument list as shown above.
Those additional input files <em>do</em> need to be registered in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/CMakeLists.txt">psi4/psi4/CMakeLists.txt</a>.</p>
<p>Finally, the label string passed to CTest is here handed to pytest, with a few changes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">psi</span></code> added automatically, so exclude it when copying from CTest <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cli</span></code> added automatically to distinguish CTest origin from deliberate pytest origin, which have <code class="docutils literal notranslate"><span class="pre">api</span></code> added</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smoke</span></code> used instead of CTest <code class="docutils literal notranslate"><span class="pre">smoketests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quick</span></code> used instead of CTest <code class="docutils literal notranslate"><span class="pre">quicktests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">long</span></code> used instead of CTest <code class="docutils literal notranslate"><span class="pre">longtests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">addon</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;name-of-addon&gt;</span></code> added automatically when <code class="docutils literal notranslate"><span class="pre">&#64;uusing(&quot;&lt;name-of-addon&gt;&quot;)</span></code> decorates the test or <code class="docutils literal notranslate"><span class="pre">marks=using(&quot;&lt;name-of-addon&gt;&quot;)</span></code> marks the test</p></li>
</ul>
<p>CTest “labels” are called “marks” in pytest.
Any new marks should be added to <a class="reference external" href="https://github.com/psi4/psi4/blob/master/pytest.ini">psi4/pytest.ini</a>.</p>
</section>
<section id="running-for-debugging">
<h3>Running for Debugging<a class="headerlink" href="#running-for-debugging" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>PSIthon tests that don’t need extra files to run are easily run from <code class="docutils literal notranslate"><span class="pre">&lt;objdir&gt;</span></code> via <code class="docutils literal notranslate"><span class="pre">stage/bin/psi4</span> <span class="pre">../tests/&lt;test-name&gt;/input.dat,</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">output</span> <span class="pre">appearing</span> <span class="pre">in</span> <span class="pre">``../tests/&lt;test-name&gt;/input.out</span></code>.</p></li>
<li><p>All PSIthon tests are runable through CTest, and output files appear in <code class="docutils literal notranslate"><span class="pre">&lt;objdir&gt;/tests/&lt;test-name&gt;/output.dat</span></code> and stdout results appear in <code class="docutils literal notranslate"><span class="pre">&lt;objdir&gt;/Testing/Temporary/LastTest.log*</span></code>.</p></li>
</ul>
</section>
</section>
<section id="adding-psiapi-test-cases">
<span id="faq-add-psiapi-tests"></span><h2>Adding PsiAPI Test Cases<a class="headerlink" href="#adding-psiapi-test-cases" title="Permalink to this headline">¶</a></h2>
<p>To create a new test case, either create a new file or add to an existing file under <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests">psi4/tests/pytests</a>.</p>
<ul class="simple">
<li><p>Test must be in the <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests/">psi4/tests/pytests/</a> directory.</p></li>
<li><p>Test file name must start with <code class="docutils literal notranslate"><span class="pre">test_</span></code>. This is how pytest knows to collect it.</p></li>
<li><p>A test file may contain many tests, each of which is an ordinary Python function with name starting <code class="docutils literal notranslate"><span class="pre">test_</span></code>. This is how pytest knows to collect it.</p></li>
<li><p>No registration required to bring a test to pytest’s attention.</p></li>
<li><p>No registration required to bring a test to CMake’s attention. If a test needs additional files, register them in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/CMakeLists.txt">psi4/psi4/CMakeLists.txt</a>.</p></li>
</ul>
<p>A few notes on test contents:</p>
<ul class="simple">
<li><p>Import testing functions from <code class="docutils literal notranslate"><span class="pre">utils</span></code> and use Python assert: <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">compare_values(expected,</span> <span class="pre">computed,</span> <span class="pre">...)</span></code>.</p></li>
<li><p>Don’t worry about cleaning up files or resetting options. A function in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests/conftest.py">psi4/tests/pytests/conftest.py</a> does this automatically between every test.</p></li>
<li><p>Especially if using data or functions from outside a test, run a variety of tests at different <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-n</span> <span class="pre">&lt;N&gt;</span></code> levels to mix up test ordering. If tests fail that pass when run alone, you’ve got a function of the same name changing state or some similar correctable phenomenon.</p></li>
</ul>
<p>A few notes on test labels:</p>
<ul class="simple">
<li><p>For every new test file, add <code class="docutils literal notranslate"><span class="pre">pytestmark</span> <span class="pre">=</span> <span class="pre">[pytest.mark.psi,</span> <span class="pre">pytest.mark.api]</span></code> at the top.
This ensures that every test has the <code class="docutils literal notranslate"><span class="pre">psi</span></code> mark and every PsiAPI test has the <code class="docutils literal notranslate"><span class="pre">api</span></code> mark to contrast with PSIthon tests with <code class="docutils literal notranslate"><span class="pre">cli</span></code> mark.</p></li>
<li><p>There are individual “marks” that can be added to whole tests or parts
of parameterized tests so that they can be run by category (<code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-m</span> <span class="pre">&lt;mark&gt;</span></code>
vs. <code class="docutils literal notranslate"><span class="pre">ctest</span> <span class="pre">-L</span> <span class="pre">&lt;mark&gt;</span></code>) rather than just by name (<code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-k</span> <span class="pre">&lt;name_fragment&gt;</span></code>
vs. <code class="docutils literal notranslate"><span class="pre">ctest</span> <span class="pre">-R</span> <span class="pre">&lt;name_fragment&gt;</span></code>). Far more complicated logic is allowed than for
CTest: <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">-m</span> <span class="pre">&quot;dftd3</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">api</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">long&quot;</span></code>.</p></li>
<li><p>The most important marks are “quick” and “long” that opt tests into the quick CI suite or out of
the normal full suite. Mark with a decorator for the full test or the
marks argument in a parameterized test. Search “mark” in the test suite
for examples. Use “quick” freely for tests that cover functionality and
are under 15s. Use “long” sparingly to winnow out the longest examples,
particularly those over a minute.</p></li>
</ul>
<section id="id1">
<h3>Running for Debugging<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>There are many ways to run pytest, <a class="reference internal" href="build_planning.html#faq-pytest"><span class="std std-ref">How to test a Psi4 installation</span></a>, and three different copies of the test file
(i.e., <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests/test_mp2.py">psi4/tests/pytests/test_mp2.py</a>, <code class="docutils literal notranslate"><span class="pre">&lt;objdir&gt;/stage/lib/PYMOD_INSTALL_LIBDIR/psi4/tests/test_mp2.py</span></code>,
<code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX/lib/PYMOD_INSTALL_LIBDIR/psi4/tests/test_mp2.py</span></code>).
But for developing a pytest test, you probably want to use the first so you can edit it in place rather than running <code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">--build</span></code> after each change.</p>
<ul class="simple">
<li><p>Easiest is from &lt;objdir&gt;, run <code class="docutils literal notranslate"><span class="pre">pytest</span> <span class="pre">../tests</span></code>. Add any filters (<code class="docutils literal notranslate"><span class="pre">-k</span>
<span class="pre">test_name_fragment</span></code>) or parallelism (<code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">&lt;N&gt;</span></code>  or <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">auto</span></code> if <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code>
installed) or print test names (<code class="docutils literal notranslate"><span class="pre">-v</span></code>) or print warnings (<code class="docutils literal notranslate"><span class="pre">-rws</span></code>).</p></li>
<li><p>An important point is that because they’re PsiAPI, <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">psi4</span></code> is happening,
so the &lt;objdir&gt; <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> module must be in <span class="target" id="index-0"></span><a class="reference internal" href="external.html#envvar-PYTHONPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONPATH</span></code></a>. Also, any call
to QCEngine is using <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">psi4</span></code>, so the &lt;objdir&gt; <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> executable must be in
<span class="target" id="index-1"></span><a class="reference internal" href="external.html#envvar-PATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a>. The easiest way to prepare your local environment is to
execute the printout of <code class="docutils literal notranslate"><span class="pre">&lt;objdir&gt;/stage/bin/psi4</span> <span class="pre">--psiapi</span></code>.</p></li>
<li><p>To see stdout output from an otherwise passing test, easiest to add <code class="docutils literal notranslate"><span class="pre">assert</span> <span class="pre">0</span></code>
at its end to trigger failure.</p></li>
<li><p>If stdout printing is insufficient, and you really need to see <code class="docutils literal notranslate"><span class="pre">output.dat</span></code> or other files,
comment out their deletion in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/pytests/conftest.py">psi4/tests/pytests/conftest.py</a> and run the single test, deleting
the file each time (since it appends).</p></li>
</ul>
</section>
</section>
<section id="comparison-functions">
<span id="faq-comparison-functions"></span><h2>Comparison Functions<a class="headerlink" href="#comparison-functions" title="Permalink to this headline">¶</a></h2>
<section id="plain-old-data">
<h3>Plain Old Data<a class="headerlink" href="#plain-old-data" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_values">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for float or float array-like data structures.
See <a class="reference internal" href="#qcelemental.testing.compare_values" title="qcelemental.testing.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_values()</span></code></a> for details.</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">psi4.compare_arrays()</span></code> is an old comparison function for float NumPy arrays that is now an alias to this.</p>
<p>Handles both Psi4-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">atol_exponent,</span> <span class="pre">label)</span></code>; see <strong>atol_exponent</strong> parameter below) and QCA-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">label)</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atol_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Absolute tolerance (see formula in <a class="reference internal" href="#qcelemental.testing.compare_values" title="qcelemental.testing.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_values()</span></code></a> notes).
Values less than one are taken literally; one or greater taken as decimal digits for comparison.
So <cite>1</cite> means <cite>atol=0.1</cite> and <cite>2</cite> means <cite>atol=0.01</cite> but <cite>0.04</cite> means <cite>atol=0.04</cite>
Note that the largest expressable processed atol will be <cite>~0.99</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcelemental.testing.compare_values">
<span class="sig-prename descclassname"><span class="pre">qcelemental.testing.</span></span><span class="sig-name descname"><span class="pre">compare_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">passnone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_handler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/testing.html#compare_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qcelemental.testing.compare_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if two floats or float arrays are element-wise equal within a tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]) – float or float array-like
Reference value against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]) – float or float array-like
Input value to compare against <cite>expected</cite>.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Absolute tolerance (see formula below).</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Label for passed and error messages. Defaults to calling function name.</p></li>
<li><p><strong>rtol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Relative tolerance (see formula below). By default set to zero so <cite>atol</cite> dominates.</p></li>
<li><p><strong>equal_nan</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Passed to np.isclose. Compare NaN’s as equal.</p></li>
<li><p><strong>equal_phase</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Compare computed <em>or its opposite</em> as equal.</p></li>
<li><p><strong>passnone</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Return True when both expected and computed are None.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to log the return message.</p></li>
<li><p><strong>return_message</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to return tuple. See below.</p></li>
<li><p><strong>return_handler</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Callable" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>]) – Function to control printing, logging, raising, and returning.
Specialized interception for interfacing testing systems.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Tuple" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>allclose</strong> (<em>bool</em>) – Returns True if <cite>expected</cite> and <cite>computed</cite> are equal within tolerance; False otherwise.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – When return_message=True, also return passed or error message.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Akin to np.allclose.</p></li>
<li><p>For scalar float-comparable types and for arbitrary-dimension, np.ndarray-castable, uniform-type,
float-comparable types. For mixed types, use <a class="reference internal" href="#qcelemental.testing.compare_recursive" title="qcelemental.testing.compare_recursive"><code class="xref py py-func docutils literal notranslate"><span class="pre">compare_recursive()</span></code></a>.</p></li>
<li><p>Sets rtol to zero to match expected Psi4 behaviour, otherwise measured as:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">absolute</span><span class="p">(</span><span class="n">computed</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">atol</span> <span class="o">+</span> <span class="n">rtol</span> <span class="o">*</span> <span class="n">absolute</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_integers">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_integers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_integers" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for integers, strings, booleans, or integer array-like data structures.
See <a class="reference internal" href="#qcelemental.testing.compare" title="qcelemental.testing.compare"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare()</span></code></a> for details.</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">psi4.compare_strings()</span></code> is an alias to this.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcelemental.testing.compare">
<span class="sig-prename descclassname"><span class="pre">qcelemental.testing.</span></span><span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_handler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/testing.html#compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qcelemental.testing.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if two integers, strings, booleans, or integer arrays are element-wise equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]) – int, bool, str or array-like of same.
Reference value against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>], <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>]) – int, bool, str or array-like of same.
Input value to compare against <cite>expected</cite>.</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Label for passed and error messages. Defaults to calling function name.</p></li>
<li><p><strong>equal_phase</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Compare computed <em>or its opposite</em> as equal.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to log the return message.</p></li>
<li><p><strong>return_message</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to return tuple. See below.</p></li>
<li><p><strong>return_handler</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Callable" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>]) – Function to control printing, logging, raising, and returning.
Specialized interception for interfacing testing systems.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Tuple" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>allclose</strong> (<em>bool</em>) – Returns True if <cite>expected</cite> and <cite>computed</cite> are equal; False otherwise.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – When return_message=True, also return passed or error message.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Akin to np.array_equal.</p></li>
<li><p>For scalar exactly-comparable types and for arbitrary-dimension, np.ndarray-castable, uniform-type,
exactly-comparable types. For mixed types, use <a class="reference internal" href="#qcelemental.testing.compare_recursive" title="qcelemental.testing.compare_recursive"><code class="xref py py-func docutils literal notranslate"><span class="pre">compare_recursive()</span></code></a>.</p></li>
</ul>
</dd></dl>

</section>
<section id="objects">
<h3>Objects<a class="headerlink" href="#objects" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_matrices">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for <a class="reference internal" href="api/psi4.core.Matrix.html#psi4.core.Matrix" title="psi4.core.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">psi4.core.Matrix</span></code></a> objects.
Compares Matrix properties of <code class="docutils literal notranslate"><span class="pre">name</span></code> (optional through <strong>check_name</strong>), <code class="docutils literal notranslate"><span class="pre">nirrep</span></code>, <code class="docutils literal notranslate"><span class="pre">symmetry</span></code>, and number of rows and columns for each irrep.
For comparing actual numerical contents, the matrices are serialized to NumPy array format and passed to <a class="reference internal" href="#qcelemental.testing.compare_recursive" title="qcelemental.testing.compare_recursive"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_recursive()</span></code></a>.</p>
<p>Handles both Psi4-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">atol_exponent,</span> <span class="pre">label)</span></code>; see <strong>atol_exponent</strong> parameter below) and QCA-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">label)</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atol_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Absolute tolerance (see formula in <a class="reference internal" href="#qcelemental.testing.compare_values" title="qcelemental.testing.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_values()</span></code></a> notes).
Values less than one are taken literally; one or greater taken as decimal digits for comparison.
So <cite>1</cite> means <cite>atol=0.1</cite> and <cite>2</cite> means <cite>atol=0.01</cite> but <cite>0.04</cite> means <cite>atol=0.04</cite>
Note that the largest expressable processed atol will be <cite>~0.99</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcelemental.testing.compare_recursive">
<span class="sig-prename descclassname"><span class="pre">qcelemental.testing.</span></span><span class="sig-name descname"><span class="pre">compare_recursive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forgive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_handler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/testing.html#compare_recursive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qcelemental.testing.compare_recursive" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively compares nested structures such as dictionaries and lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]) – Reference value against which <cite>computed</cite> is compared.
Dict may be of any depth but should contain Plain Old Data.</p></li>
<li><p><strong>computed</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseModel</span></code>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.ForwardRef" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardRef</span></code></a>]) – Input value to compare against <cite>expected</cite>.
Dict may be of any depth but should contain Plain Old Data.</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Absolute tolerance (see formula below).</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Label for passed and error messages. Defaults to calling function name.</p></li>
<li><p><strong>rtol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Relative tolerance (see formula below). By default set to zero so <cite>atol</cite> dominates.</p></li>
<li><p><strong>forgive</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Keys in top level which may change between <cite>expected</cite> and <cite>computed</cite> without triggering failure.</p></li>
<li><p><strong>equal_phase</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]) – Compare computed <em>or its opposite</em> as equal.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to log the return message.</p></li>
<li><p><strong>return_message</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – Whether to return tuple. See below.</p></li>
<li><p><strong>return_handler</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Callable" title="(in Python v3.9)"><em>Callable</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Tuple" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>allclose</strong> (<em>bool</em>) – Returns True if <cite>expected</cite> and <cite>computed</cite> are equal within tolerance; False otherwise.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – When return_message=True, also return passed or error message.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">absolute</span><span class="p">(</span><span class="n">computed</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">atol</span> <span class="o">+</span> <span class="n">rtol</span> <span class="o">*</span> <span class="n">absolute</span><span class="p">(</span><span class="n">expected</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_vectors">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for <a class="reference internal" href="api/psi4.core.Vector.html#psi4.core.Vector" title="psi4.core.Vector"><code class="xref py py-class docutils literal notranslate"><span class="pre">psi4.core.Vector</span></code></a> objects.
Compares Vector properties of <code class="docutils literal notranslate"><span class="pre">name</span></code> (optional through <strong>check_name</strong>), <code class="docutils literal notranslate"><span class="pre">nirrep</span></code>, and dimension of each irrep.
For comparing actual numerical contents, the vectors are serialized to NumPy array format and passed to <a class="reference internal" href="#qcelemental.testing.compare_recursive" title="qcelemental.testing.compare_recursive"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_recursive()</span></code></a>.</p>
<p>Handles both Psi4-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">atol_exponent,</span> <span class="pre">label)</span></code>; see <strong>atol_exponent</strong> parameter below) and QCA-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">label)</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atol_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Absolute tolerance (see formula in <a class="reference internal" href="#qcelemental.testing.compare_values" title="qcelemental.testing.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_values()</span></code></a> notes).
Values less than one are taken literally; one or greater taken as decimal digits for comparison.
So <cite>1</cite> means <cite>atol=0.1</cite> and <cite>2</cite> means <cite>atol=0.01</cite> but <cite>0.04</cite> means <cite>atol=0.04</cite>
Note that the largest expressable processed atol will be <cite>~0.99</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_wavefunctions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_wavefunctions">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_wavefunctions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_wavefunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for <a class="reference internal" href="api/psi4.core.Wavefunction.html#psi4.core.Wavefunction" title="psi4.core.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">psi4.core.Wavefunction</span></code></a> objects.
Compares over 30 Wavefunction properties, including <code class="docutils literal notranslate"><span class="pre">nirrep</span></code>, <code class="docutils literal notranslate"><span class="pre">nso</span></code>, molecule geometry, basis set <code class="docutils literal notranslate"><span class="pre">nbf</span></code>, density matrices, gradient results, etc.</p>
<p>Handles both Psi4-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">atol_exponent,</span> <span class="pre">label)</span></code>; see <strong>atol_exponent</strong> parameter below) and QCA-style signatures (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">label)</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atol_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Absolute tolerance (see formula in <a class="reference internal" href="#qcelemental.testing.compare_values" title="qcelemental.testing.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_values()</span></code></a> notes).
Values less than one are taken literally; one or greater taken as decimal digits for comparison.
So <cite>1</cite> means <cite>atol=0.1</cite> and <cite>2</cite> means <cite>atol=0.01</cite> but <cite>0.04</cite> means <cite>atol=0.04</cite>
Note that the largest expressable processed atol will be <cite>~0.99</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_molrecs">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_molrecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_molrecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for <a class="reference internal" href="api/psi4.core.Molecule.html#psi4.core.Molecule.to_dict" title="psi4.core.Molecule.to_dict"><code class="xref py py-func docutils literal notranslate"><span class="pre">psi4.core.Molecule.to_dict()</span></code></a> objects.
See <a class="reference internal" href="#qcelemental.testing.compare_molrecs" title="qcelemental.testing.compare_molrecs"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_molrecs()</span></code></a> for details.</p>
<p>Note only QCA-style signature (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">label)</span></code>) available.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcelemental.testing.compare_molrecs">
<span class="sig-prename descclassname"><span class="pre">qcelemental.testing.</span></span><span class="sig-name descname"><span class="pre">compare_molrecs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forgive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_geoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exact'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_handler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcelemental/testing.html#compare_molrecs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qcelemental.testing.compare_molrecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compare Molecule dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>]</em>) – </p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – </p></li>
<li><p><strong>rtol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – </p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – </p></li>
<li><p><strong>return_message</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – </p></li>
<li><p><strong>return_handler</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><em>Optional</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Callable" title="(in Python v3.9)"><em>Callable</em></a><em>]</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="file-formats">
<h3>File Formats<a class="headerlink" href="#file-formats" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_cubes">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_cubes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_name=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_cubes" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for volumetric data in cube file format.
Compares only the volumetric data, not the voxel data or molecular geometry or other header contents.
The volumetric data is passed to <a class="reference internal" href="#qcelemental.testing.compare_values" title="qcelemental.testing.compare_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_values()</span></code></a>.</p>
<p>Note only QCA-style signature (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">label)</span></code>) available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<em>file</em>) – Reference cube file against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<em>file</em>) – Input cube file to compare against <cite>expected</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_fchkfiles">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_fchkfiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/psi4/driver/p4util/fchk.html#compare_fchkfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#psi4.compare_fchkfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for output data in FCHK (formatted checkpoint) file format.
Compares many fields including number of electrons, highest angular momentum, basis
set exponents, densities, final gradient.</p>
<p>Note only Psi4-style signature (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">atol_exponent,</span> <span class="pre">label)</span></code>) available.</p>
<p>An older format description can be found here
<a class="reference external" href="http://wild.life.nctu.edu.tw/~jsyu/compchem/g09/g09ur/f_formchk.htm">http://wild.life.nctu.edu.tw/~jsyu/compchem/g09/g09ur/f_formchk.htm</a>
It lists more fields (logical, character) that are not included in this
test function. They should be covered by the string comparison.
This function is only meant to work with PSI4’s FCHK files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<em>file</em>) – Reference FCHK file against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<em>file</em>) – Input FCHK file to compare against <cite>expected</cite>.</p></li>
<li><p><strong>atol_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Absolute tolerance for high accuracy fields – 1.e-8 or 1.e-9 is suitable.
Values less than one are taken literally; one or greater taken as decimal digits for comparison.
So <cite>1</cite> means <cite>atol=0.1</cite> and <cite>2</cite> means <cite>atol=0.01</cite> but <cite>0.04</cite> means <cite>atol=0.04</cite>
Note that the largest expressable processed atol will be <cite>~0.99</cite>.</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Label for passed and error messages.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_fcidumps">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_fcidumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/psi4/driver/p4util/fcidump.html#compare_fcidumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#psi4.compare_fcidumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for FCIDUMP files.
Compares the first six below, then computes energies from MO integrals and compares the last four.</p>
<blockquote>
<div><ul class="simple">
<li><p>‘norb’ : number of basis functions</p></li>
<li><p>‘nelec’ : number of electrons</p></li>
<li><p>‘ms2’ : spin polarization of the system</p></li>
<li><p>‘isym’ : symmetry of state (if present in FCIDUMP)</p></li>
<li><p>‘orbsym’ : list of symmetry labels of each orbital</p></li>
<li><p>‘uhf’ : whether restricted or unrestricted</p></li>
<li><p>‘ONE-ELECTRON ENERGY’ : SCF one-electron energy</p></li>
<li><p>‘TWO-ELECTRON ENERGY’ : SCF two-electron energy</p></li>
<li><p>‘SCF TOTAL ENERGY’ : SCF total energy</p></li>
<li><p>‘MP2 CORRELATION ENERGY’ : MP2 correlation energy</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> – Reference FCIDUMP file against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> – Input FCIDUMP file to compare against <cite>expected</cite>.</p></li>
<li><p><strong>label</strong> – string labeling the test</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_moldenfiles">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_moldenfiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol_exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Compare</span> <span class="pre">Molden'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/psi4/driver/p4util/fchk.html#compare_moldenfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#psi4.compare_moldenfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for output data in Molden file format.
Compares many fields including geometry, basis set, occupations, symmetries, energies.</p>
<p>Note only Psi4-style signature (<code class="docutils literal notranslate"><span class="pre">(expected,</span> <span class="pre">computed,</span> <span class="pre">atol_exponent,</span> <span class="pre">label)</span></code>) available.</p>
<p>A format description is found <a class="reference external" href="https://www3.cmbi.umcn.nl/molden/molden_format.html">https://www3.cmbi.umcn.nl/molden/molden_format.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<em>file</em>) – Reference Molden file against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<em>file</em>) – Input Molden file to compare against <cite>expected</cite>.</p></li>
<li><p><strong>atol_exponent</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Absolute tolerance for high accuracy fields – 1.e-8 or 1.e-9 is suitable.
Values less than one are taken literally; one or greater taken as decimal digits for comparison.
So <cite>1</cite> means <cite>atol=0.1</cite> and <cite>2</cite> means <cite>atol=0.01</cite> but <cite>0.04</cite> means <cite>atol=0.04</cite>
Note that the largest expressable processed atol will be <cite>~0.99</cite>.</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Label for passed and error messages.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="qcdb.compare_vibinfos">
<span class="sig-prename descclassname"><span class="pre">qcdb.</span></span><span class="sig-name descname"><span class="pre">compare_vibinfos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forgive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toldict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/qcdb/vib.html#compare_vibinfos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#qcdb.compare_vibinfos" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if two dictionaries of vibration Datum objects are equivalent within a tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference internal" href="external_apis.html#qcelemental.datum.Datum" title="qcelemental.datum.Datum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Datum</span></code></a>]) – Reference value against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference internal" href="external_apis.html#qcelemental.datum.Datum" title="qcelemental.datum.Datum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Datum</span></code></a>]) – Input value to compare against <cite>expected</cite>. Must contain all fields of <cite>expected</cite>.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Absolute tolerance.</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Label for passed and error messages.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Control printing.</p></li>
<li><p><strong>forgive</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]) – Keys in top level which may change between <cite>expected</cite> and <cite>computed</cite> without triggering failure.</p></li>
<li><p><strong>required</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>]) – Keys in top level which must be present in <cite>computed</cite>. (“omega” recc. for vibs.)</p></li>
<li><p><strong>toldict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Optional" title="(in Python v3.9)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]) – Tolerances for specific keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>allclose</strong> – Returns True if <cite>expected</cite> and <cite>computed</cite> are equal within tolerance; False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="extra-qca-functions">
<h3>Extra QCA Functions<a class="headerlink" href="#extra-qca-functions" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_phase=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_message=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_handler=&lt;function</span> <span class="pre">_psi4_true_raise_handler&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if two integers, strings, booleans, or integer arrays are element-wise equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expected</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>]</em>) – int, bool, str or array-like of same.
Reference value against which <cite>computed</cite> is compared.</p></li>
<li><p><strong>computed</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><em>Union</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.List" title="(in Python v3.9)"><em>List</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><em>numpy.ndarray</em></a><em>]</em>) – int, bool, str or array-like of same.
Input value to compare against <cite>expected</cite>.</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Label for passed and error messages. Defaults to calling function name.</p></li>
<li><p><strong>equal_phase</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Compare computed <em>or its opposite</em> as equal.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to log the return message.</p></li>
<li><p><strong>return_message</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to return tuple. See below.</p></li>
<li><p><strong>return_handler</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Callable" title="(in Python v3.9)"><em>Callable</em></a>) – Function to control printing, logging, raising, and returning.
Specialized interception for interfacing testing systems.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>allclose</strong> (<em>bool</em>) – Returns True if <cite>expected</cite> and <cite>computed</cite> are equal; False otherwise.</p></li>
<li><p><strong>message</strong> (<em>str</em>) – When return_message=True, also return passed or error message.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Union" title="(in Python v3.9)"><em>Union</em></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)">bool</a>, <a class="reference external" href="https://docs.python.org/3.9/library/typing.html#typing.Tuple" title="(in Python v3.9)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)">bool</a>, <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)">str</a>]]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Akin to np.array_equal.</p></li>
<li><p>For scalar exactly-comparable types and for arbitrary-dimension, np.ndarray-castable, uniform-type,
exactly-comparable types. For mixed types, use <a class="reference internal" href="#psi4.compare_recursive" title="psi4.compare_recursive"><code class="xref py py-func docutils literal notranslate"><span class="pre">compare_recursive()</span></code></a>.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psi4.compare_recursive">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">compare_recursive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computed</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psi4.compare_recursive" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparison function for recursively comparing mixed-type and nested structures such as dictionaries and lists.
See <a class="reference internal" href="#qcelemental.testing.compare_recursive" title="qcelemental.testing.compare_recursive"><code class="xref py py-func docutils literal notranslate"><span class="pre">qcelemental.testing.compare_recursive()</span></code></a> for details.</p>
</dd></dl>

</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="index.html" title="index">
          <img class="logo" src="_static/psi4square.png" alt="Logo"/>
        </a></p><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Test Suite</a><ul>
<li><a class="reference internal" href="#ctest-and-pytest-psithon-and-psiapi">CTest and pytest, PSIthon and PsiAPI</a></li>
<li><a class="reference internal" href="#test-contents">Test Contents</a></li>
<li><a class="reference internal" href="#adding-psithon-test-cases">Adding PSIthon Test Cases</a><ul>
<li><a class="reference internal" href="#cmakelists-txt"><code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></a></li>
<li><a class="reference internal" href="#input-dat"><code class="docutils literal notranslate"><span class="pre">input.dat</span></code></a></li>
<li><a class="reference internal" href="#output-ref"><code class="docutils literal notranslate"><span class="pre">output.ref</span></code></a></li>
<li><a class="reference internal" href="#test-input-py"><code class="docutils literal notranslate"><span class="pre">test_input.py</span></code></a></li>
<li><a class="reference internal" href="#running-for-debugging">Running for Debugging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-psiapi-test-cases">Adding PsiAPI Test Cases</a><ul>
<li><a class="reference internal" href="#id1">Running for Debugging</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-functions">Comparison Functions</a><ul>
<li><a class="reference internal" href="#plain-old-data">Plain Old Data</a></li>
<li><a class="reference internal" href="#objects">Objects</a></li>
<li><a class="reference internal" href="#file-formats">File Formats</a></li>
<li><a class="reference internal" href="#extra-qca-functions">Extra QCA Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="prog_debug_profile.html" title="Debugging and Profiling"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="prog_integrals.html" title="Integrals in PSI4"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/add_tests.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/3593c4f">1.6a1.dev143</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

        <li class="nav-item nav-item-this"><a href="">Test Suite</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, The Psi4 Project.
      Last updated on Saturday, 09 April 2022 05:52PM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>