<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->






<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Release Procedures</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/psi4.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="shortcut icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PSI4 API: Linking C++ and Python" href="psi4api.html" />
    <link rel="prev" title="Git, Versioning" href="manage_git.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="psi4api.html" title="PSI4 API: Linking C++ and Python"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="manage_git.html" title="Git, Versioning"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/manage_release.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/dddb361">1.5a1.dev43</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="manage_index.html" accesskey="U">Managing: Git, Conda, CMake and all that</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">Release Procedures</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="release-procedures">
<h1>Release Procedures<a class="headerlink" href="#release-procedures" title="Permalink to this headline">¶</a></h1>
<section id="annual">
<span id="faq-annualprocedure"></span><h2>Annual<a class="headerlink" href="#annual" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#update-copyright-year">Update copyright year</a></p></li>
</ul>
</section>
<section id="pre-release-e-g-v1-3rc1">
<span id="faq-prereleaseprocedure"></span><h2>Pre-Release (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3rc1</span></code>)<a class="headerlink" href="#pre-release-e-g-v1-3rc1" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#update-samples">Update samples</a></p></li>
<li><p><a class="reference internal" href="#collect-new-authors">Collect new authors</a></p></li>
<li><p><a class="reference internal" href="#anticipate-next-release">Anticipate next release</a></p></li>
<li><p><a class="reference internal" href="#build-conda-ecosystem-stack">Build Conda ecosystem stack</a></p></li>
<li><p><a class="reference internal" href="#tag-pre-release">Tag (pre)release</a></p></li>
<li><p><a class="reference internal" href="#build-conda-psi4-stack-at-specific-commit">Build Conda Psi4 stack at specific commit</a></p></li>
<li><p><a class="reference internal" href="#build-psi4conda-set">Build Psi4conda set</a></p></li>
<li><p><a class="reference internal" href="#generate-download-page-for-psicode-org">Generate download page for psicode.org</a></p></li>
<li><p><a class="reference internal" href="#reset-psi4meta-for-nightly-operation">Reset psi4meta for nightly operation</a></p></li>
</ul>
</section>
<section id="release-e-g-v1-3">
<span id="faq-releaseprocedure"></span><h2>Release (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3</span></code>)<a class="headerlink" href="#release-e-g-v1-3" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#do-final-pass-before-release-tag">Do final pass before release tag</a></p></li>
<li><p><a class="reference internal" href="#tag-pre-release">Tag (pre)release</a></p></li>
<li><p><a class="reference internal" href="#initialize-release-branch">Initialize release branch</a></p></li>
<li><p><a class="reference internal" href="#build-conda-psi4-stack-at-specific-commit">Build Conda Psi4 stack at specific commit</a></p></li>
<li><p><a class="reference internal" href="#publish-to-main-conda-label">Publish to main conda label</a></p></li>
<li><p><a class="reference internal" href="#build-psi4conda-set">Build Psi4conda set</a></p></li>
<li><p><a class="reference internal" href="#generate-download-page-for-psicode-org">Generate download page for psicode.org</a></p></li>
<li><p><a class="reference internal" href="#collect-documentation-snapshot">Collect documentation snapshot</a></p></li>
<li><p><a class="reference internal" href="#publish-github-release">Publish GitHub release</a></p></li>
<li><p><a class="reference internal" href="#publish-psicode-release">Publish psicode release</a></p></li>
<li><p><a class="reference internal" href="#finalize-release">Finalize release</a></p></li>
<li><p><a class="reference internal" href="#reset-psi4meta-for-nightly-operation">Reset psi4meta for nightly operation</a></p></li>
</ul>
</section>
<section id="post-release-e-g-v1-3-1">
<span id="faq-postreleaseprocedure"></span><h2>Post-Release (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3.1</span></code>)<a class="headerlink" href="#post-release-e-g-v1-3-1" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#assemble-postrelease-changes">Assemble postrelease changes</a></p></li>
<li><p><a class="reference internal" href="#tweak-conda-for-postrelease">Tweak Conda for postrelease</a></p></li>
<li><p><a class="reference internal" href="#do-final-pass-before-release-tag">Do final pass before release tag</a></p></li>
<li><p><a class="reference internal" href="#tag-postrelease">Tag postrelease</a></p></li>
<li><p><a class="reference internal" href="#build-conda-psi4-stack-at-specific-commit">Build Conda Psi4 stack at specific commit</a></p></li>
<li><p><a class="reference internal" href="#publish-to-main-conda-label">Publish to main conda label</a></p></li>
<li><p><a class="reference internal" href="#build-psi4conda-set">Build Psi4conda set</a></p></li>
<li><p><a class="reference internal" href="#generate-download-page-for-psicode-org">Generate download page for psicode.org</a></p></li>
<li><p><a class="reference internal" href="#collect-documentation-snapshot">Collect documentation snapshot</a></p></li>
<li><p><a class="reference internal" href="#publish-github-postrelease">Publish GitHub postrelease</a></p></li>
<li><p><a class="reference internal" href="#publish-psicode-release">Publish psicode release</a></p></li>
<li><p><a class="reference internal" href="#finalize-release">Finalize release</a></p></li>
<li><p><a class="reference internal" href="#reset-psi4meta-for-nightly-operation">Reset psi4meta for nightly operation</a></p></li>
</ul>
</section>
<section id="update-copyright-year">
<h2>Update copyright year<a class="headerlink" href="#update-copyright-year" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">~/path/to/psi4</span></code></p></li>
<li><p>Primary target is licenses</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">-rl</span> <span class="pre">&quot;(c)</span> <span class="pre">2007-2017&quot;</span> <span class="pre">*</span> <span class="pre">|</span> <span class="pre">xargs</span> <span class="pre">sed</span> <span class="pre">-i</span> <span class="pre">''</span> <span class="pre">&quot;s/(c)</span> <span class="pre">2007-2017/(c)</span> <span class="pre">2007-2018/g&quot;</span></code></p></li>
<li><p>On Linux, drop the <code class="docutils literal notranslate"><span class="pre">''</span></code> in above command</p></li>
<li><p>Need to do <code class="docutils literal notranslate"><span class="pre">psi4/</span></code> and <code class="docutils literal notranslate"><span class="pre">docs/</span></code> dirs</p></li>
</ul>
</li>
<li><p>Also, license in these files</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tests/runtest.py</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">README.md</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tests/psitest.pl</span></code></p></li>
</ul>
</li>
<li><p>Also, in content of <a class="reference external" href="https://github.com/psi4/psi4/blob/master/doc/sphinxman/source/conf.py.in#L118">https://github.com/psi4/psi4/blob/master/doc/sphinxman/source/conf.py.in#L118</a></p></li>
</ul>
</section>
<section id="update-samples">
<h2>Update samples<a class="headerlink" href="#update-samples" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">sphinxman</span></code> at least once by hand</p></li>
<li><p>Check in resulting <code class="docutils literal notranslate"><span class="pre">psifiles.py</span></code> and all the updated and new <code class="docutils literal notranslate"><span class="pre">samples/</span></code> files and dirs</p></li>
<li><p>Make a lone PR and warn reviewers not to read it, since autogenerated</p></li>
</ul>
</section>
<section id="collect-new-authors">
<h2>Collect new authors<a class="headerlink" href="#collect-new-authors" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Survey contributions to current Milestone. Add new contribs and PR lists to release notes GitHub issue</p></li>
<li><p>Figure out any new “Additional Contributors” authors since last release</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">psi4/header.py</span></code> accordingly, make PR</p></li>
<li><p>Get permission of new authors and their particulars for <code class="docutils literal notranslate"><span class="pre">codemeta.json</span></code></p></li>
<li><p>Invite any contributors with at least 3 PRs to join GitHub Organization</p></li>
</ul>
</section>
<section id="anticipate-next-release">
<h2>Anticipate next release<a class="headerlink" href="#anticipate-next-release" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Bump version in <code class="docutils literal notranslate"><span class="pre">codemeta.json</span></code>, <a class="reference external" href="https://github.com/psi4/psi4/blob/master/codemeta.json#L9">https://github.com/psi4/psi4/blob/master/codemeta.json#L9</a></p></li>
<li><p>Add to branch list in <code class="docutils literal notranslate"><span class="pre">azure-pipelines.yml</span></code>, <a class="reference external" href="https://github.com/psi4/psi4/blob/master/azure-pipelines.yml">psi4/azure-pipelines.yml</a></p></li>
</ul>
</section>
<section id="build-conda-ecosystem-stack">
<h2>Build Conda ecosystem stack<a class="headerlink" href="#build-conda-ecosystem-stack" title="Permalink to this headline">¶</a></h2>
<p>By “ecosystem stack”, mean packages that are upstream, downstream, required, and optional for a fully featured Psi4 build and which we can’t get from “defaults” or “conda-forge” channels.</p>
<ul class="simple">
<li><p>Main directions are in [cbcy](<a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/conda-recipes/conda_build_config.yaml">https://github.com/psi4/psi4meta/blob/master/conda-recipes/conda_build_config.yaml</a>) and [poodle](<a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/psinet-nightly/kitandkapoodle.py">https://github.com/psi4/psi4meta/blob/master/psinet-nightly/kitandkapoodle.py</a>)</p></li>
<li><p>A couple weeks before the first “rc” is planned, start going through L/LT in poodle, checking with upstream to see if new versions have been released. If good changes present, rebuild the packages, changing the version numbers in the respective recipes</p></li>
<li><p>When L/LT all built and passed, edit the individual package version numbers in cbcy and increment to a new <code class="docutils literal notranslate"><span class="pre">ltrtver</span></code> with updated version numbers and/or build numbers (only if code changes)</p></li>
<li><p>Build L/PSI4. If any trouble, edit psi4 code. Iterate until builds and passes. This stage is the only full ctest &amp; pytest on Psi4+upstream</p></li>
<li><p>Build L/RT-MP. If any trouble, edit code in L/RT and rebuild those package(s). Iterate until builds and passes. This stage is the only full ctest &amp; pytest of Psi4+downstream</p></li>
<li><p>Build L/DEV. If any trouble, edit psi4 build system, plugin system, or OpenMP setup. Iterate until builds and passes</p></li>
<li><p>Build L/DOCS. If any trouble, edit the docs or the tests. Iterate until builds and passes</p></li>
<li><p>Results of last should upload to psicode.org (docs) and codecov.io (coverage)</p></li>
<li><p>Changes to targets’ “source” and “version” in individual recipes should be edited in psi4 <code class="docutils literal notranslate"><span class="pre">external/*/*/CMakeLists.txt</span></code> files</p></li>
<li><p>Once everything’s working on Linux, repeat on Mac</p></li>
<li><p>At this point, ready to fine-tune builds of “Psi4 stack”</p></li>
</ul>
</section>
<section id="assemble-postrelease-changes">
<h2>Assemble postrelease changes<a class="headerlink" href="#assemble-postrelease-changes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Collect PRs with “backport” label, and request other backport suggestions on upcoming RN issue</p></li>
<li><p>Cherry-pick backport PRs and commits, apply other changes manually, not forgetting CI files</p></li>
<li><p>Do the draft parts of <a class="reference internal" href="#publish-github-postrelease">Publish GitHub postrelease</a></p></li>
<li><p>Test thoroughly locally, including psi4-rt (may have to step back for dependency versions or builds)</p></li>
<li><p>Note that while can’t change maintenance branch’s history, can push to it directly on upstream</p></li>
<li><p>If want to do trial conda builds, requires <code class="docutils literal notranslate"><span class="pre">source/git_tag:</span> <span class="pre">1.3.x</span></code> and fake <code class="docutils literal notranslate"><span class="pre">package/version:</span> <span class="pre">v1.3.1rc1</span></code></p></li>
</ul>
</section>
<section id="tweak-conda-for-postrelease">
<h2>Tweak Conda for postrelease<a class="headerlink" href="#tweak-conda-for-postrelease" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>In psi4-* recipes, find the best combination of master meta.yaml/build.sh and the v1N(x-1)-labeled ones</p>
<ul>
<li><p>comment out any dependencies in master but not yet in postrelease</p></li>
<li><p>add <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">dep_bld</span> <span class="pre">}}</span></code> entries if needed to step back build. make sure normal operation is <code class="docutils literal notranslate"><span class="pre">''</span></code></p></li>
</ul>
</li>
<li><p>In cbcy,</p>
<ul>
<li><p>create a postrelease new line and record anything not in continuous order with &lt;&gt; or blanking</p></li>
<li><p>step back any dependencies versions or build numbers to ones compatible with the postrelease</p></li>
</ul>
</li>
</ul>
</section>
<section id="do-final-pass-before-release-tag">
<h2>Do final pass before release tag<a class="headerlink" href="#do-final-pass-before-release-tag" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Check that <a class="reference external" href="https://github.com/psi4/psi4/blob/master/external/">psi4/external/</a> repos and commits have been updated to match conda recipes sources. Also check versions with <code class="docutils literal notranslate"><span class="pre">conda_build_config.yaml</span></code></p></li>
<li><p>Check <a class="reference external" href="https://github.com/psi4/psi4/blob/master/doc/sphinxman/source/introduction.rst">psi4/doc/sphinxman/source/introduction.rst</a> for any compiler and Python minimum requirements to edit.</p></li>
</ul>
</section>
<section id="tag-pre-release">
<h2>Tag (pre)release<a class="headerlink" href="#tag-pre-release" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>Thorough version bump directions at master <a class="reference external" href="http://psicode.org/psi4manual/master/manage_git.html#how-to-bump-a-version">http://psicode.org/psi4manual/master/manage_git.html#how-to-bump-a-version</a></p></li>
<li><p>Below is tl;dr</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># be on clean master up-to-date with upstream in both commits and tags</span>
<span class="c1"># * mind which version strings get &quot;v&quot; and which don&#39;t</span>
<span class="c1"># * if not fork, replace &quot;upstream&quot; with &quot;origin&quot;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">vi</span> <span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">diff</span>
<span class="n">diff</span> <span class="o">--</span><span class="n">git</span> <span class="n">a</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span> <span class="n">b</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">...</span>
<span class="o">-</span><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.3rc1&#39;</span>
<span class="o">-</span><span class="n">__version_long</span> <span class="o">=</span> <span class="s1">&#39;1.3rc1+5a7522a&#39;</span>
<span class="o">-</span><span class="n">__version_upcoming_annotated_v_tag</span> <span class="o">=</span> <span class="s1">&#39;1.3rc2&#39;</span>
<span class="o">+</span><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.3rc2&#39;</span>
<span class="o">+</span><span class="n">__version_long</span> <span class="o">=</span> <span class="s1">&#39;1.3rc2+zzzzzzz&#39;</span>
<span class="o">+</span><span class="n">__version_upcoming_annotated_v_tag</span> <span class="o">=</span> <span class="s1">&#39;1.3rc3&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">add</span> <span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;v1.3rc2&quot;</span>
<span class="p">[</span><span class="n">master</span> <span class="n">bc8d7f5</span><span class="p">]</span> <span class="n">v1</span><span class="mf">.3</span><span class="n">rc2</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">log</span> <span class="o">--</span><span class="n">oneline</span> <span class="o">|</span> <span class="n">head</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">bc8d7f5</span> <span class="n">v1</span><span class="mf">.3</span><span class="n">rc2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">tag</span> <span class="o">-</span><span class="n">a</span> <span class="n">v1</span><span class="mf">.3</span><span class="n">rc2</span> <span class="n">bc8d7f5</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;v1.3rc2&quot;</span>

<span class="c1"># pause here and push to upstream and let Azure complete if want an</span>
<span class="c1">#       on-tag Windows conda package, not just tag+1.dev1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">vi</span> <span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">diff</span>
<span class="n">diff</span> <span class="o">--</span><span class="n">git</span> <span class="n">a</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span> <span class="n">b</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">...</span>
<span class="o">-</span><span class="n">__version_long</span> <span class="o">=</span> <span class="s1">&#39;1.3rc2+zzzzzzz&#39;</span>
<span class="o">+</span><span class="n">__version_long</span> <span class="o">=</span> <span class="s1">&#39;1.3rc2+bc8d7f5&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">add</span> <span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Records tag for v1.3rc2&quot;</span>
<span class="p">[</span><span class="n">master</span> <span class="mi">16</span><span class="n">dbd3e</span><span class="p">]</span> <span class="n">Records</span> <span class="n">tag</span> <span class="k">for</span> <span class="n">v1</span><span class="mf">.3</span><span class="n">rc2</span>

<span class="c1"># goto GH:psi4/psi4 &gt; Settings &gt; Branches &gt; master &gt; Edit</span>
<span class="c1">#      https://github.com/psi4/psi4/settings/branch_protection_rules/424295</span>
<span class="c1"># uncheck &quot;Include administrators&quot; and Save changes</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span> <span class="n">master</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span> <span class="n">v1</span><span class="mf">.3</span><span class="n">rc2</span>

<span class="c1"># re-engage &quot;Include administrators&quot; protections</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="tag-postrelease">
<h2>Tag postrelease<a class="headerlink" href="#tag-postrelease" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># be on clean maintenance branch up-to-date with upstream in both commits and tags</span>
<span class="c1"># * mind which version strings get &quot;v&quot; and which don&#39;t</span>
<span class="c1"># * if not fork, replace &quot;upstream&quot; with &quot;origin&quot;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">x</span>
<span class="n">Switched</span> <span class="n">to</span> <span class="n">branch</span> <span class="s1">&#39;1.3.x&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">vi</span> <span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">diff</span>
<span class="n">diff</span> <span class="o">--</span><span class="n">git</span> <span class="n">a</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span> <span class="n">b</span><span class="o">/</span><span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">...</span>
<span class="o">-</span><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.3&#39;</span>
<span class="o">-</span><span class="n">__version_long</span> <span class="o">=</span> <span class="s1">&#39;1.3+zzzzzzz&#39;</span>
<span class="o">+</span><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;1.3.1&#39;</span>
<span class="o">+</span><span class="n">__version_long</span> <span class="o">=</span> <span class="s1">&#39;1.3.1+zzzzzzz&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">add</span> <span class="n">psi4</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="n">py</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;v1.3.1&quot;</span>
<span class="p">[</span><span class="mf">1.3</span><span class="o">.</span><span class="n">x</span> <span class="mi">2</span><span class="n">ce1c29</span><span class="p">]</span> <span class="n">v1</span><span class="mf">.3.1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">log</span> <span class="o">--</span><span class="n">oneline</span> <span class="o">|</span> <span class="n">head</span> <span class="o">-</span><span class="mi">1</span>
<span class="mi">786</span><span class="n">fb2b</span> <span class="n">v1</span><span class="mf">.3.1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">tag</span> <span class="o">-</span><span class="n">a</span> <span class="n">v1</span><span class="mf">.3.1</span> <span class="mi">2</span><span class="n">ce1c29</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;v1.3.1&quot;</span>

<span class="c1"># skipping the hash recording and &quot;upcoming&quot; step b/c only tags matter on maintenance branch</span>

<span class="c1"># free pushing to maintenance branches at present so GitHub interface steps not needed</span>
<span class="c1"># goto GH:psi4/psi4 &gt; Settings &gt; Branches &gt; 1.3.x &gt; Edit</span>
<span class="c1">#      https://github.com/psi4/psi4/settings/branch_protection_rules/4385008  # !Varies!</span>
<span class="c1"># uncheck &quot;Include administrators&quot; and Save changes</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">x</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span> <span class="n">v1</span><span class="mf">.3.1</span>

<span class="c1"># re-engage &quot;Include administrators&quot; protections</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="initialize-release-branch">
<h2>Initialize release branch<a class="headerlink" href="#initialize-release-branch" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>follow tagging procedure</p></li>
<li><p>before re-engaing the “include admin” button, push a branch at the tag commit (not the records commit)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">git</span> <span class="n">log</span> <span class="o">--</span><span class="n">online</span> <span class="o">|</span> <span class="n">head</span> <span class="o">-</span><span class="mi">2</span>
<span class="go">45315cb Records tag for v1.3</span>
<span class="go">20e5c7e v1.3</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">git</span> <span class="n">checkout</span> <span class="mf">20e5</span><span class="n">c7e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">x</span>
<span class="go">Switched to a new branch &#39;1.3.x&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">git</span> <span class="n">push</span> <span class="n">upstream</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</li>
<li><p>set up new branch as protected branch through GitHub psi4 org Settings. Should be already covered under 1.*.x rule.</p></li>
</ul>
</section>
<section id="build-conda-psi4-stack-at-specific-commit">
<h2>Build Conda Psi4 stack at specific commit<a class="headerlink" href="#build-conda-psi4-stack-at-specific-commit" title="Permalink to this headline">¶</a></h2>
<p>By “Psi4 stack”, mean packages <code class="docutils literal notranslate"><span class="pre">psi4</span></code>, <code class="docutils literal notranslate"><span class="pre">psi4-rt</span></code>, <code class="docutils literal notranslate"><span class="pre">psi4-dev</span></code>.
Package <code class="docutils literal notranslate"><span class="pre">psi4-docs</span></code> used to be in “Psi4 stack”, but it’s handled by GHA and netlify now, not Conda, so skip directions below.
Other packages, the “ecosystem stack” (e.g., <code class="docutils literal notranslate"><span class="pre">libint</span></code>, <code class="docutils literal notranslate"><span class="pre">v2rdm_casscf</span></code>) should be already built.</p>
<ul class="simple">
<li><p>Check poodle for stray channels that may have crept in for dependencies (like c-f for ACS season). Copy over new dependencies if needed to psi4 channel</p></li>
<li><p>Particularly before release (not prerelease), consider max pinnings on dependencies, particularly any fast-moving dependencies (e.g., qcel) and whether they need version space to grow compatibly and grow incompatibly.</p></li>
<li><p>Nightly conda-builds work from <code class="docutils literal notranslate"><span class="pre">master</span></code> psi4. (Postrelease “practice” works from <code class="docutils literal notranslate"><span class="pre">1.N.x</span></code> psi4.)</p>
<ul>
<li><p>Instead, switch <code class="docutils literal notranslate"><span class="pre">source/git_tag</span></code> from <code class="docutils literal notranslate"><span class="pre">master</span></code> to tag (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3rc1</span></code>) in:</p>
<ul>
<li><p>psi4-multiout on Linux &amp; Mac, <a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/conda-recipes/psi4-multiout/meta.yaml#L10">https://github.com/psi4/psi4meta/blob/master/conda-recipes/psi4-multiout/meta.yaml#L10</a></p></li>
<li><p>psi4-docs on Linux, <a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/conda-recipes/psi4-docs/meta.yaml#L10">https://github.com/psi4/psi4meta/blob/master/conda-recipes/psi4-docs/meta.yaml#L10</a> on L</p></li>
</ul>
</li>
<li><p>In cbcy, edit <code class="docutils literal notranslate"><span class="pre">psi4ver</span></code> to “v”-less tag</p></li>
</ul>
</li>
<li><p>For releases and postreleases (not prereleases), in <code class="docutils literal notranslate"><span class="pre">conda_build_config.yaml</span></code>, edit <code class="docutils literal notranslate"><span class="pre">ltrtver</span></code> to a new non-dev label (probably a ditto) matching the release (e.g., “1.3”)</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">kitandkapoodle.py</span></code> to the normal <code class="docutils literal notranslate"><span class="pre">***</span></code> stack. Should be (<code class="docutils literal notranslate"><span class="pre">psi4</span></code>, <code class="docutils literal notranslate"><span class="pre">psi4-rt</span></code>, <code class="docutils literal notranslate"><span class="pre">psi4-dev</span></code>) * python_versions for Linux &amp; Mac. Also single <code class="docutils literal notranslate"><span class="pre">psi4-docs</span></code>     from Linux</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">kitandkapoodle.py</span></code> and allow stack to upload to anaconda.org to <code class="docutils literal notranslate"><span class="pre">psi4/label/dev</span></code>. Poodle emits with <code class="docutils literal notranslate"><span class="pre">--label</span> <span class="pre">dev</span></code> so will go to the subchannel. May need to delete packages to clear out space on anaconda.org</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">meta.yaml</span></code> and <code class="docutils literal notranslate"><span class="pre">build.sh</span></code> of at least <code class="docutils literal notranslate"><span class="pre">psi4-multiout</span></code> and <code class="docutils literal notranslate"><span class="pre">psi4-rt</span></code> to e.g., v121-build.sh files for easy reference or rebuilding as dependencies in master change.</p></li>
</ul>
</section>
<section id="publish-to-main-conda-label">
<h2>Publish to main conda label<a class="headerlink" href="#publish-to-main-conda-label" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Go through each active conda package off <a class="reference external" href="https://anaconda.org/psi4/repo">https://anaconda.org/psi4/repo</a></p>
<ul>
<li><p>Find the most recent build set (Linux/Mac, active py versions) that <code class="docutils literal notranslate"><span class="pre">psi4</span></code>/<code class="docutils literal notranslate"><span class="pre">psi4-rt</span></code>/<code class="docutils literal notranslate"><span class="pre">psi4-dev</span></code> is using</p></li>
<li><p>_add_ (not replace) the <code class="docutils literal notranslate"><span class="pre">main</span></code> label.</p></li>
</ul>
</li>
<li><p>This makes a <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">psi4</span> <span class="pre">-c</span> <span class="pre">psi4</span></code> get everything psi4 needs. For the moment <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">psi4</span> <span class="pre">-c</span> <span class="pre">psi4/label/dev</span></code> will get the same set, until package psi4-1.4a1.dev1 gets uploaded. May help to check versions and build versions against ltrtver in <code class="docutils literal notranslate"><span class="pre">conda_build_config.yaml</span></code>.</p></li>
<li><p>This step is manual, so takes a while. (It gets checked when Psi4conda installers are built b/c that pulls from “main”, not “dev”)</p></li>
</ul>
</section>
<section id="build-psi4conda-set-pre-spring-2021">
<h2>Build Psi4conda set (pre-Spring 2021)<a class="headerlink" href="#build-psi4conda-set-pre-spring-2021" title="Permalink to this headline">¶</a></h2>
<p>Installers are build using the project <code class="docutils literal notranslate"><span class="pre">constructor</span></code> and build binary bash scripts, one per OS per Python version. In analogy to Miniconda, they’re called Psi4Conda. They can be built anywhere (Mac can be built on Linux) and get served from vergil (cdsgroup webserver).</p>
<ul>
<li><p>Need a conda env with <code class="docutils literal notranslate"><span class="pre">constructor</span></code> and <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code>. This env presently accessed through <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">activate</span> <span class="pre">cookie</span></code>.</p></li>
<li><p>Enter “constructor-cutter-unified” in the psi4meta repo. There’s a good README there, <a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/conda-recipes/constructor-cutter-unified/README.md">https://github.com/psi4/psi4meta/blob/master/conda-recipes/constructor-cutter-unified/README.md</a></p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">cookiecutter/cookiecutter.json</span></code> for control</p>
<ul class="simple">
<li><p>Edit which python versions, if necessary</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">release</span></code> field</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">hash</span></code> field. This is the 7-char hash that’s on every psi4 conda pkg as part of version</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">ltrtver</span></code> field. This matches the current setting in <code class="docutils literal notranslate"><span class="pre">conda_build_config.yaml</span></code></p></li>
<li><p>For prereleases, <code class="docutils literal notranslate"><span class="pre">&quot;channel_tag&quot;:</span> <span class="pre">&quot;/label/dev&quot;</span></code>, while for (post)releases, it should be the empty string</p></li>
<li><p>Leave this file set to a “rc” with Git, as that has more details</p></li>
</ul>
</li>
<li><p>For (post)releases (not prereleases), copy cookiecutter.json to cookiecutter.json-vXXX</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">cookiecutter/{{.../construct.yaml</span></code> for templating. This is rarely needed</p></li>
<li><p>If it’s been a while or you need the space, clear out <code class="docutils literal notranslate"><span class="pre">~/.conda/constructor</span></code>, where the downloaded packages are cached</p></li>
<li><p>Note that installers get written to <code class="docutils literal notranslate"><span class="pre">build/</span></code> and this gets regenerated each time. Clear out between runs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">run.py</span></code></p></li>
<li><p>[Outdated] Watch out for <code class="docutils literal notranslate"><span class="pre">py_</span></code> in buildstring as this means a noarch package has been pulled. It must be eliminated. Constructors can’t handle “noarch” packages and will fail at runtime. If see a “noarch” package, must find the recipe and rebuild for all OS &amp; Python combinations. Then run constructor again.</p></li>
<li><p>[Replacement] After adding a post_install to reposition the noarch packages, they are safe to include.</p></li>
<li><p>If fetching times out, may have to run run.py several times. Clear out build/ in between. It’s the fetching that takes a long time, not constucting</p></li>
<li><p>In the end, should have several installers</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="n">build</span><span class="o">/</span><span class="n">psi4conda</span><span class="o">-</span><span class="mf">1.3</span><span class="o">-</span><span class="n">py3</span><span class="o">.*/*</span><span class="mf">64.</span><span class="n">sh</span>
<span class="go">-rwxr-xr-x. 516M Feb 28 20:30 build/psi4conda-1.3-py3.6-linux-64/psi4conda-1.3-py36-Linux-x86_64.sh</span>
<span class="go">-rwxr-xr-x. 299M Feb 28 20:31 build/psi4conda-1.3-py3.6-osx-64/psi4conda-1.3-py36-MacOSX-x86_64.sh</span>
<span class="go">-rwxr-xr-x. 518M Feb 28 20:30 build/psi4conda-1.3-py3.7-linux-64/psi4conda-1.3-py37-Linux-x86_64.sh</span>
<span class="go">-rwxr-xr-x. 299M Feb 28 20:31 build/psi4conda-1.3-py3.7-osx-64/psi4conda-1.3-py37-MacOSX-x86_64.sh</span>
</pre></div>
</div>
</li>
<li><p>Upload installer files to vergil, <code class="docutils literal notranslate"><span class="pre">scp</span> <span class="pre">-r</span> <span class="pre">build/Psi4*/Psi4*sh</span> <span class="pre">root&#64;vergil.chemistry.gatech.edu:/var/www/html/psicode-download/</span></code></p></li>
<li><p>Log in to vergil root and make WindowsWSL symlinks</p></li>
</ul>
</section>
<section id="build-psi4conda-set">
<h2>Build Psi4conda set<a class="headerlink" href="#build-psi4conda-set" title="Permalink to this headline">¶</a></h2>
<p>Installers are build using the project <code class="docutils literal notranslate"><span class="pre">constructor</span></code> and build binary bash or exe scripts, one per OS per Python version. In analogy to Miniconda, they’re called Psi4Conda. They are built through GHA on the psi4meta repo and get served from vergil (cdsgroup webserver).</p>
<ul class="simple">
<li><p>Edit recipe <a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/installers/construct.yaml">https://github.com/psi4/psi4meta/blob/master/installers/construct.yaml</a></p>
<ul>
<li><p>Edit the top matter for Configuration. See snapshots in directory for examples.</p>
<ul>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">release</span></code> fields. (Windows is often <code class="docutils literal notranslate"><span class="pre">dev1</span></code> unless separate steps.)</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">ltrtver</span></code> field. This matches the current setting in <code class="docutils literal notranslate"><span class="pre">conda_build_config.yaml</span></code></p></li>
<li><p>For prereleases, <code class="docutils literal notranslate"><span class="pre">&quot;channel_tag&quot;:</span> <span class="pre">&quot;/label/dev&quot;</span></code>, while for (post)releases, it should be the empty string</p></li>
</ul>
</li>
<li><p>Edit the packages and channels info if necessary. Probably long-term stable.</p></li>
</ul>
</li>
<li><p>Edit the GHA control file <a class="reference external" href="https://github.com/psi4/psi4meta/blob/master/.github/workflows/Installers.yml">https://github.com/psi4/psi4meta/blob/master/.github/workflows/Installers.yml</a> matrix.cfg</p></li>
<li><p>All conda packages must already have been built and in the right <code class="docutils literal notranslate"><span class="pre">channel_tag</span></code> channel.</p></li>
<li><p>Commit <code class="docutils literal notranslate"><span class="pre">construct.yaml</span></code> to trigger installer builds.</p></li>
<li><p>When all build successfully, hover over the artifacts, and note the consecutive numbers GH has assigned them. These artifacts only linger for a day.</p></li>
<li><p>Log in to vergil root and move to <code class="docutils literal notranslate"><span class="pre">/var/www/html/psicode-download</span></code>.</p></li>
<li><p>Use the pull_gha_installers script to download the installers from GH to vergil. First two arguments are first and last of the artifact numbers, and third argument is an auth token. <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">pull_gha_installers.sh</span> <span class="pre">47226565</span> <span class="pre">47226573</span> <span class="pre">715...4f3</span></code>.</p></li>
<li><p>Make WindowsWSL and any other symlinks the script head matter advises.</p></li>
</ul>
</section>
<section id="generate-download-page-for-psicode-org">
<h2>Generate download page for psicode.org<a class="headerlink" href="#generate-download-page-for-psicode-org" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Be in repo psicode-hugo-website</p></li>
<li><p>Copy and edit new file akin to <a class="reference external" href="https://github.com/psi4/psicode-hugo-website/blob/master/content/installs/v13rc2.md">https://github.com/psi4/psicode-hugo-website/blob/master/content/installs/v13rc2.md</a>. Note the edition string <code class="docutils literal notranslate"><span class="pre">v13rc2</span></code> in frontmatter for this and future filenames</p></li>
<li><p>Copy and edit new file akin to <a class="reference external" href="https://github.com/psi4/psicode-hugo-website/blob/master/data/installs/v13rc2.yaml">https://github.com/psi4/psicode-hugo-website/blob/master/data/installs/v13rc2.yaml</a> for menu and notes content</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">scripts/</span></code> dir and edit primarily <a class="reference external" href="https://github.com/psi4/psicode-hugo-website/blob/master/scripts/install-generator.py#L9">https://github.com/psi4/psicode-hugo-website/blob/master/scripts/install-generator.py#L9</a> but also any other arrays or messages that should change.</p></li>
<li><p>Run the  <code class="docutils literal notranslate"><span class="pre">install-generator.py</span></code> in place. It will dump new files into <code class="docutils literal notranslate"><span class="pre">data/installs/</span></code> _subdirs_. Be sure to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> them.</p></li>
<li><p>Installer page is now ready.</p></li>
<li><p>Shift “latest” alias in frontmatter from whichever page is currently active to the new page. This makes sure “Downloads” on the navigation bar points to new page.</p></li>
<li><p>Conscientiously, one should test</p>
<ul>
<li><p>installer downloads in Mac and Linux. And actually installing them and <code class="docutils literal notranslate"><span class="pre">psi4</span> <span class="pre">--test</span></code> them.</p></li>
<li><p>that download button and <code class="docutils literal notranslate"><span class="pre">curl</span></code> downloading register on the download counters on vergil</p></li>
</ul>
</li>
<li><p>Commit the new files, PR, and deploy psicode site</p></li>
<li><p>Petition on Slack for testers</p></li>
</ul>
</section>
<section id="collect-documentation-snapshot">
<h2>Collect documentation snapshot<a class="headerlink" href="#collect-documentation-snapshot" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Documentation is built automatically by GHA from the latest psi4 master commit. It gets pushed to the psi4/psi4docs repository and thence served by netlify to a site independent of psicode.org. The netlify psicode.org site has a redirect so that psicode.org/psi4manual/master presents the psi4docs netlify content.</p></li>
<li><p>GHA controller is <a class="reference external" href="https://github.com/psi4/psi4/blob/master/.github/workflows/docs.yml">https://github.com/psi4/psi4/blob/master/.github/workflows/docs.yml</a></p></li>
<li><p>This setup works great for “latest” docs, but it won’t build a nice copy on the tag because the tag commit is pushed before the tag itself, so the version shows up “undefined”.</p></li>
<li><p>So, anytime after “Tag (pre)release” is over, navigate on psi4 GH to the tag commit (not the record commit) and retrigger the docs GHA. Download the artifact (zipped docs dir) at the end to a local computer.</p></li>
<li><p>In your hugo site clone, create a new directory under <code class="docutils literal notranslate"><span class="pre">static/psi4manual</span></code>. Copy the zipped docs there, unpack, rearrange so that <code class="docutils literal notranslate"><span class="pre">static/psi4manual/&lt;new-tag&gt;/index.html</span></code> is present. Check in.</p></li>
</ul>
</section>
<section id="publish-github-release">
<h2>Publish GitHub release<a class="headerlink" href="#publish-github-release" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>On GitHub site “Draft a New Release” with newly minted tag</p></li>
<li><p>Fill in frontmatter style and links from previous GitHub release</p></li>
<li><p>Fill in RN from hopefully existing RN issue</p></li>
<li><p>Fill in RN by going through the top posts from all PRs from this milestone</p></li>
<li><p>“publish” release. This establishes release date for GitHub API</p></li>
<li><p>Close the RN issue.</p></li>
<li><p>Close the milestone (should be 100% complete).</p></li>
</ul>
</section>
<section id="publish-github-postrelease">
<h2>Publish GitHub postrelease<a class="headerlink" href="#publish-github-postrelease" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>On GitHub site “Draft a New Release” for anticipated or newly minted tag</p></li>
<li><p>Fill in frontmatter style and links from previous GitHub release</p></li>
<li><p>Fill in RN as cherry-pick to or edit on branch</p></li>
<li><p>“publish” release. This establishes release date for GitHub API</p></li>
</ul>
</section>
<section id="publish-psicode-release">
<h2>Publish psicode release<a class="headerlink" href="#publish-psicode-release" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Copy a recent release page like <a class="reference external" href="https://github.com/psi4/psicode-hugo-website/blob/master/content/posts/v1p2.md">https://github.com/psi4/psicode-hugo-website/blob/master/content/posts/v1p2.md</a></p></li>
<li><p>Edit its filename, title, date, image, and links</p></li>
<li><p>Execute <a class="reference external" href="https://api.github.com/repos/psi4/psi4/releases/latest">https://api.github.com/repos/psi4/psi4/releases/latest</a> and note the <code class="docutils literal notranslate"><span class="pre">id</span></code> field value</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">id</span></code> value in the shortcode call at the bottom</p></li>
</ul>
</section>
<section id="finalize-release">
<h2>Finalize release<a class="headerlink" href="#finalize-release" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Make new PR with
* edits to main <code class="docutils literal notranslate"><span class="pre">README.md</span></code> badges, python versions, etc.
* edits to <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> <code class="docutils literal notranslate"><span class="pre">find_package(PythonLibsNew</span> <span class="pre">3.6</span> <span class="pre">REQUIRED)</span></code></p></li>
<li><p>Tweet about release</p></li>
</ul>
</section>
<section id="reset-psi4meta-for-nightly-operation">
<h2>Reset psi4meta for nightly operation<a class="headerlink" href="#reset-psi4meta-for-nightly-operation" title="Permalink to this headline">¶</a></h2>
<p>On both Linux and Mac:</p>
<ul class="simple">
<li><p>After (post)release (not prerelease), in <code class="docutils literal notranslate"><span class="pre">conda_build_config.yaml</span></code>, edit <code class="docutils literal notranslate"><span class="pre">ltrtver</span></code> to a new “release.dev” label</p></li>
<li><p>After postrelease, unpin any dependencies in cbcy that needed older either ver or bld (e.g., v2rdm_casscf_bld)</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">psi4ver</span></code> back to <code class="docutils literal notranslate"><span class="pre">''</span></code> in cbcy</p></li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">source/git_tag</span></code> back to <code class="docutils literal notranslate"><span class="pre">master</span></code> for psi4-multiout, psi4-docs</p></li>
<li><p>Edit build string back to <code class="docutils literal notranslate"><span class="pre">0</span></code> if psi4-multiout needed multiple passes</p></li>
<li><p>Edit kitandkapoodle.py back to <code class="docutils literal notranslate"><span class="pre">***</span></code> stack</p></li>
<li><p>Check in all release, construct, recipe changes on Linux and Mac. Synchronize both to GitHub psi4meta</p></li>
<li><p>Copy meta.yaml and build.sh files to vMmp-prefixed files for the record.</p></li>
<li><p>Edit crontab back to 2am “norm”. Comment out “anom”</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="index.html" title="index">
          <img class="logo" src="_static/psi4square.png" alt="Logo"/>
        </a></p><!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->


<div id="searchbox" style="display: none" role="search">
  <!--<h3>Quick search</h3>-->
    <form class="search" action="search.html" method="get">
      <!--<div><input type="text" name="q" placeholder="search docs" /></div>-->
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel" /></div>
      <!--<div><input type="submit" value="Go" /></div>-->
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Release Procedures</a><ul>
<li><a class="reference internal" href="#annual">Annual</a></li>
<li><a class="reference internal" href="#pre-release-e-g-v1-3rc1">Pre-Release (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3rc1</span></code>)</a></li>
<li><a class="reference internal" href="#release-e-g-v1-3">Release (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3</span></code>)</a></li>
<li><a class="reference internal" href="#post-release-e-g-v1-3-1">Post-Release (e.g., <code class="docutils literal notranslate"><span class="pre">v1.3.1</span></code>)</a></li>
<li><a class="reference internal" href="#update-copyright-year">Update copyright year</a></li>
<li><a class="reference internal" href="#update-samples">Update samples</a></li>
<li><a class="reference internal" href="#collect-new-authors">Collect new authors</a></li>
<li><a class="reference internal" href="#anticipate-next-release">Anticipate next release</a></li>
<li><a class="reference internal" href="#build-conda-ecosystem-stack">Build Conda ecosystem stack</a></li>
<li><a class="reference internal" href="#assemble-postrelease-changes">Assemble postrelease changes</a></li>
<li><a class="reference internal" href="#tweak-conda-for-postrelease">Tweak Conda for postrelease</a></li>
<li><a class="reference internal" href="#do-final-pass-before-release-tag">Do final pass before release tag</a></li>
<li><a class="reference internal" href="#tag-pre-release">Tag (pre)release</a></li>
<li><a class="reference internal" href="#tag-postrelease">Tag postrelease</a></li>
<li><a class="reference internal" href="#initialize-release-branch">Initialize release branch</a></li>
<li><a class="reference internal" href="#build-conda-psi4-stack-at-specific-commit">Build Conda Psi4 stack at specific commit</a></li>
<li><a class="reference internal" href="#publish-to-main-conda-label">Publish to main conda label</a></li>
<li><a class="reference internal" href="#build-psi4conda-set-pre-spring-2021">Build Psi4conda set (pre-Spring 2021)</a></li>
<li><a class="reference internal" href="#build-psi4conda-set">Build Psi4conda set</a></li>
<li><a class="reference internal" href="#generate-download-page-for-psicode-org">Generate download page for psicode.org</a></li>
<li><a class="reference internal" href="#collect-documentation-snapshot">Collect documentation snapshot</a></li>
<li><a class="reference internal" href="#publish-github-release">Publish GitHub release</a></li>
<li><a class="reference internal" href="#publish-github-postrelease">Publish GitHub postrelease</a></li>
<li><a class="reference internal" href="#publish-psicode-release">Publish psicode release</a></li>
<li><a class="reference internal" href="#finalize-release">Finalize release</a></li>
<li><a class="reference internal" href="#reset-psi4meta-for-nightly-operation">Reset psi4meta for nightly operation</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="psi4api.html" title="PSI4 API: Linking C++ and Python"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="manage_git.html" title="Git, Versioning"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/manage_release.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/dddb361">1.5a1.dev43</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="manage_index.html" >Managing: Git, Conda, CMake and all that</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">Release Procedures</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, The Psi4 Project.
      Last updated on Thursday, 02 September 2021 01:10PM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>