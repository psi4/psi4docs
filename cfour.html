<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->





<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Interface to CFOUR by J. Stanton &amp; J. Gauss</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/psi4.css?v=5cda37dd" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="_static/documentation_options.js?v=c48af6fd"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Interface to CheMPS2 by S. Wouters" href="chemps2.html" />
    <link rel="prev" title="Interface to the BrianQC GPU module by the BrianQC team" href="brianqc.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="chemps2.html" title="Interface to CheMPS2 by S. Wouters"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="brianqc.html" title="Interface to the BrianQC GPU module by the BrianQC team"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/cfour.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/9addd49">1.9a1.dev55</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="interfacing.html" accesskey="U">Interfaces: Enhancing <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Capabilities</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">Interface to CFOUR by J. Stanton &amp; J. Gauss</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="interface-to-cfour-by-j-stanton-j-gauss">
<span id="sec-cfour"></span><span id="index-0"></span><h1>Interface to CFOUR by J. Stanton &amp; J. Gauss<a class="headerlink" href="#interface-to-cfour-by-j-stanton-j-gauss" title="Link to this heading">¶</a></h1>
<p><em>Code author: Lori A. Burns</em></p>
<p><em>Section author: Lori A. Burns</em></p>
<p><em>Module:</em> <a class="reference internal" href="autodir_options_c/module__cfour.html#apdx-cfour"><span class="std std-ref">Keywords</span></a>, <a class="reference internal" href="autodir_psivariables/module__cfour.html#apdx-cfour-psivar"><span class="std std-ref">PSI Variables</span></a>, <a class="reference internal" href="autodoc_testsuite_cfour.html#apdx-testsuitecfour"><span class="std std-ref">Samples</span></a></p>
<p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> contains code to interface to the Cfour quantum chemistry suite of
John F. Stanton (U. Texas, Austin) and Jürgen Gauss (U. Mainz),
which is available after a license agreement from
<a class="reference external" href="http://www.cfour.de/">http://www.cfour.de/</a>.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<p>Follow the instructions provided with the Cfour download to install the
executable or to build the source. To by used by <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>, the program
binary (<strong class="program">xcfour</strong>) must be found in your <span class="target" id="index-1"></span><a class="reference internal" href="external.html#envvar-PATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a> or
<span class="target" id="index-2"></span><a class="reference internal" href="external.html#envvar-PSIPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PSIPATH</span></code></a>.  The <code class="docutils literal notranslate"><span class="pre">GENBAS</span></code> file containing basis sets in Cfour
format is not necessary for this interface, but if you prefer to access
basis sets the “Cfour way” using a custom <code class="docutils literal notranslate"><span class="pre">GENBAS</span></code> file (the distributed
one is included with the interface), it, too, must be in <span class="target" id="index-3"></span><a class="reference internal" href="external.html#envvar-PATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a> or
<span class="target" id="index-4"></span><a class="reference internal" href="external.html#envvar-PSIPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PSIPATH</span></code></a>. If <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> is unable to execute the binary, an error
will be reported.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The p4c4 interface hasn’t been fully adapted for the new March 2014 version.</p>
</div>
</section>
<section id="cfour-for-psifour-users">
<h2>Cfour for <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Users<a class="headerlink" href="#cfour-for-psifour-users" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Set memory as usual</p></li>
<li><p>Set molecule as usual</p></li>
<li><p>Set basis set as usual (Cfour only cares about orbital basis, no fitting
bases)</p></li>
<li><p>Set the task as usual, indicating Cfour as the intended code by
prepending “c4-” to the method argument. So <code class="docutils literal notranslate"><span class="pre">energy('scf')</span></code> becomes
<code class="docutils literal notranslate"><span class="pre">energy('c4-scf')</span></code> and <code class="docutils literal notranslate"><span class="pre">optimize('ccsd(t)')</span></code> becomes
<code class="docutils literal notranslate"><span class="pre">optimize('c4-ccsd(t)')</span></code>. Find available methods for
<a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a> at <a class="reference internal" href="energy.html#table-energy-cfour"><span class="std std-ref">Energy (CFOUR)</span></a>
and for <a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> at <a class="reference internal" href="opt.html#table-grad-cfour"><span class="std std-ref">Gradient (CFOUR)</span></a>.</p></li>
<li><p>Generally, the p4c4 interface will handle best practices for path of
execution: <code class="docutils literal notranslate"><span class="pre">vcc</span></code>/<code class="docutils literal notranslate"><span class="pre">ecc</span></code>, derivative type, <em>etc.</em> The user is still
responsible for setting convergence, frozen core, guess, diis, <em>etc.</em>
For the moment, so-called “best-practices” keywords are summarized at
<a class="reference internal" href="#table-cfour-cc-program"><span class="std std-ref">Best Practices</span></a>.</p></li>
<li><p>For the type of computation intended, find appropriate options at
<a class="reference internal" href="autodir_options_c/module__cfour.html#apdx-cfour"><span class="std std-ref">Keywords</span></a>. These keyword summaries contain the same
information as the <a class="reference external" href="http://slater.chemie.uni-mainz.de/cfour/index.php?n=Main.ListOfKeywordsInAlphabeticalOrder">proper CFOUR options list</a>
plus notes on keyword relevance when run through <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>.  Information
at the <a class="reference external" href="http://slater.chemie.uni-mainz.de/cfour/index.php?n=Main.Manual">CFOUR manual</a> may
also be useful, as may the many samples at <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour">psi4/samples/cfour</a>.</p></li>
<li><p>Set Cfour keywords just like <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> keywords. The names of keywords
are unchanged beyond a prepended “cfour_”. (Though be aware that common
abbreviations like CALC and REF must be fully spelled out as
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CALC_LEVEL-CFOUR"><span class="xref std std-term">CFOUR_CALC_LEVEL</span></a> and <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_REFERENCE-CFOUR"><span class="xref std std-term">CFOUR_REFERENCE</span></a> when used in
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>.)</p></li>
<li><p>In limited trial cases, keywords nominally directed at non-Cfour modules
are translated into their Cfour counterparts. For example, setting
<a class="reference internal" href="autodoc_glossary_options_c.html#term-REFERENCE-SCF"><span class="xref std std-term">REFERENCE</span></a> will appropriately set <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_REFERENCE-CFOUR"><span class="xref std std-term">CFOUR_REFERENCE</span></a>. For a
list of applicable keywords, see source of
muster_psi4options.</p></li>
<li><p>Consult <a class="reference internal" href="#sec-cfourfunctionality"><span class="std std-ref">Functionality</span></a> for information on what Cfour
functionality is accessible through <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>.</p></li>
</ul>
</section>
<section id="psifour-for-cfour-users">
<h2><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> for Cfour Users<a class="headerlink" href="#psifour-for-cfour-users" title="Link to this heading">¶</a></h2>
<p>In the simplest use of the Psi4/Cfour interface, a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> input file
can simply “wrap” a <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> file and execute <strong class="program">xcfour</strong>. This is
illustrated in the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cfour</span> <span class="p">{</span>
<span class="n">UHF</span><span class="o">-</span><span class="n">SCF</span> <span class="n">energy</span> <span class="n">calculation</span>
<span class="n">N</span>
<span class="n">H</span> <span class="mi">1</span> <span class="n">R</span>
<span class="n">H</span> <span class="mi">1</span> <span class="n">R</span> <span class="mi">2</span> <span class="n">A</span>

<span class="n">R</span><span class="o">=</span><span class="mf">1.008</span>
<span class="n">A</span><span class="o">=</span><span class="mf">105.0</span>

<span class="o">*</span><span class="n">ACES2</span><span class="p">(</span><span class="n">CALC</span><span class="o">=</span><span class="n">HF</span><span class="p">,</span><span class="n">BASIS</span><span class="o">=</span><span class="n">qz2p</span>
<span class="n">MULT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">REF</span><span class="o">=</span><span class="n">UHF</span>
<span class="n">OCCUPATION</span><span class="o">=</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">0</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">0</span>
<span class="n">SCF_CONV</span><span class="o">=</span><span class="mi">12</span>
<span class="n">MEMORY</span><span class="o">=</span><span class="mi">20000000</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;cfour&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the contents of the <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{...}</span></code> block are written directly to a
<code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> file. This is joined by a default <code class="docutils literal notranslate"><span class="pre">GENBAS</span></code> file
(<a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/share/psi4/basis/GENBAS">psi4/psi4/share/psi4/basis/GENBAS</a>).  To preferentially use your own <code class="docutils literal notranslate"><span class="pre">GENBAS</span></code>,
place it in <span class="target" id="index-5"></span><a class="reference internal" href="external.html#envvar-PATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a> or <span class="target" id="index-6"></span><a class="reference internal" href="external.html#envvar-PSIPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PSIPATH</span></code></a>. The line calling
<a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a> with argument <code class="docutils literal notranslate"><span class="pre">'cfour'</span></code> invokes
<strong class="program">xcfour</strong>.</p>
<p>After execution of the <code class="docutils literal notranslate"><span class="pre">energy('cfour')</span></code> line completes, Cfour results
are read back into <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format and are thereafter accessible for
further processing in the input file. See <a class="reference internal" href="#sec-cfouroutput"><span class="std std-ref">Output</span></a> for
details. This storage of results in variables and arrays <em>in memory</em> for
the duration of the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> instance (as opposed to solely <em>in files</em>)
is the only advantage thus far incurred by the P4C4 interface. We’ll call
this mode of basic utility the “sandwich” mode.</p>
<p>Molecule specification in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> allows Cartesians, Z-matrices, mixed
Cartesian/Z-matrix, negation of variables, delayed specification of
variables, specification of fragments, etc., all in a whitespace-tolerant
format. See <a class="reference internal" href="psithonmol.html#sec-moleculespecification"><span class="std std-ref">Molecule and Geometry Specification</span></a> for details and
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/mints5/input.dat">cfour/mints5</a> for examples. When a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>-style molecule is
supplied, its geometry is written to <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> in Cartesian form and the
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_COORDINATES-CFOUR"><span class="xref std std-term">CFOUR_COORDINATES</span></a>=CARTESIAN, <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_UNITS-CFOUR"><span class="xref std std-term">CFOUR_UNITS</span></a>=ANGSTROM,
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CHARGE-CFOUR"><span class="xref std std-term">CFOUR_CHARGE</span></a>, and <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_MULTIPLICITY-CFOUR"><span class="xref std std-term">CFOUR_MULTIPLICITY</span></a> keywords are set
appropriately in the <code class="docutils literal notranslate"><span class="pre">*CFOUR(...)</span></code> directive.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There exist molecules (<em>e.g.</em>, allene) where the
inertial frame is not unique (planes along atoms or between
atoms). The orientation reconciling machinery currently does not
handle these cases and will fail with “Axis unreconcilable between
QC programs”. I will get to this soon.</p>
</div>
<p>Whenever the molecule is supplied in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format, the job control
keywords must be too. All <a class="reference internal" href="autodir_options_c/module__cfour.html#apdx-cfour"><span class="std std-ref">Cfour keywords</span></a> are the usual
ones, prepended by <code class="docutils literal notranslate"><span class="pre">cfour_</span></code> to avoid any possible name conflicts.  As
detailed in <a class="reference internal" href="psithoninput.html#sec-jobcontrol"><span class="std std-ref">Job Control Keywords</span></a>, setting keywords is flexible in
format. The previous example translates to:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># UHF-SCF energy calculation</span>

<span class="n">molecule</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">2</span>                                          <span class="c1"># multiplicity from the MULT keyword</span>
<span class="n">N</span>
<span class="n">H</span> <span class="mi">1</span> <span class="n">R</span>
<span class="n">H</span> <span class="mi">1</span> <span class="n">R</span> <span class="mi">2</span> <span class="n">A</span>

<span class="n">R</span><span class="o">=</span><span class="mf">1.008</span>
<span class="n">A</span><span class="o">=</span><span class="mf">105.0</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="p">{</span>
<span class="n">cfour_CALC_level</span><span class="o">=</span><span class="n">HF</span>                          <span class="c1"># only full keyword names allowed</span>
<span class="n">cfour_BASIS</span><span class="o">=</span><span class="n">qz2p</span>
<span class="c1">#MULT=2                                      # now in molecule {...} block</span>
<span class="n">cfour_REFerence</span><span class="o">=</span><span class="n">UHF</span>
<span class="n">cfour_OCCUPATION</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>  <span class="c1"># arrays in python notation</span>
<span class="n">cfour_SCF_CONV</span><span class="o">=</span><span class="mi">12</span>
<span class="n">cfour_MEMORY</span><span class="o">=</span><span class="mi">20000000</span>
<span class="p">}</span>

<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;cfour&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, note that none of capitalization, equals sign, or whitespace matter
for the keyword commands. Specification of strings and integers requires no
translation; <a class="reference internal" href="notes_c.html#op-c-boolean"><span class="std std-ref">booleans</span></a> have extended freedom of
format; arrays must be translated into Python-style (square-bracket
bounded and comma delimited) of appropriate dimension. There are many
sample inputs in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/cfour/">psi4/tests/cfour/</a> starting with <code class="docutils literal notranslate"><span class="pre">sp-</span></code> that take
examples from the Cfour manual and first run them in sandwich mode and
then run them as translated into <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> only recognizes keywords by their full name, so the common
Cfour keyword abbreviations CALC, REF, etc. must be replaced by their
proper names of <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CALC_LEVEL-CFOUR"><span class="xref std std-term">CFOUR_CALC_LEVEL</span></a>, <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_REFERENCE-CFOUR"><span class="xref std std-term">CFOUR_REFERENCE</span></a>, etc.</p>
</div>
<p>Whenever the molecule is supplied in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format, it is possible to
perform geometry optimizations where Cfour supplies the gradient and the
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> module <a class="reference internal" href="optking.html#sec-optking"><span class="std std-ref">optking</span></a> drives the structural
changes. Because of the limitations on geometry specification for
optimizations in Cfour, optking-driven optimizations are the <em>only</em>
optimizations allowed in the P4C4 interface. (The exception is sandwich
mode, which, of course, permits optimizations with the Cfour optimizer.)
Below is an example of a geometry optimization:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span> <span class="mi">200</span> <span class="n">mb</span>

<span class="n">molecule</span> <span class="p">{</span>
<span class="n">O</span>
<span class="n">H</span> <span class="mi">1</span> <span class="n">R</span>
<span class="n">H</span> <span class="mi">1</span> <span class="n">R</span> <span class="mi">2</span> <span class="n">A</span>

<span class="n">R</span><span class="o">=</span><span class="mf">0.958</span>
<span class="n">A</span><span class="o">=</span><span class="mf">104.5</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="p">{</span>

<span class="n">cfour_CALC_level</span> <span class="n">CCSD</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="n">cfour_BASIS</span>      <span class="n">DZP</span>
<span class="n">cfour_CC_CONV</span>    <span class="mi">12</span>
<span class="n">cfour_LINEQ_CONV</span> <span class="mi">12</span>
<span class="n">cfour_SCF_CONV</span>   <span class="mi">12</span>
<span class="n">g_convergence</span>    <span class="n">cfour</span>
<span class="p">}</span>

<span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;cfour&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the primary change is the exchange of <a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a>
for <a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> to trigger an optimization.  Setting
<a class="reference internal" href="autodoc_glossary_options_c.html#term-G_CONVERGENCE-OPTKING"><span class="xref std std-term">G_CONVERGENCE</span></a>=CFOUR provides a good imitation of Cfour
default convergence criteria. Although Cfour produces gradients only in
its standard orientation and atom ordering, these are transformed back to
input orientation by the P4C4 interface. Several sample inputs in
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/cfour/">psi4/tests/cfour/</a> starting with <code class="docutils literal notranslate"><span class="pre">opt-</span></code> show basic geometry
optimizations. <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/mints5-grad/input.dat">cfour/mints5-grad</a> shows optimizations from a
variety of molecule input formats, and <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/psi-ghost-grad/input.dat">cfour/psi-ghost-grad</a>
shows an optimization with ghosted atoms. To obtain a single gradient
<em>sans</em> optimization, call instead <a class="reference internal" href="api/psi4.driver.gradient.html#psi4.driver.gradient" title="psi4.driver.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a>.</p>
<p>Note that it can be convenient to monitor the progress of a geometry
optimization by grepping the tilde <code class="docutils literal notranslate"><span class="pre">~</span></code> character.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Measures</span> <span class="n">of</span> <span class="n">convergence</span> <span class="ow">in</span> <span class="n">internal</span> <span class="n">coordinates</span> <span class="ow">in</span> <span class="n">au</span><span class="o">.</span>
<span class="n">Criteria</span> <span class="n">marked</span> <span class="k">as</span> <span class="n">inactive</span> <span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">active</span> <span class="o">&amp;</span> <span class="n">met</span> <span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="ow">and</span> <span class="n">active</span> <span class="o">&amp;</span> <span class="n">unmet</span> <span class="p">(</span> <span class="p">)</span><span class="o">.</span>
<span class="o">---------------------------------------------------------------------------------------------</span> <span class="o">~</span>
 <span class="n">Step</span>     <span class="n">Total</span> <span class="n">Energy</span>     <span class="n">Delta</span> <span class="n">E</span>     <span class="n">MAX</span> <span class="n">Force</span>     <span class="n">RMS</span> <span class="n">Force</span>      <span class="n">MAX</span> <span class="n">Disp</span>      <span class="n">RMS</span> <span class="n">Disp</span>    <span class="o">~</span>
<span class="o">---------------------------------------------------------------------------------------------</span> <span class="o">~</span>
  <span class="n">Convergence</span> <span class="n">Criteria</span>    <span class="mf">1.00e-06</span> <span class="o">*</span>    <span class="mf">3.00e-04</span> <span class="o">*</span>    <span class="mf">1.00e-06</span> <span class="o">*</span>    <span class="mf">1.20e-03</span> <span class="o">*</span>             <span class="n">o</span>  <span class="o">~</span>
<span class="o">---------------------------------------------------------------------------------------------</span> <span class="o">~</span>
    <span class="mi">1</span>     <span class="o">-</span><span class="mf">76.33224285</span>   <span class="o">-</span><span class="mf">7.63e+01</span>      <span class="mf">2.41e-03</span>      <span class="mf">1.60e-03</span>      <span class="mf">1.51e-02</span>      <span class="mf">8.82e-03</span> <span class="n">o</span>  <span class="o">~</span>
    <span class="mi">2</span>     <span class="o">-</span><span class="mf">76.33226097</span>   <span class="o">-</span><span class="mf">1.81e-05</span>      <span class="mf">4.84e-04</span>      <span class="mf">4.03e-04</span>      <span class="mf">7.71e-04</span> <span class="o">*</span>    <span class="mf">7.04e-04</span> <span class="n">o</span>  <span class="o">~</span>
    <span class="mi">3</span>     <span class="o">-</span><span class="mf">76.33226140</span>   <span class="o">-</span><span class="mf">4.39e-07</span> <span class="o">*</span>    <span class="mf">4.31e-05</span> <span class="o">*</span>    <span class="mf">3.58e-05</span>      <span class="mf">9.89e-05</span> <span class="o">*</span>    <span class="mf">8.93e-05</span> <span class="n">o</span>  <span class="o">~</span>
    <span class="mi">4</span>     <span class="o">-</span><span class="mf">76.33226141</span>   <span class="o">-</span><span class="mf">4.26e-09</span> <span class="o">*</span>    <span class="mf">9.76e-07</span> <span class="o">*</span>    <span class="mf">6.58e-07</span> <span class="o">*</span>    <span class="mf">6.22e-06</span> <span class="o">*</span>    <span class="mf">3.71e-06</span> <span class="n">o</span>  <span class="o">~</span>
<span class="o">---------------------------------------------------------------------------------------------------------------</span> <span class="o">~</span>
 <span class="n">Step</span>         <span class="n">Total</span> <span class="n">Energy</span>             <span class="n">Delta</span> <span class="n">E</span>       <span class="n">MAX</span> <span class="n">Force</span>       <span class="n">RMS</span> <span class="n">Force</span>        <span class="n">MAX</span> <span class="n">Disp</span>        <span class="n">RMS</span> <span class="n">Disp</span>  <span class="o">~</span>
<span class="o">---------------------------------------------------------------------------------------------------------------</span> <span class="o">~</span>
    <span class="mi">1</span>     <span class="o">-</span><span class="mf">76.332242848098</span>    <span class="o">-</span><span class="mf">76.332242848098</span>      <span class="mf">0.00241281</span>      <span class="mf">0.00160359</span>      <span class="mf">0.01507630</span>      <span class="mf">0.00881949</span>  <span class="o">~</span>
    <span class="mi">2</span>     <span class="o">-</span><span class="mf">76.332260965382</span>     <span class="o">-</span><span class="mf">0.000018117284</span>      <span class="mf">0.00048446</span>      <span class="mf">0.00040256</span>      <span class="mf">0.00077146</span>      <span class="mf">0.00070447</span>  <span class="o">~</span>
    <span class="mi">3</span>     <span class="o">-</span><span class="mf">76.332261404452</span>     <span class="o">-</span><span class="mf">0.000000439070</span>      <span class="mf">0.00004307</span>      <span class="mf">0.00003577</span>      <span class="mf">0.00009889</span>      <span class="mf">0.00008926</span>  <span class="o">~</span>
    <span class="mi">4</span>     <span class="o">-</span><span class="mf">76.332261408714</span>     <span class="o">-</span><span class="mf">0.000000004262</span>      <span class="mf">0.00000098</span>      <span class="mf">0.00000066</span>      <span class="mf">0.00000622</span>      <span class="mf">0.00000371</span>  <span class="o">~</span>
<span class="o">---------------------------------------------------------------------------------------------------------------</span> <span class="o">~</span>
</pre></div>
</div>
<p>The above example also shows the total memory for the computation being
set in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format. See <a class="reference internal" href="psithoninput.html#sec-memory"><span class="std std-ref">Memory Specification</span></a> for details. When
specified, the memory value is passed on to Cfour by setting keywords
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_MEMORY_SIZE-CFOUR"><span class="xref std std-term">CFOUR_MEMORY_SIZE</span></a> and <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_MEM_UNIT-CFOUR"><span class="xref std std-term">CFOUR_MEM_UNIT</span></a>=MB.</p>
<p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> has an extensive <a class="reference internal" href="basissets_byelement.html#apdx-basiselement"><span class="std std-ref">basis set library</span></a> in
Gaussian94 format. See <a class="reference internal" href="basissets.html#sec-basissets"><span class="std std-ref">Basis Sets</span></a> for details.  Contrasts to
Cfour basis handling include identifying basis sets by standard name
(aug-cc-pVDZ instead of AUG-PVDZ), direct handles for
diffuse-function-pruned sets (<em>e.g.</em>, jun-cc-pVDZ), case insensitivity,
appropriate setting of spherical/Cartesian depending on basis set design,
and syntax to set different basis sets to different classes of atoms
without listing each atom. All of these features are available to Cfour by
using the <a class="reference internal" href="autodoc_glossary_options_c.html#term-BASIS-MINTS"><span class="xref std std-term">BASIS</span></a> keyword instead of <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_BASIS-CFOUR"><span class="xref std std-term">CFOUR_BASIS</span></a>
(accompanied, of course, by specifying the molecule <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>-style).
Internally, <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> processes the basis set as usual, then translates
the basis set format and writes out a <code class="docutils literal notranslate"><span class="pre">GENBAS</span></code> file with an entry for
each atom. The P4C4 interface sets keyword <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_BASIS-CFOUR"><span class="xref std std-term">CFOUR_BASIS</span></a>=SPECIAL
and <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_SPHERICAL-CFOUR"><span class="xref std std-term">CFOUR_SPHERICAL</span></a> as appropriate, then writes the basis section
necessary for SPECIAL below the <code class="docutils literal notranslate"><span class="pre">*CFOUR(...)</span></code> block. (I’m sorry that the
name of the basis doesn’t appear in <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code>, but the combination of the
~14 character basis name limit and the absence of a comment line marker
rather precludes that helpful label.)</p>
<p>The input below employs a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> library basis set and also introduces
the final stage of conversion toward <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format. Instead of the
generic <code class="docutils literal notranslate"><span class="pre">'cfour'</span></code>, the computational method is specified as the first
argument to the <a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> call. In the computational
command below, the string argument <code class="docutils literal notranslate"><span class="pre">'c4-ccsd(t)'</span></code> directs that a CCSD(T)
computation be run using Cfour (as opposed to <code class="docutils literal notranslate"><span class="pre">'ccsd(t)'</span></code> which would
call <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> CC code). Specifying computational method in this manner
sets <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CALC_LEVEL-CFOUR"><span class="xref std std-term">CFOUR_CALC_LEVEL</span></a> from the argument and
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_DERIV_LEVEL-CFOUR"><span class="xref std std-term">CFOUR_DERIV_LEVEL</span></a> as appropriate from the function call:
<a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a>, <a class="reference internal" href="api/psi4.driver.gradient.html#psi4.driver.gradient" title="psi4.driver.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a>, or
<a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>. If those keywords are also set explicitly to
contradictory values, the interface will complain.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span> <span class="mi">2</span> <span class="n">gb</span>

<span class="n">molecule</span> <span class="n">CH2F2</span>  <span class="p">{</span>
  <span class="n">units</span> <span class="n">au</span>
  <span class="n">C</span>     <span class="mf">0.0000000000</span>  <span class="o">-</span><span class="mf">0.0000000000</span>   <span class="mf">1.0890958457</span>
  <span class="n">F</span>     <span class="mf">0.0000000000</span>  <span class="o">-</span><span class="mf">2.1223155812</span>  <span class="o">-</span><span class="mf">0.4598161475</span>
  <span class="n">F</span>    <span class="o">-</span><span class="mf">0.0000000000</span>   <span class="mf">2.1223155812</span>  <span class="o">-</span><span class="mf">0.4598161475</span>
  <span class="n">H</span>     <span class="mf">1.7084139850</span>   <span class="mf">0.0000000000</span>   <span class="mf">2.1841068002</span>
  <span class="n">H</span>    <span class="o">-</span><span class="mf">1.7084139850</span>  <span class="o">-</span><span class="mf">0.0000000000</span>   <span class="mf">2.1841068002</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="n">basis</span> <span class="n">aug</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span>
<span class="nb">set</span> <span class="n">rms_force_g_convergence</span> <span class="mi">6</span>
<span class="nb">set</span> <span class="n">cfour_abcdtype</span> <span class="n">aobasis</span>
<span class="nb">set</span> <span class="n">cfour_scf_conv</span> <span class="mi">12</span>
<span class="nb">set</span> <span class="n">cfour_cc_conv</span> <span class="mi">12</span>
<span class="nb">set</span> <span class="n">cfour_lineq_conv</span> <span class="mi">12</span>

<span class="n">optimize</span><span class="p">(</span><span class="s1">&#39;c4-ccsd(t)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The utility of this method specification is that examination can be made
of the reference, the derivative level, the excitation level, <em>etc.</em> and
some options can be set according to best practices. Practically speaking,
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CC_PROGRAM-CFOUR"><span class="xref std std-term">CFOUR_CC_PROGRAM</span></a> (and eventually <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_ABCDTYPE-CFOUR"><span class="xref std std-term">CFOUR_ABCDTYPE</span></a>) will
always be set to the <a class="reference internal" href="#table-cfour-cc-program"><span class="std std-ref">fastest safe value</span></a>.
For example, the input above will run with <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CC_PROGRAM-CFOUR"><span class="xref std std-term">CFOUR_CC_PROGRAM</span></a>=ECC
unless explicitly set to VCC.</p>
<p>An advantage of <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s Python driver is that any number of common
work-up procedures can be automated and wrapped around the
conventional single-point and optimization procedures at the heart of all
quantum chemistry codes. Three core “wrappers” available in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> are
<a class="reference internal" href="nbody.html#psi4.driver.driver_nbody.nbody" title="psi4.driver.driver_nbody.nbody"><code class="xref py py-func docutils literal notranslate"><span class="pre">nbody()</span></code></a>,
<a class="reference internal" href="db.html#psi4.driver.wrapper_database.database" title="psi4.driver.wrapper_database.database"><code class="xref py py-func docutils literal notranslate"><span class="pre">database()</span></code></a>, and
<a class="reference internal" href="api/psi4.driver.cbs.html#psi4.driver.cbs" title="psi4.driver.cbs"><code class="xref py py-func docutils literal notranslate"><span class="pre">cbs()</span></code></a>; read their respective sections
for details, but an overview is provided here. <a class="reference internal" href="nbody.html#psi4.driver.driver_nbody.nbody" title="psi4.driver.driver_nbody.nbody"><code class="xref py py-func docutils literal notranslate"><span class="pre">nbody()</span></code></a>
computes the interaction energy of a bimolecular complex (counterpoise-corrected,
not, or both).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="n">dimer</span> <span class="p">{</span>
  <span class="n">Ne</span>
<span class="o">--</span>
  <span class="n">Ne</span> <span class="mi">1</span> <span class="n">R</span>
  <span class="n">symmetry</span> <span class="n">c1</span>
<span class="p">}</span>

<span class="n">Rvals</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
<span class="nb">set</span> <span class="n">basis</span> <span class="n">aug</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pVDZ</span>

<span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="n">Rvals</span><span class="p">:</span>
  <span class="n">dimer</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>
  <span class="n">ecp</span> <span class="o">=</span> <span class="n">cp</span><span class="p">(</span><span class="s1">&#39;c4-mp2&#39;</span><span class="p">)</span>
  <span class="n">print_stdout</span><span class="p">(</span><span class="s1">&#39;R [A] = </span><span class="si">%.1f</span><span class="s1">  IE [kcal/mol] = </span><span class="si">%.3f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">psi_hartree2kcalmol</span> <span class="o">*</span> <span class="n">ecp</span><span class="p">))</span>
</pre></div>
</div>
<p>yields</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="p">[</span><span class="n">A</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.5</span>  <span class="n">IE</span> <span class="p">[</span><span class="n">kcal</span><span class="o">/</span><span class="n">mol</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.804</span>
<span class="n">R</span> <span class="p">[</span><span class="n">A</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span>  <span class="n">IE</span> <span class="p">[</span><span class="n">kcal</span><span class="o">/</span><span class="n">mol</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.030</span>
<span class="n">R</span> <span class="p">[</span><span class="n">A</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>  <span class="n">IE</span> <span class="p">[</span><span class="n">kcal</span><span class="o">/</span><span class="n">mol</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.014</span>
</pre></div>
</div>
<p>Next, the <a class="reference internal" href="db.html#psi4.driver.wrapper_database.database" title="psi4.driver.wrapper_database.database"><code class="xref py py-func docutils literal notranslate"><span class="pre">database()</span></code></a> wrapper allows any computational
model chemistry to be applied a predefined collection of molecules. Thus
an input</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="p">{</span>
    <span class="n">basis</span> <span class="n">jun</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span>
    <span class="n">d_convergence</span> <span class="mi">9</span>
<span class="p">}</span>

<span class="n">database</span><span class="p">(</span><span class="s1">&#39;c4-mp2&#39;</span><span class="p">,</span><span class="s1">&#39;nbc10&#39;</span><span class="p">,</span><span class="n">cp</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;MeMe&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>yields the counterpoise-corrected interaction energy for several points
along the dissociation curve of methane dimer, which is a member of the
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/share/psi4/databases/NBC10.py">NBC10</a> database:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;//</span>
<span class="o">//</span>       <span class="n">Database</span> <span class="n">nbc10</span> <span class="n">Results</span>      <span class="o">//</span>
<span class="o">//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;//</span>

<span class="n">For</span> <span class="n">each</span> <span class="n">VARIABLE</span> <span class="n">requested</span> <span class="n">by</span> <span class="n">tabulate</span><span class="p">,</span> <span class="n">a</span> <span class="s1">&#39;Reaction Value&#39;</span> <span class="n">will</span> <span class="n">be</span> <span class="n">formed</span> <span class="kn">from</span>
<span class="s1">&#39;Reagent&#39;</span> <span class="n">values</span> <span class="n">according</span> <span class="n">to</span> <span class="n">weightings</span> <span class="s1">&#39;Wt&#39;</span><span class="p">,</span> <span class="k">as</span> <span class="k">for</span> <span class="n">the</span> <span class="n">REQUESTED</span> <span class="n">ENERGY</span> <span class="n">below</span><span class="o">.</span>
<span class="n">Depending</span> <span class="n">on</span> <span class="n">the</span> <span class="n">nature</span> <span class="n">of</span> <span class="n">the</span> <span class="n">variable</span><span class="p">,</span> <span class="n">this</span> <span class="n">may</span> <span class="ow">or</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">make</span> <span class="nb">any</span> <span class="n">physical</span> <span class="n">sense</span><span class="o">.</span>

<span class="o">==&gt;</span> <span class="n">Requested</span> <span class="n">Energy</span> <span class="o">&lt;==</span>

<span class="o">----------------------------------------------------------------------------------------------</span>
            <span class="n">Reaction</span>     <span class="n">Reaction</span> <span class="n">Energy</span>      <span class="n">Error</span>           <span class="n">Reagent</span> <span class="mi">1</span>           <span class="n">Reagent</span> <span class="mi">2</span>
                            <span class="n">Ref</span>     <span class="n">Calc</span> <span class="p">[</span><span class="n">kcal</span><span class="o">/</span><span class="n">mol</span><span class="p">]</span>              <span class="p">[</span><span class="n">H</span><span class="p">]</span> <span class="n">Wt</span>              <span class="p">[</span><span class="n">H</span><span class="p">]</span> <span class="n">Wt</span>
<span class="o">----------------------------------------------------------------------------------------------</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.2</span>     <span class="mf">0.0690</span>   <span class="mf">1.1639</span>     <span class="mf">1.0949</span>     <span class="o">-</span><span class="mf">80.72700202</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36442840</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.3</span>    <span class="o">-</span><span class="mf">0.2390</span>   <span class="mf">0.6709</span>     <span class="mf">0.9099</span>     <span class="o">-</span><span class="mf">80.72764911</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36435916</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.4</span>    <span class="o">-</span><span class="mf">0.4170</span>   <span class="mf">0.3407</span>     <span class="mf">0.7577</span>     <span class="o">-</span><span class="mf">80.72806043</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36430165</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.5</span>    <span class="o">-</span><span class="mf">0.5080</span>   <span class="mf">0.1244</span>     <span class="mf">0.6324</span>     <span class="o">-</span><span class="mf">80.72831099</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36425461</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.6</span>    <span class="o">-</span><span class="mf">0.5410</span>  <span class="o">-</span><span class="mf">0.0129</span>     <span class="mf">0.5281</span>     <span class="o">-</span><span class="mf">80.72845373</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36421659</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.7</span>    <span class="o">-</span><span class="mf">0.5390</span>  <span class="o">-</span><span class="mf">0.0961</span>     <span class="mf">0.4429</span>     <span class="o">-</span><span class="mf">80.72852567</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36418623</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.8</span>    <span class="o">-</span><span class="mf">0.5150</span>  <span class="o">-</span><span class="mf">0.1430</span>     <span class="mf">0.3720</span>     <span class="o">-</span><span class="mf">80.72855247</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36416227</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">3.9</span>    <span class="o">-</span><span class="mf">0.4800</span>  <span class="o">-</span><span class="mf">0.1659</span>     <span class="mf">0.3141</span>     <span class="o">-</span><span class="mf">80.72855167</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36414365</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.0</span>    <span class="o">-</span><span class="mf">0.4390</span>  <span class="o">-</span><span class="mf">0.1733</span>     <span class="mf">0.2657</span>     <span class="o">-</span><span class="mf">80.72853498</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36412938</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.1</span>    <span class="o">-</span><span class="mf">0.3960</span>  <span class="o">-</span><span class="mf">0.1712</span>     <span class="mf">0.2248</span>     <span class="o">-</span><span class="mf">80.72850993</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36411859</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.2</span>    <span class="o">-</span><span class="mf">0.3540</span>  <span class="o">-</span><span class="mf">0.1633</span>     <span class="mf">0.1907</span>     <span class="o">-</span><span class="mf">80.72848118</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36411044</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.3</span>    <span class="o">-</span><span class="mf">0.3150</span>  <span class="o">-</span><span class="mf">0.1525</span>     <span class="mf">0.1625</span>     <span class="o">-</span><span class="mf">80.72845143</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36410422</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.4</span>    <span class="o">-</span><span class="mf">0.2790</span>  <span class="o">-</span><span class="mf">0.1403</span>     <span class="mf">0.1387</span>     <span class="o">-</span><span class="mf">80.72842215</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36409932</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.6</span>    <span class="o">-</span><span class="mf">0.2170</span>  <span class="o">-</span><span class="mf">0.1155</span>     <span class="mf">0.1015</span>     <span class="o">-</span><span class="mf">80.72836761</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36409177</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">4.8</span>    <span class="o">-</span><span class="mf">0.1680</span>  <span class="o">-</span><span class="mf">0.0933</span>     <span class="mf">0.0747</span>     <span class="o">-</span><span class="mf">80.72831991</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36408563</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">5.0</span>    <span class="o">-</span><span class="mf">0.1300</span>  <span class="o">-</span><span class="mf">0.0747</span>     <span class="mf">0.0553</span>     <span class="o">-</span><span class="mf">80.72827951</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36408021</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">5.4</span>    <span class="o">-</span><span class="mf">0.0800</span>  <span class="o">-</span><span class="mf">0.0479</span>     <span class="mf">0.0321</span>     <span class="o">-</span><span class="mf">80.72821875</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36407122</span> <span class="o">-</span><span class="mi">2</span>
       <span class="n">NBC1</span><span class="o">-</span><span class="n">MeMe</span><span class="o">-</span><span class="mf">5.8</span>    <span class="o">-</span><span class="mf">0.0500</span>  <span class="o">-</span><span class="mf">0.0312</span>     <span class="mf">0.0188</span>     <span class="o">-</span><span class="mf">80.72817678</span>  <span class="mi">1</span>     <span class="o">-</span><span class="mf">40.36406353</span> <span class="o">-</span><span class="mi">2</span>
<span class="o">----------------------------------------------------------------------------------------------</span>
         <span class="n">Minimal</span> <span class="n">Dev</span>                         <span class="mf">0.0188</span>
         <span class="n">Maximal</span> <span class="n">Dev</span>                         <span class="mf">1.0949</span>
     <span class="n">Mean</span> <span class="n">Signed</span> <span class="n">Dev</span>                         <span class="mf">0.3509</span>
   <span class="n">Mean</span> <span class="n">Absolute</span> <span class="n">Dev</span>                         <span class="mf">0.3509</span>
             <span class="n">RMS</span> <span class="n">Dev</span>                         <span class="mf">0.4676</span>
<span class="o">----------------------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>Thirdly, the <a class="reference internal" href="api/psi4.driver.cbs.html#psi4.driver.cbs" title="psi4.driver.cbs"><code class="xref py py-func docutils literal notranslate"><span class="pre">cbs()</span></code></a> wrapper allows any
compound computational method that can be expressed through <a class="reference internal" href="cbs_eqn.html#eq-cbs"><span class="std std-ref">CBS</span></a> to be applied to a molecule while employing the minimum number
of calculations. For example, the job below computes a
triple-quadruple-zeta Helgaker extrapolation of the mp2 correlation energy
atop a quadruple zeta reference to which is appended a double-triple-zeta
Helgaker extrapolated ccsd(t) - mp2 delta correction. Since the mp2 has
been requested through <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and the ccsd(t) through Cfour, the
wrapper runs only MP2/cc-pVQZ (P4), CCSD(T)/cc-pVDZ (C4), and
CCSD(T)/cc-pVTZ (C4) single-points.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="p">{</span>
<span class="n">H</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="n">H</span> <span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="n">mp2_type</span> <span class="n">conv</span>

<span class="n">cbs</span><span class="p">(</span><span class="s1">&#39;mp2&#39;</span><span class="p">,</span> <span class="n">corl_basis</span><span class="o">=</span><span class="s1">&#39;cc-pV[TQ]Z&#39;</span><span class="p">,</span> <span class="n">delta_wfn</span><span class="o">=</span><span class="s1">&#39;c4-ccsd(t)&#39;</span><span class="p">,</span> <span class="n">delta_basis</span><span class="o">=</span><span class="s1">&#39;cc-pV[DT]Z&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This yields:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">==&gt;</span> <span class="n">CBS</span> <span class="o">&lt;==</span>

<span class="o">---------------------------------------------------------------------------------------------------------</span>
    <span class="n">Stage</span>               <span class="n">Method</span> <span class="o">/</span> <span class="n">Basis</span>                                <span class="n">Energy</span> <span class="p">[</span><span class="n">H</span><span class="p">]</span>   <span class="n">Scheme</span>
<span class="o">---------------------------------------------------------------------------------------------------------</span>
      <span class="n">scf</span>                  <span class="n">scf</span> <span class="o">/</span> <span class="n">cc</span><span class="o">-</span><span class="n">pvqz</span>                             <span class="o">-</span><span class="mf">1.10245974</span>   <span class="n">highest_1</span>
     <span class="n">corl</span>                  <span class="n">mp2</span> <span class="o">/</span> <span class="n">cc</span><span class="o">-</span><span class="n">pv</span><span class="p">[</span><span class="n">tq</span><span class="p">]</span><span class="n">z</span>                          <span class="o">-</span><span class="mf">0.03561890</span>   <span class="n">corl_xtpl_helgaker_2</span>
    <span class="n">delta</span>     <span class="n">c4</span><span class="o">-</span><span class="n">ccsd</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">mp2</span> <span class="o">/</span> <span class="n">cc</span><span class="o">-</span><span class="n">pv</span><span class="p">[</span><span class="n">dt</span><span class="p">]</span><span class="n">z</span>                           <span class="mf">0.03507767</span>   <span class="n">corl_xtpl_helgaker_2</span>
    <span class="n">total</span>                  <span class="n">CBS</span>                                       <span class="o">-</span><span class="mf">1.10300098</span>
<span class="o">---------------------------------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>Note that especially for <a class="reference internal" href="api/psi4.driver.cbs.html#psi4.driver.cbs" title="psi4.driver.cbs"><code class="xref py py-func docutils literal notranslate"><span class="pre">cbs()</span></code></a>, the
basis set needs to be specified through <a class="reference internal" href="autodoc_glossary_options_c.html#term-BASIS-MINTS"><span class="xref std std-term">BASIS</span></a>, not
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_BASIS-CFOUR"><span class="xref std std-term">CFOUR_BASIS</span></a>.  Many of the wrappers can be used in combination to,
for example, apply a compound method to every molecule in a database or to
optimize a molecule with an extrapolated basis set (findif only for the
moment- analytics coming).</p>
<p>Finally, any number and combination of jobs can be run from a single
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> input file.  Depending on the nature of preceding or following
jobs, it is prudent to separate them with the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clean</span><span class="p">()</span>            <span class="c1"># removes Psi4 scratch files</span>
<span class="n">clean_variables</span><span class="p">()</span>  <span class="c1"># empties the PSI variables list</span>
<span class="n">cfour</span> <span class="p">{}</span>           <span class="c1"># empties the cfour block</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because p4c4 does not inspect the contents of the <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{...}</span></code>
block, once the user specifies a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>-style molecule, the
interface cannot judge whether a sandwich mode (drop the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> molecule
and use the cfour block as the entirety of the <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code>) or a standard mode
(translate the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> molecule and append additional input from the
cfour block) is intended. The latter is what actually occurs. If
there is both a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> molecule and a molecule in the cfour block,
<code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> <em>will</em> end up with multiple molecules and multiple <code class="docutils literal notranslate"><span class="pre">*CFOUR(...)</span></code>
blocks, and it <em>will not</em> run.  Therefore, if mixing sandwich and
standard or pure-<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> computations in an input file, place all
the sandwich jobs at the beginning before declaring <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>
molecules. If necessary, clear the cfour block with <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{}</span></code> before
commencing standard P4C4 jobs.</p>
</div>
</section>
<section id="output">
<span id="sec-cfouroutput"></span><h2>Output<a class="headerlink" href="#output" title="Link to this heading">¶</a></h2>
<p>The output of <strong class="program">xcfour</strong> invoked from a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> input file is
written to the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> output file as the computation progresses.  If a
Cfour module terminates with a non-zero error code, the value will show up
in <a class="reference internal" href="glossary_psivariables.html#psivar-CFOUR-ERROR-CODE"><code class="xref std std-psivar docutils literal notranslate"><span class="pre">CFOUR</span> <span class="pre">ERROR</span> <span class="pre">CODE</span></code></a>.</p>
<p class="rubric">Energies &amp; Scalars</p>
<p>After execution of <strong class="program">xcfour</strong> has completed, the output string is
extensively parsed and appropriate results are stored in <a class="reference internal" href="autodir_psivariables/module__cfour.html#apdx-cfour-psivar"><span class="std std-ref">PSI
Variables</span></a>. All gleaned variables are printed in the
Cfour output section of the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> output file, as shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;//</span>
<span class="o">//</span>  <span class="n">Cfour</span> <span class="n">c4</span><span class="o">-</span><span class="n">ccsd</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="n">Energy</span> <span class="n">Results</span>  <span class="o">//</span>
<span class="o">//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;//</span>


<span class="n">Variable</span> <span class="n">Map</span><span class="p">:</span>
<span class="o">----------------------------------------------------------------------------</span>
<span class="s2">&quot;(T) CORRECTION ENERGY&quot;</span>      <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.007263598030</span>
<span class="s2">&quot;CCSD CORRELATION ENERGY&quot;</span>    <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.275705492359</span>
<span class="s2">&quot;CCSD TOTAL ENERGY&quot;</span>          <span class="o">=&gt;</span>     <span class="o">-</span><span class="mf">76.338453952539</span>
<span class="s2">&quot;CCSD(T) CORRELATION ENERGY&quot;</span> <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.007263598030</span>
<span class="s2">&quot;CCSD(T) TOTAL ENERGY&quot;</span>       <span class="o">=&gt;</span>     <span class="o">-</span><span class="mf">76.345717550569</span>
<span class="s2">&quot;CFOUR ERROR CODE&quot;</span>           <span class="o">=&gt;</span>       <span class="mf">0.000000000000</span>
<span class="s2">&quot;CURRENT CORRELATION ENERGY&quot;</span> <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.007263598030</span>
<span class="s2">&quot;CURRENT ENERGY&quot;</span>             <span class="o">=&gt;</span>     <span class="o">-</span><span class="mf">76.345717550569</span>
<span class="s2">&quot;CURRENT REFERENCE ENERGY&quot;</span>   <span class="o">=&gt;</span>     <span class="o">-</span><span class="mf">76.062748460180</span>
<span class="s2">&quot;MP2 CORRELATION ENERGY&quot;</span>     <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.270191667755</span>
<span class="s2">&quot;MP2 OPPOSITE-SPIN ENERGY&quot;</span>   <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.204890356651</span>
<span class="s2">&quot;MP2 SAME-SPIN ENERGY&quot;</span>       <span class="o">=&gt;</span>      <span class="o">-</span><span class="mf">0.065301311104</span>
<span class="s2">&quot;MP2 TOTAL ENERGY&quot;</span>           <span class="o">=&gt;</span>     <span class="o">-</span><span class="mf">76.332940127935</span>
<span class="s2">&quot;NUCLEAR REPULSION ENERGY&quot;</span>   <span class="o">=&gt;</span>       <span class="mf">9.187331653300</span>
<span class="s2">&quot;SCF TOTAL ENERGY&quot;</span>           <span class="o">=&gt;</span>     <span class="o">-</span><span class="mf">76.062748460180</span>
</pre></div>
</div>
<p>The PSI Variables are also available from the input file for manipulation.
For instance, to compute the MBPT 2 3/4 energy from MBPT 3 results, the
following could be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-mp3&#39;</span><span class="p">)</span>
<span class="n">mp2p75_corl</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;mp3 correlation energy&#39;</span><span class="p">)</span> <span class="o">+</span> \
              <span class="mf">0.25</span> <span class="o">*</span> <span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;MP2 correlation energy&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">mp2p75_corl</span> <span class="o">+</span> <span class="n">get_variable</span><span class="p">(</span><span class="s1">&#39;scf total energy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Some features are not yet implemented. Buy a developer a coffee.</p>
<ul class="simple">
<li><p>No PSI Variables for properties: <em>e.g.</em>, <a class="reference internal" href="glossary_psivariables.html#psivar-SCF-DIPOLE"><code class="xref std std-psivar docutils literal notranslate"><span class="pre">SCF</span> <span class="pre">DIPOLE</span></code></a></p></li>
<li><p>No PSI Variables for excited state energies</p></li>
</ul>
<p>The formation of further regexes for properties, excited states, etc.
is one of the primary areas in which this interface requires further
work.</p>
</div>
<p class="rubric">Gradients and Arrays</p>
<p>In addition to parsing the output stream, results are collected from files
written to the scratch directory. Presently, the <code class="docutils literal notranslate"><span class="pre">GRD</span></code> file is parsed
and printed to the output file, as shown below. Also printed is the Cfour
gradient after manipulation by the P4C4 interface and used by <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>
going forward. Manipulation is necessary because Cfour determinedly uses
its own internal orientation and atom ordering while <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> naturally
expects the gradient to be aligned with the active molecule. The geometry
in <code class="docutils literal notranslate"><span class="pre">GRD</span></code> and the geometry of <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s active molecule are shifted,
rotated, flipped, and otherwise badgered into coincidence, then the same
manipulations are applied to the gradient in <code class="docutils literal notranslate"><span class="pre">GRD</span></code>, the result of which
is printed below and passed on to Optking.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;//</span>
<span class="o">//</span>   <span class="n">Cfour</span> <span class="n">c4</span><span class="o">-</span><span class="n">scf</span> <span class="n">Gradient</span> <span class="n">Results</span>   <span class="o">//</span>
<span class="o">//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;//</span>

<span class="o">...</span>

<span class="n">Irrep</span><span class="p">:</span> <span class="mi">1</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">4</span> <span class="n">x</span> <span class="mi">3</span>

               <span class="mi">1</span>            <span class="mi">2</span>            <span class="mi">3</span>

  <span class="mi">1</span>    <span class="mf">0.0000000</span>   <span class="o">-</span><span class="mf">0.0122978</span>    <span class="mf">0.0000000</span>
  <span class="mi">2</span>   <span class="o">-</span><span class="mf">0.0051192</span>    <span class="mf">0.0040993</span>   <span class="o">-</span><span class="mf">0.0088667</span>
  <span class="mi">3</span>   <span class="o">-</span><span class="mf">0.0051192</span>    <span class="mf">0.0040993</span>    <span class="mf">0.0088667</span>
  <span class="mi">4</span>    <span class="mf">0.0102384</span>    <span class="mf">0.0040993</span>    <span class="mf">0.0000000</span>


<span class="n">CFOUR</span> <span class="n">scratch</span> <span class="n">file</span> <span class="n">GRD</span> <span class="n">has</span> <span class="n">been</span> <span class="n">read</span>
  <span class="mi">4</span>        <span class="mf">0.0000000000</span>
      <span class="mf">7.0000000000</span>       <span class="o">-</span><span class="mf">0.0880964705</span>        <span class="mf">0.0000000000</span>        <span class="mf">0.0000000000</span>
      <span class="mf">1.0000000000</span>        <span class="mf">0.4080144050</span>       <span class="o">-</span><span class="mf">0.9178691296</span>       <span class="o">-</span><span class="mf">1.5897959670</span>
      <span class="mf">1.0000000000</span>        <span class="mf">0.4080144050</span>       <span class="o">-</span><span class="mf">0.9178691296</span>        <span class="mf">1.5897959670</span>
      <span class="mf">1.0000000000</span>        <span class="mf">0.4080144050</span>        <span class="mf">1.8357382590</span>        <span class="mf">0.0000000001</span>
      <span class="mf">7.0000000000</span>       <span class="o">-</span><span class="mf">0.0122978407</span>        <span class="mf">0.0000000000</span>        <span class="mf">0.0000000000</span>
      <span class="mf">1.0000000000</span>        <span class="mf">0.0040992802</span>       <span class="o">-</span><span class="mf">0.0051191833</span>       <span class="o">-</span><span class="mf">0.0088666856</span>
      <span class="mf">1.0000000000</span>        <span class="mf">0.0040992802</span>       <span class="o">-</span><span class="mf">0.0051191833</span>        <span class="mf">0.0088666856</span>
      <span class="mf">1.0000000000</span>        <span class="mf">0.0040992802</span>        <span class="mf">0.0102383666</span>        <span class="mf">0.0000000000</span>
</pre></div>
</div>
<p>The gradient can also be accessed from the input file as a
<a class="reference internal" href="api/psi4.core.Matrix.html#psi4.core.Matrix" title="psi4.core.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> object through the wfn as
<a class="reference internal" href="api/psi4.core.Wavefunction.html#psi4.core.Wavefunction.gradient" title="psi4.core.Wavefunction.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">psi4.core.Wavefunction.gradient()</span></code></a>. Previously, cfour communicated through
<cite>psi4.core.legacy_gradient</cite> which was accessed through <cite>psi4.core.get_gradient()</cite></p>
<p class="rubric">Cfour Files</p>
<p>The contents of all files associated with Cfour are accessible from the
input file through the Python dictionary <code class="docutils literal notranslate"><span class="pre">P4C4_INFO</span></code>. That is,
<code class="docutils literal notranslate"><span class="pre">P4C4_INFO['zmat']</span></code> returns a string of the input file sent to Cfour.
Accessible arguments are <code class="docutils literal notranslate"><span class="pre">zmat</span></code>, <code class="docutils literal notranslate"><span class="pre">output</span></code>, and any that have been
produced of <code class="docutils literal notranslate"><span class="pre">grd</span></code>. For example, to print to the screen if CC convergence
is reached, the following could be placed in the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> input file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-ccsd&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;miracle?&#39;</span><span class="p">,</span> <span class="s1">&#39;miracle&#39;</span> <span class="ow">in</span> <span class="n">P4C4_INFO</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p class="rubric">Scratch Files</p>
<p>By default, a separate subdirectory for each Cfour call is created within
the job’s scratch directory. To explicitly specify the location of the
Cfour scratch, execute with, for example, <code class="docutils literal notranslate"><span class="pre">energy('cfour',</span>
<span class="pre">path='/full/path/to/cfour/scratch')</span></code>. Regardless of whether the location
is specified or default, whether to preserve the scratch directory after
the computation can be specified with <code class="docutils literal notranslate"><span class="pre">energy('cfour',</span> <span class="pre">keep=True)</span></code> or
(the default) <code class="docutils literal notranslate"><span class="pre">energy('cfour',</span> <span class="pre">keep=False)</span></code>. <em>path</em> and <em>keep</em> are
keyword arguments that get interpreted by the
<a class="reference internal" href="#psi4.driver.procrouting.interface_cfour.run_cfour" title="psi4.driver.procrouting.interface_cfour.run_cfour"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cfour()</span></code></a> function documented below.</p>
<dl class="py function">
<dt class="sig sig-object py" id="psi4.driver.procrouting.interface_cfour.run_cfour">
<span class="sig-prename descclassname"><span class="pre">psi4.driver.procrouting.interface_cfour.</span></span><span class="sig-name descname"><span class="pre">run_cfour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/psi4/driver/procrouting/interface_cfour.html#run_cfour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#psi4.driver.procrouting.interface_cfour.run_cfour" title="Link to this definition">¶</a></dt>
<dd><p>Function that prepares environment and input files
for a calculation calling Stanton and Gauss’s CFOUR code.
Also processes results back into Psi4 format.</p>
<p>This function is not called directly but is instead called by
<a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a> or <a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> when a Cfour
method is requested (through <em>name</em> argument). In order to function
correctly, the Cfour executable <code class="docutils literal notranslate"><span class="pre">xcfour</span></code> must be present in
<span class="target" id="index-7"></span><a class="reference internal" href="external.html#envvar-PATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a> or <span class="target" id="index-8"></span><a class="reference internal" href="external.html#envvar-PSIPATH"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PSIPATH</span></code></a>.</p>
<table class="hlist"><tr><td><ul class="simple">
<li><p>Many <a class="reference internal" href="autodir_psivariables/module__cfour.html#apdx-cfour-psivar"><span class="std std-ref">PSI Variables</span></a> extracted from the Cfour output</p></li>
<li><p>Python dictionary of associated file constants accessible as <code class="docutils literal notranslate"><span class="pre">P4C4_INFO['zmat']</span></code>, <code class="docutils literal notranslate"><span class="pre">P4C4_INFO['output']</span></code>, <code class="docutils literal notranslate"><span class="pre">P4C4_INFO['grd']</span></code>, <em>etc.</em></p></li>
</ul>
</td></tr></table>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – <p><code class="docutils literal notranslate"><span class="pre">'c4-scf'</span></code> || <code class="docutils literal notranslate"><span class="pre">'c4-ccsd(t)'</span></code> || <code class="docutils literal notranslate"><span class="pre">'cfour'</span></code> || etc.</p>
<p>First argument, usually unlabeled. Indicates the computational
method to be applied to the system.</p>
</p></li>
<li><p><strong>keep</strong> (<a class="reference internal" href="notes_py.html#op-py-boolean"><span class="std std-ref">boolean</span></a>) – <p><code class="docutils literal notranslate"><span class="pre">'on'</span></code> || <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">'off'</span></code> <span class="math notranslate nohighlight">\(\Leftarrow\)</span></p>
<p>Indicates whether to delete the Cfour scratch directory upon
completion of the Cfour job.</p>
</p></li>
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – <p>Indicates path to Cfour scratch directory (with respect to Psi4
scratch directory). Otherwise, the default is a subdirectory
within the Psi4 scratch directory.</p>
<p>If specified, GENBAS and/or ZMAT within will be used.</p>
</p></li>
<li><p><strong>genbas</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Indicates that contents should be used for GENBAS file.</p></li>
</ul>
</dd>
</dl>
<p>GENBAS is a complicated topic. It is quite unnecessary if the
molecule is from a molecule {…} block and basis is set through
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s BASIS keyword. In that case, a GENBAS is written from
LibMints and all is well. Otherwise, a GENBAS is looked for in
the usual places: PSIPATH, PATH, PSIDATADIR/basis. If path kwarg is
specified, also looks there preferentially for a GENBAS. Can
also specify GENBAS within an input file through a string and
setting the genbas kwarg. Note that due to the input parser’s
aggression, blank lines need to be replaced by the text blankline.</p>
</dd></dl>

</section>
<section id="functionality">
<span id="sec-cfourfunctionality"></span><h2>Functionality<a class="headerlink" href="#functionality" title="Link to this heading">¶</a></h2>
<p>Through clever use of the <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{...}</span></code> block, one could run most any
Cfour computation through the P4C4 interface.  In contrast, enumerated
below are tested functionalities where results from Cfour are collected
into <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> data objects.</p>
<p class="rubric">Implemented</p>
<ul class="simple">
<li><p>Single-point <a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a> commands for <a class="reference internal" href="energy.html#table-energy-cfour"><span class="std std-ref">ground state
methods</span></a>. Examples:
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/sp-rhf-ccsd_t_-ao-ecc/input.dat">cfour/sp-rhf-ccsd_t_-ao-ecc</a>, <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/scf4/input.dat">cfour/scf4</a>,
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/mints5/input.dat">cfour/mints5</a>.</p></li>
<li><p>Analytic <a class="reference internal" href="api/psi4.driver.gradient.html#psi4.driver.gradient" title="psi4.driver.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a> and <a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>
commands for <a class="reference internal" href="opt.html#table-grad-cfour"><span class="std std-ref">ground state methods</span></a>. Real and
Ghost atoms permitted (though the latter will naturally collapse after
several cycles). Examples: <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/opt-rhf-ccsd_t_/input.dat">cfour/opt-rhf-ccsd_t_</a>,
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/mp2-1/input.dat">cfour/mp2-1</a>, and <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/mints5-grad/input.dat">cfour/mints5-grad</a>.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There exist molecules (<em>e.g.</em>, allene) where the
inertial frame is not unique (planes along atoms or between
atoms). The orientation reconciling machinery currently does not
handle these cases and will fail with “Axis unreconcilable between
QC programs”. I will get to this soon.</p>
</div>
<ul class="simple">
<li><p>Finite difference of energy <a class="reference internal" href="api/psi4.driver.gradient.html#psi4.driver.gradient" title="psi4.driver.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a> and
<a class="reference internal" href="api/psi4.driver.optimize.html#psi4.driver.optimize" title="psi4.driver.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> for <a class="reference internal" href="energy.html#table-energy-cfour"><span class="std std-ref">methods</span></a>.
Force with <code class="docutils literal notranslate"><span class="pre">gradient('name',</span> <span class="pre">dertype=0)</span></code>, <em>etc.</em>.</p></li>
<li><p><a class="reference internal" href="nbody.html#psi4.driver.driver_nbody.nbody" title="psi4.driver.driver_nbody.nbody"><code class="xref py py-func docutils literal notranslate"><span class="pre">nbody()</span></code></a> for computation of interaction energies with or
without counterpoise correction. Example: <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/dfmp2-1/input.dat">cfour/dfmp2-1</a>.</p></li>
<li><p><a class="reference internal" href="db.html#psi4.driver.wrapper_database.database" title="psi4.driver.wrapper_database.database"><code class="xref py py-func docutils literal notranslate"><span class="pre">database()</span></code></a> for computation of a collection of molecules in a
single input, with summarization of results. Examples:
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/pywrap-db1/input.dat">cfour/pywrap-db1</a> and <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/psi-a24-grad/input.dat">cfour/psi-a24-grad</a>.</p></li>
<li><p><a class="reference internal" href="api/psi4.driver.cbs.html#psi4.driver.cbs" title="psi4.driver.cbs"><code class="xref py py-func docutils literal notranslate"><span class="pre">cbs()</span></code></a> for computation of compound methods involving
basis set extrapolations and/or delta corrections with any combination
of <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and Cfour computational methods and <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> basis sets.
Example: <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/cfour/pywrap-cbs1/input.dat">cfour/pywrap-cbs1</a>.</p></li>
</ul>
<p class="rubric">Not Yet Implemented</p>
<ul class="simple">
<li><p>Ground state CI energies and optimizations</p></li>
<li><p>Excited state energies and optimizations</p></li>
<li><p>Properties are not yet regex-ed, transformed into input frame, and
stowed in PSI Variables.</p></li>
<li><p>Property calls that required extra computation not yet translated into
<a class="reference internal" href="api/psi4.driver.properties.html#psi4.driver.properties" title="psi4.driver.properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">properties()</span></code></a> computation command</p></li>
<li><p>Frequencies</p></li>
</ul>
<p>Energy methods available through P4C4 interface</p>
<blockquote id="table-energy-cfour">
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>calls method in Stanton and Gauss’s CFOUR program <a class="reference internal" href="#sec-cfour"><span class="std std-ref">[manual]</span></a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>c4-scf</p></td>
<td><p>Hartree–Fock (HF)</p></td>
</tr>
<tr class="row-odd"><td><p>c4-mp2</p></td>
<td><p>2nd-order Møller–Plesset perturbation theory (non-density-fitting) (MP2)</p></td>
</tr>
<tr class="row-even"><td><p>c4-mp3</p></td>
<td><p>3rd-order Møller–Plesset perturbation theory (MP3)</p></td>
</tr>
<tr class="row-odd"><td><p>c4-mp4(sdq)</p></td>
<td><p>4th-order MP perturbation theory (MP4) less triples</p></td>
</tr>
<tr class="row-even"><td><p>c4-mp4</p></td>
<td><p>full MP4</p></td>
</tr>
<tr class="row-odd"><td><p>c4-cc2</p></td>
<td><p>approximate coupled cluster singles and doubles (CC2)</p></td>
</tr>
<tr class="row-even"><td><p>c4-ccsd</p></td>
<td><p>coupled cluster singles and doubles (CCSD)</p></td>
</tr>
<tr class="row-odd"><td><p>c4-cc3</p></td>
<td><p>approximate CC singles, doubles, and triples (CC3)</p></td>
</tr>
<tr class="row-even"><td><p>c4-ccsd(t)</p></td>
<td><p>CCSD with perturbative triples (CCSD(T))</p></td>
</tr>
<tr class="row-odd"><td><p>c4-ccsdt</p></td>
<td><p>coupled cluster singles, doubles, and triples (CCSDT)</p></td>
</tr>
<tr class="row-even"><td><p>cfour</p></td>
<td><p><strong>expert</strong> full control over cfour program</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Gradient methods available through P4C4 interface</p>
<blockquote id="table-grad-cfour">
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>calls method in Stanton and Gauss’s CFOUR program <a class="reference internal" href="#sec-cfour"><span class="std std-ref">[manual]</span></a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>c4-scf</p></td>
<td><p>Hartree–Fock (HF)</p></td>
</tr>
<tr class="row-odd"><td><p>c4-mp2</p></td>
<td><p>2nd-order Møller–Plesset perturbation theory (non-density-fitting) (MP2)</p></td>
</tr>
<tr class="row-even"><td><p>c4-mp3</p></td>
<td><p>3rd-order Møller–Plesset perturbation theory (MP3)</p></td>
</tr>
<tr class="row-odd"><td><p>c4-mp4(sdq)</p></td>
<td><p>4th-order MP perturbation theory (MP4) less triples</p></td>
</tr>
<tr class="row-even"><td><p>c4-mp4</p></td>
<td><p>full MP4</p></td>
</tr>
<tr class="row-odd"><td><p>c4-cc2</p></td>
<td><p>approximate coupled cluster singles and doubles (CC2)</p></td>
</tr>
<tr class="row-even"><td><p>c4-ccsd</p></td>
<td><p>coupled cluster singles and doubles (CCSD)</p></td>
</tr>
<tr class="row-odd"><td><p>c4-cc3</p></td>
<td><p>approximate CC singles, doubles, and triples (CC3)</p></td>
</tr>
<tr class="row-even"><td><p>c4-ccsd(t)</p></td>
<td><p>CCSD with perturbative triples (CCSD(T))</p></td>
</tr>
<tr class="row-odd"><td><p>c4-ccsdt</p></td>
<td><p>coupled cluster singles, doubles, and triples (CCSDT)</p></td>
</tr>
<tr class="row-even"><td><p>cfour</p></td>
<td><p><strong>expert</strong> full control over cfour program</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<span class="target" id="table-cfour-cc-program"></span></section>
<section id="specification-details">
<h2>Specification Details<a class="headerlink" href="#specification-details" title="Link to this heading">¶</a></h2>
<p>The above narrative introduction to the P4C4 interface should be
sufficient to get started. Issues of competition between <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and
Cfour specification format are generally resolved behind the scenes:
not according to a <em>simple</em> rule but according to sensible, sometimes
intricate, rules governed by user intent (and integration of Cfour to
behave like a <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> module). Much can be gleaned by just running
inputs and inspecting the <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> passed to Cfour, but when questions
arise, here are the specifics, the governing laws.</p>
<ul>
<li><p>Specifying a piece of input in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format is entering into
a contract that you mean it. In particular this applies to
molecule (including charge/multiplicity through <code class="samp docutils literal notranslate"><span class="pre">molecule</span>
<em><span class="pre">optional_molecule_name</span></em> <span class="pre">{...}</span></code>), memory (through <code class="samp docutils literal notranslate"><span class="pre">memory</span>
<em><span class="pre">value</span></em> <em><span class="pre">unit</span></em></code>), computational method (through . If Cfour keywords
are specified with values that contradict the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> input,
execution is halted.</p>
<p>As an example, the input below is set up to fail in four ways:
contradictory specification of memory, multiplicity, computational
method, and derivative level. Note, though, that the <code class="docutils literal notranslate"><span class="pre">cfour_units</span>
<span class="pre">angstrom</span></code> setting is permissible, since it concurs with the value
implied in the molecule block.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span> <span class="mi">300</span> <span class="n">mb</span>

<span class="n">molecule</span> <span class="p">{</span>
<span class="n">H</span>
<span class="n">H</span> <span class="mi">1</span> <span class="mf">0.7</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="n">basis</span> <span class="mi">6</span><span class="o">-</span><span class="mi">31</span><span class="n">g</span>
<span class="nb">set</span> <span class="n">cfour_multiplicity</span> <span class="mi">3</span>         <span class="c1"># clash with implicit singlet in molecule {} above</span>
<span class="nb">set</span> <span class="n">cfour_units</span> <span class="n">angstrom</span>         <span class="c1"># no problem, consistent with molecule {} above</span>
<span class="nb">set</span> <span class="n">cfour_memory_size</span> <span class="mi">100000000</span>  <span class="c1"># clash with 300 mb above</span>
<span class="nb">set</span> <span class="n">cfour_calc_level</span> <span class="n">ccsd</span>        <span class="c1"># clash with &#39;c4-scf&#39; below</span>
<span class="nb">set</span> <span class="n">cfour_deriv_level</span> <span class="n">first</span>      <span class="c1"># clash with energy() below (use gradient(&#39;c4-scf&#39;) to achieve this)</span>

<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-scf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Specifying anything in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format (molecule, basis, options,
method call) starts building a <code class="docutils literal notranslate"><span class="pre">*CFOUR(...)</span></code> directive for the
<code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> file. Since the contents of the <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{...}</span></code> block are
blindly appended to any input interpreted from <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> format, mixing
of <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and Cfour input formats likely <em>will</em> give rise to multiple
<code class="docutils literal notranslate"><span class="pre">*CFOUR(...)</span></code> directives in the prospective <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code>, execution of
which <em>will</em> be trapped and halted.  Proper uses for the <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{...}</span></code>
block are for the sandwich mode, where the entire <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> is enclosed,
or for extra directives like <code class="docutils literal notranslate"><span class="pre">%excite*</span></code>, which presently have no other
specification route.</p></li>
<li><p>Specifying the basis is perhaps the regulated piece of input. Since
basis set names differ between <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and Cfour and it’s not
practical to compare exponent-to-exponent, any input file with both
<a class="reference internal" href="autodoc_glossary_options_c.html#term-BASIS-MINTS"><span class="xref std std-term">BASIS</span></a> and <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_BASIS-CFOUR"><span class="xref std std-term">CFOUR_BASIS</span></a> keywords present will halt. Once
a basis set has been requested through <a class="reference internal" href="autodoc_glossary_options_c.html#term-BASIS-MINTS"><span class="xref std std-term">BASIS</span></a>, overriding the
default spherical/Cartesian setting must be done through
<a class="reference internal" href="autodoc_glossary_options_c.html#term-PUREAM-GLOBALS"><span class="xref std std-term">PUREAM</span></a> (as opposed to <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_SPHERICAL-CFOUR"><span class="xref std std-term">CFOUR_SPHERICAL</span></a>).</p></li>
<li><p>Specifying keywords that control geometry optimization is
straightforward. Unless the optimization is invoked in sandwich mode,
all Cfour optimization keywords (<em>e.g.</em>, <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_GEO_MAXCYC-CFOUR"><span class="xref std std-term">CFOUR_GEO_MAXCYC</span></a>) are
ineffective, as the Cfour optimizer is never invoked. <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>
optimization keywords (<em>e.g.</em>, <a class="reference internal" href="autodoc_glossary_options_c.html#term-GEOM_MAXITER-OPTKING"><span class="xref std std-term">GEOM_MAXITER</span></a>) instead fill
these roles.</p></li>
<li><p>Specifying the computational method (through, for instance,
<code class="docutils literal notranslate"><span class="pre">energy('c4-ccsd')</span></code> instead of <code class="docutils literal notranslate"><span class="pre">energy('cfour')</span></code>) often
sets additional keywords consistent with best practices (<em>e.g.</em>,
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_CC_PROGRAM-CFOUR"><span class="xref std std-term">CFOUR_CC_PROGRAM</span></a>). Since those settings are implicit, any
explicit setting of those those keywords, whether contradicting or
concurring, takes priority (halts never generated). The following are
some concrete examples. For the moment, click the source button at
muster_modelchem for details of what keywords
get set.</p>
<ul>
<li><p>runs in vcc since that’s Cfour’s default for cc_program</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">cfour_calc_level</span> <span class="n">ccsd</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;cfour&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>runs in ecc since Cfour’s default overwritten by keyword</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">cfour_calc_level</span> <span class="n">ccsd</span>
<span class="nb">set</span> <span class="n">cfour_cc_program</span> <span class="n">ecc</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;cfour&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>runs in ecc since that’s best practice for the requested ccsd</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-ccsd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>runs in vcc since <em>hidden</em> default overwritten by keyword</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">cfour_cc_program</span> <span class="n">vcc</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-ccsd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Specifying certain keywords that are nominally applicable for pure-<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> modules directs them to fulfil analogous roles
in the Cfour program (<em>e.g.</em>, <a class="reference internal" href="autodoc_glossary_options_c.html#term-MAXITER-SCF"><span class="xref std std-term">MAXITER</span></a> is used to set
<a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_SCF_MAXCYC-CFOUR"><span class="xref std std-term">CFOUR_SCF_MAXCYC</span></a>). This keyword translation only takes place
if the keywords are explicitly set in the input file (part of that
contract that you mean it), meaning that <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s defaults don’t
get imposed on Cfour. Also, in the case where a translatable pure-<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> keyword and its translation Cfour keyword are both set,
the value attached to the latter is always used. Below are a few
clarifying examples.</p>
<ul>
<li><p>uses <span class="math notranslate nohighlight">\(10^{-7}\)</span> SCF conv crit since that’s Cfour’s default
for <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_SCF_CONV-CFOUR"><span class="xref std std-term">CFOUR_SCF_CONV</span></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-scf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>uses <span class="math notranslate nohighlight">\(10^{-6}\)</span> SCF conv crit since default overwritten by
keyword</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">cfour_scf_conv</span> <span class="mi">6</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-scf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>uses <span class="math notranslate nohighlight">\(10^{-5}\)</span> SCF conv crit since default overwritten by
<a class="reference internal" href="autodir_options_c/module__scf.html#apdx-scf"><span class="std std-ref">SCF module</span></a> keyword</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">d_convergence</span> <span class="mi">5</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-scf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>uses <span class="math notranslate nohighlight">\(10^{-6}\)</span> SCF conv crit since default overwritten by
<a class="reference internal" href="autodir_options_c/module__scf.html#apdx-scf"><span class="std std-ref">SCF module</span></a> keyword (local scope works, too) where
the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s more flexible float input has been rounded down to
the integer required by Cfour</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">scf</span> <span class="n">d_convergence</span> <span class="mf">5e-6</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-scf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>uses <span class="math notranslate nohighlight">\(10^{-6}\)</span> SCF conv crit since default overwritten
and Cfour module keyword trumps <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> SCF module keyword</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">cfour_scf_conv</span> <span class="mi">6</span>
<span class="nb">set</span> <span class="n">d_convergence</span> <span class="mi">8</span>
<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;c4-scf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>The keyword translation feature is still in the proof-of-principle
stage, so only a handful (found here) of keywords participate.</p>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Longtime Cfour users who may consider this keyword
translation a flaw rather than a feature can avoid it entirely by
confining keywords to the <a class="reference internal" href="autodir_options_c/module__cfour.html#apdx-cfour"><span class="std std-ref">Cfour module</span></a> along with
<a class="reference internal" href="autodoc_glossary_options_c.html#term-BASIS-MINTS"><span class="xref std std-term">BASIS</span></a> and <a class="reference internal" href="autodoc_glossary_options_c.html#term-PUREAM-GLOBALS"><span class="xref std std-term">PUREAM</span></a> (opt, too?)</p>
</div>
</section>
<section id="misc-running">
<h2>Misc. Running<a class="headerlink" href="#misc-running" title="Link to this heading">¶</a></h2>
<p>Naturally, in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> multiple jobs can be run in succession from the input file.</p>
<p>Control optimizations with optking keywords HERE. Cfour <code class="docutils literal notranslate"><span class="pre">GRD</span></code> file is
written to <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> output file. Gradient transformed back into the frame
in which it was shipped off to Cfour is also written to the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>
output file and is available from input as <a class="reference internal" href="api/psi4.core.Wavefunction.html#psi4.core.Wavefunction.gradient" title="psi4.core.Wavefunction.gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">gradient()</span></code></a>.</p>
<p>sandwich mode := molecule and cfour list within
Naturally, additional jobs can follow in the input file.
Depending on the nature of preceding or following jobs, it is prudent to
separate them with the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">clean</span><span class="p">()</span>            <span class="c1"># removes Psi4 scratch files</span>
<span class="n">clean_variables</span><span class="p">()</span>  <span class="c1"># empties the PSI variables list</span>
<span class="n">cfour</span> <span class="p">{}</span>           <span class="c1"># empties</span>
</pre></div>
</div>
<p>In this scheme, the contents of the <code class="docutils literal notranslate"><span class="pre">cfour</span> <span class="pre">{...}</span></code> block are tacked onto
the end of the <code class="docutils literal notranslate"><span class="pre">ZMAT</span></code> file that is otherwise written from psi style
format. It is by this route that, for example <code class="docutils literal notranslate"><span class="pre">%excite*</span></code> sections can at
present be specified.</p>
<p>The execution of <strong class="program">xcfour</strong> can be modified by a few parameters.  Setting
the option <a class="reference internal" href="autodoc_glossary_options_c.html#term-CFOUR_OMP_NUM_THREADS-CFOUR"><span class="xref std std-term">CFOUR_OMP_NUM_THREADS</span></a> sets the environment variable
<span class="target" id="index-9"></span><a class="reference internal" href="external.html#envvar-OMP_NUM_THREADS"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMP_NUM_THREADS</span></code></a> for only the duration of the Cfour computation.
That is, portions of an input file that run <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> modules are
unaffected.  Additionally, there are a few arguments to the function
<a class="reference internal" href="#psi4.driver.procrouting.interface_cfour.run_cfour" title="psi4.driver.procrouting.interface_cfour.run_cfour"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cfour()</span></code></a> that control the Cfour scratch
directory.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="index.html">
    <img class="logo" src="_static/psi4square.png" alt="Logo"/>
  </a></p>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel"
                                       aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/></div>
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Interface to CFOUR by J. Stanton &amp; J. Gauss</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#cfour-for-psifour-users">Cfour for <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Users</a></li>
<li><a class="reference internal" href="#psifour-for-cfour-users"><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> for Cfour Users</a></li>
<li><a class="reference internal" href="#output">Output</a><ul>
<li><a class="reference internal" href="#psi4.driver.procrouting.interface_cfour.run_cfour"><code class="docutils literal notranslate"><span class="pre">run_cfour()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#functionality">Functionality</a></li>
<li><a class="reference internal" href="#specification-details">Specification Details</a></li>
<li><a class="reference internal" href="#misc-running">Misc. Running</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="chemps2.html" title="Interface to CheMPS2 by S. Wouters"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="brianqc.html" title="Interface to the BrianQC GPU module by the BrianQC team"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/cfour.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/9addd49">1.9a1.dev55</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="interfacing.html" >Interfaces: Enhancing <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> Capabilities</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">Interface to CFOUR by J. Stanton &amp; J. Gauss</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2023, The Psi4 Project.
      Last updated on Tuesday, 03 October 2023 04:09PM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>