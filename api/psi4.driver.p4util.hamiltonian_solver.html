
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>hamiltonian_solver</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css?v=c7cf8c76" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script src="../_static/documentation_options.js?v=0a908d79"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/psi4.driver.p4util.hamiltonian_solver';</script>
    <link rel="icon" href="../_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hold_options_state" href="psi4.driver.p4util.hold_options_state.html" />
    <link rel="prev" title="getattr_ignorecase" href="psi4.driver.p4util.getattr_ignorecase.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Tuesday, 26 September 2023 02:05AM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/psi4square.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/psi4square.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
        </div>
      
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">hamiltonian_solver</a><ul>
<li><a class="reference internal" href="#psi4.driver.p4util.hamiltonian_solver"><code class="docutils literal notranslate"><span class="pre">hamiltonian_solver()</span></code></a></li>
</ul>
</li>
</ul>

  </div></div>
        <div class="sidebar-primary-item">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="psi4.driver.p4util.getattr_ignorecase.html"
                          title="previous chapter">getattr_ignorecase</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="psi4.driver.p4util.hold_options_state.html"
                          title="next chapter">hold_options_state</a></p>
  </div></div>
        <div class="sidebar-primary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/api/psi4.driver.p4util.hamiltonian_solver.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>
        <div class="sidebar-primary-item">
<div id="searchbox"></div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../psi4api.html" class="nav-link"><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> API: Linking C++ and Python</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">hamiltonian_solver</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="hamiltonian-solver">
<h1>hamiltonian_solver<a class="headerlink" href="#hamiltonian-solver" title="Link to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="psi4.driver.p4util.hamiltonian_solver">
<span class="sig-prename descclassname"><span class="pre">psi4.driver.p4util.</span></span><span class="sig-name descname"><span class="pre">hamiltonian_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nroot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_convergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ss_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/psi4/driver/p4util/solvers.html#hamiltonian_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#psi4.driver.p4util.hamiltonian_solver" title="Link to this definition">#</a></dt>
<dd><p>Finds the smallest eigenvalues and associated right and left hand
eigenvectors of a large real Hamiltonian eigenvalue problem emulated
through an engine.</p>
<p>A Hamiltonian eigenvalue problem (EVP) has the following structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">A</span>  <span class="n">B</span><span class="p">][</span><span class="n">X</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">1</span>   <span class="mi">0</span><span class="p">](</span><span class="n">w</span><span class="p">)[</span><span class="n">X</span><span class="p">]</span>
<span class="p">[</span><span class="n">B</span>  <span class="n">A</span><span class="p">][</span><span class="n">Y</span><span class="p">]</span>    <span class="p">[</span><span class="mi">0</span>  <span class="o">-</span><span class="mi">1</span><span class="p">](</span><span class="n">w</span><span class="p">)[</span><span class="n">Y</span><span class="p">]</span>
</pre></div>
</div>
<p>with A, B of some large dimension N, the problem is of dimension 2Nx2N.</p>
<p>The real, Hamiltonian EVP can be rewritten as the NxN, non-hermitian EVP:
<span class="math notranslate nohighlight">\((A+B)(A-B)(X+Y) = w^2(X+Y)\)</span></p>
<p>With left-hand eigenvectors:
<span class="math notranslate nohighlight">\((X-Y)(A-B)(A+B) = w^2(X-Y)\)</span></p>
<p>if <span class="math notranslate nohighlight">\((A-B)\)</span> is positive definite, we can transform the problem to arrive at the hermitian NxN EVP:
<span class="math notranslate nohighlight">\((A-B)^{1/2}(A+B)(A-B)^{1/2} = w^2 T\)</span></p>
<p>Where <span class="math notranslate nohighlight">\(T = (A-B)^{-1/2}(X+Y)\)</span>.</p>
<p>We use a Davidson like iteration where we transform <span class="math notranslate nohighlight">\((A+B)\)</span> (H1) and <span class="math notranslate nohighlight">\((A-B)\)</span>
(H2) in to the subspace defined by the trial vectors.
The subspace analog of the NxN hermitian EVP is diagonalized and left <span class="math notranslate nohighlight">\((X-Y)\)</span>
and right <span class="math notranslate nohighlight">\((X+Y)\)</span> eigenvectors of the NxN non-hermitian EVP are approximated.
Residual vectors are formed for both and the guess space is augmented with
two correction vectors per iteration. The advantages and properties of this
algorithm are described in the literature <a class="reference internal" href="../bibliography.html#stratmann-1998" id="id1"><span>[stratmann:1998]</span></a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.Type" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference internal" href="psi4.driver.p4util.SolverEngine.html#psi4.driver.p4util.SolverEngine" title="psi4.driver.p4util.solvers.SolverEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolverEngine</span></code></a>]) – The engine drive all operations involving data structures that have at
least one “large” dimension. See <a class="reference internal" href="psi4.driver.p4util.SolverEngine.html#psi4.driver.p4util.SolverEngine" title="psi4.driver.p4util.SolverEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolverEngine</span></code></a> for requirements</p></li>
<li><p><strong>guess</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.List" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>) – list {engine dependent}
At least <cite>nroot</cite> initial expansion vectors</p></li>
<li><p><strong>nroot</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of roots desired</p></li>
<li><p><strong>r_convergence</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Convergence tolerance for residual vectors</p></li>
<li><p><strong>max_ss_size</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The maximum number of trial vectors in the iterative subspace that will
be stored before a collapse is done.</p></li>
<li><p><strong>maxiter</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The maximum number of iterations</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – The amount of logging info to print (0 -&gt; none, 1 -&gt; some, 2 -&gt; all but matrices, &gt;2 -&gt; everything)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>best_values</strong> (<em>numpy.ndarray</em>) – (nroots, ) The best approximation of the eigenvalues of <cite>w</cite>, computed on the last iteration of the solver</p></li>
<li><p><strong>best_R</strong> (List[<cite>vector</cite>]) – (nroots) The best approximation of the  right hand eigenvectors, <span class="math notranslate nohighlight">\(X+Y\)</span>, computed on the last iteration of the solver.</p></li>
<li><p><strong>best_L</strong> (List[<cite>vector</cite>]) – (nroots) The best approximation of the left hand eigenvectors, <span class="math notranslate nohighlight">\(X-Y\)</span>, computed on the last iteration of the solver.</p></li>
<li><p><strong>stats</strong> (<em>List[Dict]</em>) – Statistics collected on each iteration</p>
<ul>
<li><p>count : int, iteration number</p></li>
<li><p>res_norm : np.ndarray (nroots, ), the norm of residual vector for each roots</p></li>
<li><p>val : np.ndarray (nroots, ), the eigenvalue corresponding to each root</p></li>
<li><p>delta_val : np.ndarray (nroots, ), the change in eigenvalue from the last iteration to this ones</p></li>
<li><p>collapse : bool, if a subspace collapse was performed</p></li>
<li><p>product_count : int, the running total of product evaluations that was performed</p></li>
<li><p>done : bool, if all roots were converged</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The solution vector is normalized to 1/2</p>
<p>The solver will return even when <cite>maxiter</cite> iterations are performed without convergence.
The caller <strong>must check</strong> <code class="docutils literal notranslate"><span class="pre">stats[-1]['done']</span></code> for failure and handle each case accordingly.</p>
<p class="rubric">References</p>
<p>R. Eric Stratmann, G. E. Scuseria, and M. J. Frisch, “An efficient
implementation of time-dependent density-functional theory for the
calculation of excitation energies of large molecules.” J. Chem. Phys.,
109, 8218 (1998)</p>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="psi4.driver.p4util.getattr_ignorecase.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">getattr_ignorecase</p>
      </div>
    </a>
    <a class="right-next"
       href="psi4.driver.p4util.hold_options_state.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">hold_options_state</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#psi4.driver.p4util.hamiltonian_solver"><code class="docutils literal notranslate"><span class="pre">hamiltonian_solver()</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../_sources/api/psi4.driver.p4util.hamiltonian_solver.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2007-2023, The Psi4 Project.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>