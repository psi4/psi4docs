
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Adding Add-Ons</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css?v=c7cf8c76" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script src="_static/documentation_options.js?v=0a908d79"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'manage_addon';</script>
    <link rel="icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Git, Versioning" href="manage_git.html" />
    <link rel="prev" title="Managing: Git, Conda, CMake and all that" href="manage_index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Tuesday, 26 September 2023 02:05AM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/psi4square.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/psi4square.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
        </div>
      
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Adding Add-Ons</a><ul>
<li><a class="reference internal" href="#how-to-use-an-add-on-s-name-in-directory-structure-build-and-distribution">How to use an Add-On’s name in directory structure, build, and distribution</a></li>
<li><a class="reference internal" href="#how-to-integrate-an-add-on-into-build-testing-and-docs">How to integrate an Add-On into build, testing, and docs</a></li>
<li><a class="reference internal" href="#else">else</a></li>
<li><a class="reference internal" href="#how-to-name-keywords-in-psi4-src-read-options-cc">How to name keywords in <code class="docutils literal notranslate"><span class="pre">psi4/src/read_options.cc</span></code></a></li>
</ul>
</li>
</ul>

  </div></div>
        <div class="sidebar-primary-item">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="manage_index.html"
                          title="previous chapter">Managing: Git, Conda, CMake and all that</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="manage_git.html"
                          title="next chapter">Git, Versioning</a></p>
  </div></div>
        <div class="sidebar-primary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/manage_addon.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>
        <div class="sidebar-primary-item">
<div id="searchbox"></div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="manage_index.html" class="nav-link">Managing: Git, Conda, CMake and all that</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Adding Add-Ons</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="adding-add-ons">
<span id="sec-addaddons"></span><h1>Adding Add-Ons<a class="headerlink" href="#adding-add-ons" title="Link to this heading">#</a></h1>
<section id="how-to-use-an-add-on-s-name-in-directory-structure-build-and-distribution">
<span id="faq-addonname"></span><h2>How to use an Add-On’s name in directory structure, build, and distribution<a class="headerlink" href="#how-to-use-an-add-on-s-name-in-directory-structure-build-and-distribution" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Select a name. May be mixed case with numerals and underscores
(<em>e.g.</em>, CheMPS2, libefp, PCMSolver, v2rdm_casscf). Shouldn’t start with a
numeral. Needn’t start with “lib”, even if a library.</p></li>
<li><p>GitHub repository name should be <code class="samp docutils literal notranslate"><em><span class="pre">AddOn_name</span></em></code> or
<code class="samp docutils literal notranslate"><em><span class="pre">AddOn_name</span></em><span class="pre">.lower()</span></code> (hereafter, <code class="samp docutils literal notranslate"><em><span class="pre">addon_name</span></em></code>. For example: CheMPS2, libefp, pcmsolver,
v2rdm_casscf.</p></li>
<li><p>CMake project name should be <code class="samp docutils literal notranslate"><em><span class="pre">AddOn_name</span></em></code>. For example:
<code class="docutils literal notranslate"><span class="pre">project(libefp)</span></code>, <code class="docutils literal notranslate"><span class="pre">project(CheMPS2)</span></code>, <code class="docutils literal notranslate"><span class="pre">project(PCMSolver)</span></code>,
<code class="docutils literal notranslate"><span class="pre">project(v2rdm_casscf)</span></code>. Namespacing in the directory structure used
to detect the addon should have this name (<em>e.g.</em>,
<code class="docutils literal notranslate"><span class="pre">share/cmake/CheMPS2</span></code>).</p></li>
<li><p>Restricted by the CMake project name, add-ons return CMake variables
and compile definitions of <code class="samp docutils literal notranslate"><span class="pre">FOUND_</span><em><span class="pre">AddOn_name</span></em></code> and
<code class="samp docutils literal notranslate"><span class="pre">USING_</span><em><span class="pre">AddOn_name</span></em></code>. For example: <code class="docutils literal notranslate"><span class="pre">FOUND_libefp</span></code>,
<code class="docutils literal notranslate"><span class="pre">USING_CheMPS2</span></code>, <code class="docutils literal notranslate"><span class="pre">PCMSolver_LIBRARIES</span></code>, <code class="docutils literal notranslate"><span class="pre">USING_v2rdm_casscf</span></code>.</p></li>
<li><p>The CMake target(s) formed use the full add-on name as the namespace,
<code class="samp docutils literal notranslate"><em><span class="pre">AddOn_name</span></em><span class="pre">::</span><em><span class="pre">lib_name_without_lib</span></em><span class="pre">.lower()</span></code>. For example:
<code class="docutils literal notranslate"><span class="pre">libefp::efp</span></code>, <code class="docutils literal notranslate"><span class="pre">CheMPS2::chemps2</span></code>, <code class="docutils literal notranslate"><span class="pre">PCMSolver::pcm</span></code>,
<code class="docutils literal notranslate"><span class="pre">v2rdm_casscf::v2rdm_casscf</span></code>.</p></li>
<li><p>Following the CMake project name (though not restricted to it –
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> managment could change the pattern), the user flag to enable
an add-on is <code class="samp docutils literal notranslate"><span class="pre">ENABLE_</span><em><span class="pre">AddOn_name</span></em></code>. Note that runtime-only
add-ons don’t go through this enabling process.</p></li>
<li><p>Internally, the ExternalProject_Add and dummy libraries as well as any
tests/ and external/ subdirectories should all be lowercase,
<code class="samp docutils literal notranslate"><em><span class="pre">addon_name</span></em></code>.</p></li>
<li><p>The <a class="reference external" href="https://anaconda.org/psi4/repo">conda package</a> and internal to
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> (that is, the ExternalProject_Add, dummy libraries, and any
tests/ and external/ subdirectories) should all be lowercase,
<code class="samp docutils literal notranslate"><em><span class="pre">addon_name</span></em></code>.</p></li>
<li><p>Alternatively, you can do everything mentioned here lowercase and just
have a different capitalization for an advertising name. After all,
that’s what <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> does.</p></li>
</ul>
</section>
<section id="how-to-integrate-an-add-on-into-build-testing-and-docs">
<span id="faq-addoncmake"></span><h2>How to integrate an Add-On into build, testing, and docs<a class="headerlink" href="#how-to-integrate-an-add-on-into-build-testing-and-docs" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>In all cases, put Add-Ons in alphabetic order, ignoring any “lib” in the name.</p></li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/CMakeLists.txt">psi4/CMakeLists.txt</a></p>
<ul>
<li><p>Add the <code class="samp docutils literal notranslate"><span class="pre">ENABLE_</span><em><span class="pre">AddOn_name</span></em></code> line</p></li>
<li><p>Add the <code class="samp docutils literal notranslate"><span class="pre">external_</span><em><span class="pre">addon_name</span></em></code> dependency to the <code class="docutils literal notranslate"><span class="pre">psi4-core</span></code> external project</p></li>
<li><p>Add the <code class="samp docutils literal notranslate"><em><span class="pre">AddOn_name</span></em><span class="pre">_DIR</span></code> variable passing to the <code class="docutils literal notranslate"><span class="pre">psi4-core</span></code> external project</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/CMakeLists.txt">psi4/psi4/CMakeLists.txt</a></p>
<ul>
<li><p>Add a block imitating Libint if Add-On required or CheMPS2 if not
required</p></li>
<li><p>If there are shared resources to the external that need
to be found by <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> in PSIDATADIR, follow the <code class="docutils literal notranslate"><span class="pre">efpfrag</span></code>
pattern of libefp to symlink them in.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/src/CMakeLists.txt">psi4/psi4/src/CMakeLists.txt</a></p>
<ul>
<li><p>No changes should be required unless both (1) code in export_*
or core.cc needs the <code class="samp docutils literal notranslate"><span class="pre">USING_</span><em><span class="pre">AddOn_name</span></em></code> definition or
AddOn header includes and (2) no binary <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> module (as
opposed to library <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> module with the AddOn target linked
is itself a direct dependency of target <code class="docutils literal notranslate"><span class="pre">core</span></code>. Basically,
try to leave this file alone, but if there are compile errors,
add the definitions/headers as needed.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/src/psi4/">psi4/psi4/src/psi4/</a></p>
<ul>
<li><p>If a module is needed to interface the AddOn to <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>, try to
put “interface” in the name. Follow the pattern of CheMPS2 or gdma.
If non-required, be sure to conditionalize it with <code class="docutils literal notranslate"><span class="pre">if(TARGET</span>
<span class="pre">AddOn::addon)</span></code> in CMake files or <code class="docutils literal notranslate"><span class="pre">#ifdef</span> <span class="pre">USING_AddOn</span></code> in
source files.</p></li>
<li><p>If a separate module is not required, follow the patter of dkh
or simint with respect to libmints. Again, conditionalize as in
preceding bullet.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/external/upstream/">psi4/external/upstream/</a></p>
<ul>
<li><p>Add a CMakeLists.txt that imitates another AddOn of similar
language and dependencies. Try to keep the format, messaging,
and variables passed as similar as possible so that differences
mean something. If BLAS/LAPACK or other common dependencies in
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/external/common">psi4/external/common</a> are needed, be sure to add them to the
<code class="docutils literal notranslate"><span class="pre">DEPENDS</span></code> argument.</p></li>
<li><p>The usual practice to to get everything cohesive between
the CMake for the AddOn repository and <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and then as a
last step, mint a tag in the former and add it to two places in
<code class="samp docutils literal notranslate"><span class="pre">external/upstream/</span><em><span class="pre">addon_name</span></em><span class="pre">/CMakeLists.txt</span></code> and one
place in <a class="reference external" href="https://github.com/psi4/psi4/blob/master/psi4/CMakeLists.txt">psi4/psi4/CMakeLists.txt</a> so that only that version
and later are acceptable to <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> for detecting pre-built.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/">psi4/tests/</a></p>
<ul>
<li><p>In <a class="reference external" href="https://github.com/psi4/psi4/blob/master/tests/CMakeLists.txt">psi4/tests/CMakeLists.txt</a>, add a block adding a tests subdirectory if Add-On enabled</p></li>
<li><p>Create new subdirectory <code class="samp docutils literal notranslate"><span class="pre">tests/</span><em><span class="pre">addon_name</span></em></code> with a
CMakeLists.txt. In that add a few tests. Imitate the pattern in
other subdirs of including the addon prefix to the test name in the
CMakeLists but not in the test dir name. Make sure the tests get the
addon CTest label and that at least one of them gets the smoke label.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/psi4/psi4/blob/master/doc/sphinxman/">psi4/doc/sphinxman/</a></p>
<ul>
<li><p>Create a new <cite>.rst</cite> page, copying one of the Add-Ons with similar
language and dependency requirements. Edit it
as appropriate. Add this page to the list in
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/doc/sphinxman/source/interfacing.rst">psi4/doc/sphinxman/source/interfacing.rst</a>.</p></li>
<li><p>Add a bullet to <a class="reference external" href="https://github.com/psi4/psi4/blob/master/doc/sphinxman/source/build_planning.rst">psi4/doc/sphinxman/source/build_planning.rst</a></p></li>
<li><p>Add the new page to the long list in
<a class="reference external" href="https://github.com/psi4/psi4/blob/master/doc/sphinxman/CMakeLists.txt">psi4/doc/sphinxman/CMakeLists.txt</a>. If there are any files or
images referred to, add them to the file, too, following precedent.</p></li>
</ul>
</li>
</ul>
</section>
<section id="else">
<h2>else<a class="headerlink" href="#else" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Build conda packages</p>
<ul>
<li><p>Recipes in <a class="github reference external" href="https://github.com/psi4/psi4meta/tree/master/conda-recipes">psi4/psi4meta</a></p></li>
</ul>
</li>
<li><p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and Add-On Projects Working Together</p>
<ul>
<li><p>Obligations of the External Project owners are to:</p>
<ol class="arabic simple">
<li><p>allow us to contribute some CMake files to your build system
so that compile flags and dependencies (e.g., BLAS/LAPACK) can be
consistent with the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> build and so the installed project can
be readily detected by <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> or any interested party (through a
CMake imported target).</p></li>
<li><p>provide us a tag at a tested commit/version number so their
development may be ongoing.</p></li>
<li><p>communicate with us when they’ve made improvements and minted
a new tag.</p></li>
</ol>
</li>
<li><p>In return, for Add-Ons the <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> project will:</p>
<ol class="arabic simple">
<li><p>leave control of their code under your purview.</p></li>
<li><p>maintain any interfacing code needed.</p></li>
<li><p>regularly run integration tests between <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and your code.</p></li>
<li><p>build a mostly statically linked conda package so that any
of your users can obtain a pre-built binary distribution through
<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">addon</span> <span class="pre">--channel</span> <span class="pre">psi4</span></code>.</p></li>
<li><p>provide a development sandbox for your code through <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> plugins.</p></li>
<li><p>provide conda download counts independent of <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>.</p></li>
</ol>
</li>
</ul>
</li>
</ul>
</section>
<section id="how-to-name-keywords-in-psi4-src-read-options-cc">
<span id="faq-readoptions"></span><h2>How to name keywords in <code class="docutils literal notranslate"><span class="pre">psi4/src/read_options.cc</span></code><a class="headerlink" href="#how-to-name-keywords-in-psi4-src-read-options-cc" title="Link to this heading">#</a></h2>
<p>A few guidelines for standardizing option names among modules.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TRIPLES</span></code> (not trip), <code class="docutils literal notranslate"><span class="pre">TRIPLETS</span></code> (not trip), <code class="docutils literal notranslate"><span class="pre">SINGLES</span></code> (not sing),
<code class="docutils literal notranslate"><span class="pre">SINGLETS</span></code> (not sing)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONVERGENCE</span></code> (not conv, not converge) and <code class="docutils literal notranslate"><span class="pre">TOLERANCE</span></code> (not tol)</p></li>
<li><p>Convergence of a method should be governed by an <code class="docutils literal notranslate"><span class="pre">E_CONVERGENCE</span></code> for
energy and either a <code class="docutils literal notranslate"><span class="pre">D_CONVERGENCE</span></code> for density or a <code class="docutils literal notranslate"><span class="pre">R_CONVERGENCE</span></code>
for residual/amplitudes. All of these should be doubles- let the input
parser handle the flexible input format.</p></li>
<li><p>Diis should have a boolean <code class="docutils literal notranslate"><span class="pre">DIIS</span></code> (not do_diis, not use_diis) to turn
on/off diis extrapolation, a <code class="docutils literal notranslate"><span class="pre">DIIS_MIN_VECS</span></code> and <code class="docutils literal notranslate"><span class="pre">DIIS_MAX_VECS</span></code> for
minimum and maximum number of diis vectors to use, and a <code class="docutils literal notranslate"><span class="pre">DIIS_START</span></code>
which is the iteration at which to start saving vectors for diis. Not all
modules conform to all these at present, but they’re as standardized as
they can be without changing code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AMPS</span></code> (not amplitude, not amp) for amplitudes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NUM_</span></code> (not n) for number (e.g., <code class="docutils literal notranslate"><span class="pre">NUM_AMPS_PRINT</span></code>, <code class="docutils literal notranslate"><span class="pre">MAX_NUM_VECS</span></code>,
<code class="docutils literal notranslate"><span class="pre">NUM_THREADS</span></code>)</p></li>
<li><p>Some names that could be split into multiple words are staying as one.
Use <code class="docutils literal notranslate"><span class="pre">MAXITER</span></code>, <code class="docutils literal notranslate"><span class="pre">CACHELEVEL</span></code>, <code class="docutils literal notranslate"><span class="pre">PUREAM</span></code>, <code class="docutils literal notranslate"><span class="pre">DERTYPE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INTS</span></code> (not integrals), also <code class="docutils literal notranslate"><span class="pre">OEI</span></code> (not oe_integrals) for
one-electron integrals and <code class="docutils literal notranslate"><span class="pre">TEI</span></code> (not te_integrals) for two-electron
integrals</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PERTURB</span></code> (not pert) for perturbation</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">PRINT</span></code> options to indicate printing to output file. Use <code class="docutils literal notranslate"><span class="pre">WRITE</span></code>
options to indicate printing to another file. This probably isn’t
entirely valid now but should be observed in future. The complement to
<code class="docutils literal notranslate"><span class="pre">WRITE</span></code> is <code class="docutils literal notranslate"><span class="pre">READ</span></code>. <code class="docutils literal notranslate"><span class="pre">PRINT</span></code>, <code class="docutils literal notranslate"><span class="pre">READ</span></code>, and <code class="docutils literal notranslate"><span class="pre">WRITE</span></code> will usually
be the last words in an option name.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">FOLLOW_ROOT</span></code> for the state to be followed in geometry optimizations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WFN</span></code> (not wavefunction)</p></li>
<li><p>You’re welcome to use <code class="docutils literal notranslate"><span class="pre">WFN</span></code> and <code class="docutils literal notranslate"><span class="pre">DERTYPE</span></code> as internal options, but
plan to have these set by the python driver and mark them as <code class="docutils literal notranslate"><span class="pre">!expert</span></code>
options. Really avoid using <code class="docutils literal notranslate"><span class="pre">JOBTYPE</span></code>.</p></li>
<li><p>You’re not welcome to add <code class="docutils literal notranslate"><span class="pre">CHARGE</span></code> or <code class="docutils literal notranslate"><span class="pre">MULTP</span></code> options. Plan to get
these quantities from the molecule object. Since we frequently use subsets
of systems (with their own charge and multiplicity), this is safer.</p></li>
<li><p>Conform. Just grep <code class="docutils literal notranslate"><span class="pre">'add'</span> <span class="pre">psi4/src/read_options.cc</span></code> to get a list of
all the option names in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> and try to match any conventions you
find.</p></li>
<li><p>If you have a quantity you’d like to call a cutoff, a threshold, a
tolerance, or a convergence, consider the following guidelines in naming
it.</p>
<ul>
<li><p>If its value is typically greater than ~0.001, give it a name with <code class="docutils literal notranslate"><span class="pre">CUTOFF</span></code>.</p></li>
<li><p>If its value is typically less than ~0.001 and quantities being tested
against the option are more valuable with larger values (e.g.,
integrals, occupations, eigenvectors), give it a name with <code class="docutils literal notranslate"><span class="pre">TOLERANCE</span></code>.</p></li>
<li><p>If its value is typically less than ~0.001 and quantities being tested
against the option are more valuable with smaller values (e.g., energy
changes, residual errors, gradients), give it a name with
<code class="docutils literal notranslate"><span class="pre">CONVERGENCE</span></code>.</p></li>
</ul>
</li>
<li><p>In deciding how to arrange words in an option name, place the context
first (e.g., <code class="docutils literal notranslate"><span class="pre">MP2_AMPS_PRINT</span></code>, <code class="docutils literal notranslate"><span class="pre">TRIPLES_DIIS</span></code>). This means <code class="docutils literal notranslate"><span class="pre">PRINT</span></code>
will generally be at the end of an option name.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">INTS_TOLERANCE</span></code> (not schwarz_cutoff)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">H</span></code> in an option name is reserved for Hamiltonian (or hydrogen).
Hessian should be <code class="docutils literal notranslate"><span class="pre">HESS</span></code>.</p></li>
<li><p>All option names should be all caps and separated by underscores.</p></li>
<li><p>If you have an option that instructs your module to do something not too
computationally intensive and then quit, append <code class="docutils literal notranslate"><span class="pre">_EXIT</span></code> to the option
name.</p></li>
<li><p>Scaling terms (like for scs) should follow the pattern <code class="docutils literal notranslate"><span class="pre">MP2_SS_SCALE</span></code>
and <code class="docutils literal notranslate"><span class="pre">SAPT_OS_SCALE</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FRAG</span></code> for fragment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AVG</span></code> for average.</p></li>
<li><p>For level-shifting, let’s try to have it governed by (double)
<code class="docutils literal notranslate"><span class="pre">LEVEL_SHIFT</span></code> only and not a boolean/double combo since the procedure
can be turned on (role of boolean) if the value (role of double) has
changed.</p></li>
<li><p>For Tikhonow regularization, use <code class="docutils literal notranslate"><span class="pre">TIKONOW_OMEGA</span></code>, not regularizer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SYM</span></code> for symmetry.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OCC</span></code> for occupied/occupation (e.g., <code class="docutils literal notranslate"><span class="pre">DOCC</span></code>, <code class="docutils literal notranslate"><span class="pre">LOCK_OCC</span></code>, <code class="docutils literal notranslate"><span class="pre">OCC_TOLERANCE</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COND</span></code> for condition and <code class="docutils literal notranslate"><span class="pre">CONDITIONER</span></code> for conditioner.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOCAL</span></code> (not localize).</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">AO</span></code> and <code class="docutils literal notranslate"><span class="pre">MO</span></code> for atomic and molecular orbitals. When ‘O’ for
orbitals is too obsure or would make for too short a keyword, as in
“bool NO” for “Do use natural orbitals”, use <code class="docutils literal notranslate"><span class="pre">ORBS</span></code> for orbitals. So
natural orbitals are <code class="docutils literal notranslate"><span class="pre">NAT_ORBS</span></code> and Brueckner orbitals are
<code class="docutils literal notranslate"><span class="pre">BRUECKNER_ORBS</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LEVEL</span></code> (not <code class="docutils literal notranslate"><span class="pre">LVL</span></code>, not <code class="docutils literal notranslate"><span class="pre">LEV</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EX</span></code> for excitation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VAL</span></code> for valence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GEOM</span></code> (not geo, not geometry).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SYM</span></code> (not symm, not symmetry).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FILE</span></code> (unless truly multiple FILES).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WRITE</span></code>/<code class="docutils literal notranslate"><span class="pre">READ</span></code> for info transfer across jobs. <code class="docutils literal notranslate"><span class="pre">SAVE</span></code>/<code class="docutils literal notranslate"><span class="pre">RESTART</span></code>
for same in context of restart.</p></li>
<li><p>Damping should interface through option (double) <code class="docutils literal notranslate"><span class="pre">DAMPING_PERCENTAGE</span></code>,
where a value of 0.0 indicates no damping.</p></li>
<li><p>Try to avoid <code class="docutils literal notranslate"><span class="pre">COMPUTE</span></code> or <code class="docutils literal notranslate"><span class="pre">CALC</span></code> in an option name. If it’s a
boolean like “opdm_compute” for “Do compute the one-particle density
matrix”, just use <code class="docutils literal notranslate"><span class="pre">OPDM</span></code>.</p></li>
<li><p>Properties should be governed by a <code class="docutils literal notranslate"><span class="pre">PROPERTIES</span></code> array for the root of
interest or by a <code class="docutils literal notranslate"><span class="pre">PROPERTIES_ALL</span></code> array for all roots in a multi-root
calc.  Since no module conforms to this right now, use <code class="docutils literal notranslate"><span class="pre">PROPERTY</span></code>
alone and <code class="docutils literal notranslate"><span class="pre">PROP</span></code> in multi-part option as <code class="docutils literal notranslate"><span class="pre">PROP_ROOT</span></code>, <code class="docutils literal notranslate"><span class="pre">PROP_ALL</span></code>,
<code class="docutils literal notranslate"><span class="pre">PROP_SYM</span></code> to conform.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">DF</span></code> (not ri) for density-fitting and resolution-of-the-identity
option names. Only the basis sets are staying as -RI since that’s what
EMSL uses.</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="manage_index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Managing: Git, Conda, CMake and all that</p>
      </div>
    </a>
    <a class="right-next"
       href="manage_git.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Git, Versioning</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-an-add-on-s-name-in-directory-structure-build-and-distribution">How to use an Add-On’s name in directory structure, build, and distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-integrate-an-add-on-into-build-testing-and-docs">How to integrate an Add-On into build, testing, and docs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#else">else</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-name-keywords-in-psi4-src-read-options-cc">How to name keywords in <code class="docutils literal notranslate"><span class="pre">psi4/src/read_options.cc</span></code></a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/manage_addon.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2007-2023, The Psi4 Project.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>