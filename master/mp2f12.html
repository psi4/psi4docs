<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->





<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MP2-F12: Explicitly Correlated MP2</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=88a353b9" />
    <link rel="stylesheet" type="text/css" href="_static/psi4.css?v=5cda37dd" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="_static/documentation_options.js?v=58abf35d"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CC: Coupled Cluster Theory" href="cc.html" />
    <link rel="prev" title="DLPNO-MP2: Domain-Based Local Pair Natural Orbital MP2" href="dlpnomp2.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="cc.html" title="CC: Coupled Cluster Theory"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="dlpnomp2.html" title="DLPNO-MP2: Domain-Based Local Pair Natural Orbital MP2"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/mp2f12.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/3e88889">1.11a1.dev15</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="methods.html" accesskey="U">Theoretical Methods: SCF to FCI</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">MP2-F12: Explicitly Correlated MP2</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="mp2-f12-explicitly-correlated-mp2">
<span id="sec-mp2f12"></span><span id="index-0"></span><h1>MP2-F12: Explicitly Correlated MP2<a class="headerlink" href="#mp2-f12-explicitly-correlated-mp2" title="Link to this heading">¶</a></h1>
<p><em>Code author: Erica Mitchell</em></p>
<p><em>Section author: Erica Mitchell</em></p>
<p><em>Module:</em> <a class="reference internal" href="autodir_options_c/module__f12.html#apdx-f12"><span class="std std-ref">Keywords</span></a>, <a class="reference internal" href="autodir_psivariables/module__f12.html#apdx-f12-psivar"><span class="std std-ref">PSI Variables</span></a>, <a class="extlink-source reference external" href="https://github.com/psi4/psi4/blob/master/psi4/src/psi4/f12">MP2-F12</a></p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>Convergence of the one-particle basis set to the electronic cusp is slow with traditional methods. This slow convergence is
inherent in all traditional electronic structure methods and has led to the construction of what are called explicitly
correlated methods. Explicitly correlated methods include terms that have the interelectronic distance within them significantly increasing
the speed at which convergence to the electronic cusp is achieved. These explicitly correlated terms contain the correlation
factor, <span class="math notranslate nohighlight">\(f_{12}\)</span>, which describes the behavior of the electronic cusp. The correlation factor is the defining part of
explicitly correlated methods.</p>
<p>The inclusion of <span class="math notranslate nohighlight">\(f_{12}\)</span> into the equations makes the prefactor for the computation much larger than traditional
methods. When running MP2-F12, the 3C(FIX) Ansatz is utilized along with the complementary auxiliary basis set (CABS) approach
resulting in an <span class="math notranslate nohighlight">\({\cal O}(N^5)\)</span> scaling separate from the prefactor. To lower the prefactor, density-fitting may be
utilized but scaling will remain the same.</p>
<p>An example input file is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">molecule</span> <span class="n">h2o</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="n">O</span>
<span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span>
<span class="n">H</span> <span class="mi">1</span> <span class="mf">1.0</span> <span class="mi">2</span> <span class="mf">104.5</span>
<span class="n">symmetry</span> <span class="n">c1</span>
<span class="p">}</span>

<span class="nb">set</span> <span class="p">{</span>
  <span class="n">basis</span>         <span class="n">cc</span><span class="o">-</span><span class="n">pvtz</span><span class="o">-</span><span class="n">f12</span>
  <span class="n">cabs_basis</span>    <span class="n">cc</span><span class="o">-</span><span class="n">pvtz</span><span class="o">-</span><span class="n">f12</span><span class="o">-</span><span class="n">optri</span>
  <span class="n">df_basis_f12</span>  <span class="n">aug</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvtz</span><span class="o">-</span><span class="n">ri</span>
  <span class="n">freeze_core</span>   <span class="kc">True</span>
  <span class="n">mp2_type</span>      <span class="n">df</span>
  <span class="n">f12_beta</span>      <span class="mf">1.0</span>
  <span class="n">cabs_singles</span>  <span class="kc">True</span>
<span class="p">}</span>

<span class="n">energy</span><span class="p">(</span><span class="s1">&#39;mp2-f12&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">energy('mp2-f12')</span></code> call to <a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a> executes the predefined MP-F12 procedure,
first calling the SCF module with a default RHF reference. The two-electron integrals may be solved either with
or without DF, as specified with <a class="reference internal" href="autodoc_glossary_options_c.html#term-MP2_TYPE-F12"><span class="xref std std-term">MP2_TYPE</span></a>. The general outline of an MP2-F12 computation is as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Form the CABS AO to MO transformation matrix</p></li>
<li><p>Compute the one- and two-electron integrals</p></li>
<li><p>Construct the F12 intermediates, <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(C\)</span>, and <span class="math notranslate nohighlight">\(B\)</span></p></li>
<li><p>Solve the F12 energy equation for each occupied orbital pair</p></li>
</ol>
</div></blockquote>
<p>The results will then look something like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">===&gt;</span> <span class="n">DF</span><span class="o">-</span><span class="n">MP2</span><span class="o">-</span><span class="n">F12</span><span class="o">/</span><span class="mi">3</span><span class="n">C</span><span class="p">(</span><span class="n">FIX</span><span class="p">)</span> <span class="n">Energies</span> <span class="o">&lt;===</span>

 <span class="n">Total</span> <span class="n">DF</span><span class="o">-</span><span class="n">MP2</span><span class="o">-</span><span class="n">F12</span><span class="o">/</span><span class="mi">3</span><span class="n">C</span><span class="p">(</span><span class="n">FIX</span><span class="p">)</span> <span class="n">Energy</span><span class="p">:</span>      <span class="o">-</span><span class="mf">76.362440627264</span>
    <span class="n">RHF</span> <span class="n">Reference</span> <span class="n">Energy</span><span class="p">:</span>              <span class="o">-</span><span class="mf">76.059038661557</span>
    <span class="n">MP2</span> <span class="n">Correlation</span> <span class="n">Energy</span><span class="p">:</span>             <span class="o">-</span><span class="mf">0.276433879145</span>
    <span class="n">F12</span><span class="o">/</span><span class="mi">3</span><span class="n">C</span><span class="p">(</span><span class="n">FIX</span><span class="p">)</span> <span class="n">Correlation</span> <span class="n">Energy</span><span class="p">:</span>     <span class="o">-</span><span class="mf">0.026029803210</span>
    <span class="n">CABS</span> <span class="n">Singles</span> <span class="n">Correction</span><span class="p">:</span>            <span class="o">-</span><span class="mf">0.000938283352</span>
</pre></div>
</div>
<p>The theory and common keywords used in MP2-F12 are presented below.</p>
</section>
<section id="theory">
<span id="index-1"></span><h2>Theory<a class="headerlink" href="#theory" title="Link to this heading">¶</a></h2>
<p>In MP2-F12, the second-order MBPT energy may be determined by minimizing the Hylleraas functional,</p>
<div class="math notranslate nohighlight" id="equation-hylleraasfunctional">
<span class="eqno">(1)<a class="headerlink" href="#equation-hylleraasfunctional" title="Link to this equation">¶</a></span>\[E^{(2)} = \langle \psi^{(1)} | \hat{H}^{(0)} - E^{(0)} | \psi^{(1)} \rangle
+ 2 \langle \psi^{(1)} | \hat{H}^{(1)} | \psi^{(0)} \rangle = = \min_{| \psi^{(1)} \rangle}\]</div>
<p>The resulting linear first-order equations can then be broken down into the conventional residual and the explicitly
correlated residual,</p>
<div class="math notranslate nohighlight" id="equation-residuals">
<span class="eqno">(2)<a class="headerlink" href="#equation-residuals" title="Link to this equation">¶</a></span>\[\begin{split}R^{ij}_{ab} = G^{ij}_{ab} + (\epsilon_a + \epsilon_b - \epsilon_i - \epsilon_j) T^{ij}_{ab} + T^{ij}_{mn} C^{mn}_{ab} \\
R^{ij}_{kl} = V^{ij}_{kl} + C^{kl}_{ab} T^{ij}_{ab} + \left[ B_{kl,mn} - (\epsilon_i + \epsilon_j)X_{kl,mn} \right] T^{ij}_{mn}\end{split}\]</div>
<p>where the last term of the <span class="math notranslate nohighlight">\(R^{ij}_{ab}\)</span> couples the two residuals. Within the
residuals, the correlation factor, <span class="math notranslate nohighlight">\(f_{12}\)</span>, and the projector, <span class="math notranslate nohighlight">\(\hat{Q}_{12}\)</span>,
are present in what are known as the F12 intermediates,</p>
<div class="math notranslate nohighlight" id="equation-short-f12-intermediates">
<span class="eqno">(3)<a class="headerlink" href="#equation-short-f12-intermediates" title="Link to this equation">¶</a></span>\[\begin{split}V^{ij}_{kl} &amp;= \langle ij | r_{12}^{-1} \hat{Q}_{12} f_{12} | kl \rangle \\
X_{kl,mn} &amp;= \langle kl | f_{12} \hat{Q}_{12} f_{12} | mn \rangle \\
C^{kl}_{ab} &amp;= \langle kl | f_{12} \hat{Q}_{12} \left( \hat{F}_1 + \hat{F}_2 \right) | ab \rangle \\
B_{kl,mn} &amp;= \langle kl | f_{12} \hat{Q}_{12} \left( \hat{F}_1 + \hat{F}_2 \right) \hat{Q}_{12} f_{12} | mn \rangle \\\end{split}\]</div>
<p>The correlation factor and projector are what hold the majority of the approximations made in F12 theory. Firstly, the correlation
factor is what describes the electronic cusp but, similar to how a nuclear cusp is simulated by contracted Gaussian-type orbitals,
the <span class="math notranslate nohighlight">\(f_{12}\)</span> is composed of multiple Gaussian-type geminals to imitate a Slater-type geminal,</p>
<div class="math notranslate nohighlight" id="equation-correlation-factor">
<span class="eqno">(4)<a class="headerlink" href="#equation-correlation-factor" title="Link to this equation">¶</a></span>\[f_{12} = \frac{1 - e^{-\beta r_{12}}{\beta} \approx \sum^6_{n=1} c_n e^{-\alpha_n r_{12}^2}\]</div>
<p>where the coefficients and exponents are taken from Tew and Klopper <a class="reference internal" href="bibliography.html#tew-2005-074101" id="id1"><span>[Tew:2005:074101]</span></a> and can be scaled using the parameter <span class="math notranslate nohighlight">\(\beta\)</span>.
Secondly, the projector is what holds the chosen Ansatz. In other words, the projector determines the choice of orthogonalization between
the explicitly correlated functions and to the conventional doubly substituted determinants. The strongest orthogonality is observed with</p>
<div class="math notranslate nohighlight" id="equation-ansatz-3">
<span class="eqno">(5)<a class="headerlink" href="#equation-ansatz-3" title="Link to this equation">¶</a></span>\[\hat{Q}_{12} = (1-\hat{O}_1)(1-\hat{O}_2) - \hat{V}_1 \hat{V}_2\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{O}\)</span> represents <span class="math notranslate nohighlight">\(| i \rangle\langle i |\)</span> and <span class="math notranslate nohighlight">\(\hat{V}\)</span> represents <span class="math notranslate nohighlight">\(| a \rangle\langle a |\)</span>. This form of
the projector is known as Ansatz 3.</p>
<p>Within modern F12 theory, the ansatz inherently holds the resolution-of-identity (RI). The RI can be taken as functions from the
orbital basis set (OBS) and a chosen auxiliary basis set (ABS). It was observed by Valeev <a class="reference internal" href="bibliography.html#valeev-2004-190" id="id2"><span>[Valeev:2004:190]</span></a> that the choice of ABS
can affect the error due to the use of a finite RI. He proposed that the ABS include the OBS explicitly so that the exact orthogonal
complement projector <span class="math notranslate nohighlight">\(\hat{Q}_{12} = 1 - \hat{P}_{12}\)</span> is properly approximated. This lead to what is known as the complementary
auxiliary basis set or CABS. The expanded Ansatz 3 projector with the RI and CABS is then</p>
<div class="math notranslate nohighlight" id="equation-cabs-ansatz-3">
<span class="eqno">(6)<a class="headerlink" href="#equation-cabs-ansatz-3" title="Link to this equation">¶</a></span>\[\hat{Q}_{12} = 1 - | a'j \rangle\langle a'j | - | ib' \rangle\langle ib' | - | rs \rangle\langle rs |\]</div>
<p>When applying the projector within the CABS approach to the F12 intermediates, the <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(B\)</span> intermediates contain terms which
require commutation of the correlation factor, <span class="math notranslate nohighlight">\(f_{12}\)</span>, and the Fock operator, <span class="math notranslate nohighlight">\(\hat{F}\)</span>. To factorize these, there are three
different approaches, A, B, and C. In general, Ansatz 3 with approximation C, or Ansatz 3C, is computationally cheaper than ans{&quot;a}tze 3A
and 3B. In Ansatz 3C, the unit operator in the projector is treated with the commutator approach while the rest utilizes direct RI
expansions. Within Ansatz 3C, the F12 intermediates then take the form</p>
<div class="math notranslate nohighlight" id="equation-long-f12-intermediates">
<span class="eqno">(7)<a class="headerlink" href="#equation-long-f12-intermediates" title="Link to this equation">¶</a></span>\[\begin{split}V^{ij}_{kl} &amp;= (\overline{gf})^{ij}_{kl} - \overline{g}^{ij}_{a'n}\overline{f}^{a'n}_{kl} -
               \overline{g}^{ij}_{mb'}\overline{f}^{mb'}_{kl} - \overline{g}^{ij}_{rs}\overline{f}^{rs}_{kl} \\
X_{kl,mn} &amp;= \left(f^2\right)^{kl}_{mn} - \overline{f}^{kl}_{ib'}\overline{f}^{ib'}_{mn} -
             \overline{f}^{kl}_{a'j}\overline{f}^{a'j}_{mn} - \overline{f}^{kl}_{pq}\overline{f}^{pq}_{mn} \\
C^{kl}_{ab} &amp;= \overline{f}^{kl}_{ab'}F^{b'}_{b} + \overline{f}^{kl}_{a'b}F^{a'}_{a} \\
B_{kl,mn} &amp;= \langle kl|[\hat{f}_{12},[\hat{T}_{12},\hat{f}_{12}]]|mn\rangle + \hat{S}_{mn,kl} \left[ (\overline{f^2})^{p'l}_{mn}(F + K)^k_{p'}
             + (\overline{f^2})^{kq'}_{mn}(F + K)^l_{q'} \right] \\
            &amp;- \overline{f}^{p'q'}_{mn}K^{r'}_{p'}\overline{f}^{kl}_{r'q'} - \overline{f}^{p'j}_{mn}F^{r'}_{p'}\overline{f}^{kl}_{r'j} +
               \overline{f}^{ib'}_{mn}F^{j}_{i}\overline{f}^{kl}_{jb'} - \overline{f}^{pb}_{mn}F^{r}_{p}\overline{f}^{kl}_{rb} \\
            &amp;- 2\hat{S}_{mn,kl}\left[ \overline{f}^{ib'}_{mn}F^{p'}_{i}\overline{f}^{kl}_{p'b'} +
               \overline{f}^{a'b}_{mn}F^{q}_{a'}\overline{f}^{kl}_{qb} \right]\end{split}\]</div>
<p>where the following integral types are revealed,</p>
<div class="math notranslate nohighlight" id="equation-integral-types">
<span class="eqno">(8)<a class="headerlink" href="#equation-integral-types" title="Link to this equation">¶</a></span>\[\begin{split}&amp;\langle p'q'|r_{12}^{-1}|r's'\rangle = g^{p'q'}_{r's'} \\
&amp;\langle p'q'|\hat{f}_{12}|r's'\rangle = f^{p'q'}_{r's'} \\
&amp;\langle p'q'|\hat{f}_{12}^{2}|r's'\rangle= (f^2)^{p'q'}_{r's'} \\
&amp;\langle p'q'|\hat{f}_{12}\:r_{12}^{-1}|r's'\rangle = (gf)^{p'q'}_{r's'} \\
&amp;\langle p'q'|[\hat{f}_{12},[\hat{T}_{12},\hat{f}_{12}]]|r's'\rangle\end{split}\]</div>
<p>Before the energy expression can be revealed, the choice of explicitly correlated amplitudes must be taken into account. Although the
residuals can both be set to zero to solve for the minimized amplitudes, it has been determined that the best approach is by utilizing
the electronic cusp conditions so that the <em>s</em>- and <em>p</em>- wave coalesence conditions are met <a class="reference internal" href="bibliography.html#tenno-2004-117" id="id3"><span>[Tenno:2004:117]</span></a>. This results in only the
conventional residual, <span class="math notranslate nohighlight">\(R^{ij}_{ab}\)</span>,  being minimized and the explicitly correlated amplitudes being</p>
<div class="math notranslate nohighlight" id="equation-fixed-amps">
<span class="eqno">(9)<a class="headerlink" href="#equation-fixed-amps" title="Link to this equation">¶</a></span>\[T^{ij}_{kl} = \frac{3}{8}\delta_{ik}\delta{jl} + \frac{1}{8}\delta_{jk}\delta{il}\]</div>
<p>which is denoted as the 3C(FIX) Ansatz. The 3C(FIX) Ansatz has the benefits that it is free from the geminal basis set superposition error,
orbital invariant, and diagonal. Since only diagonal terms are needed, the computational complexity reduces from <span class="math notranslate nohighlight">\({\cal O}(N^6)\)</span> with
the minimized amplitudes to <span class="math notranslate nohighlight">\({\cal O}(N^5)\)</span> with fixed amplitudes.</p>
<p>Finally, the F12/3C(FIX) energy correction can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-f12-correction">
<span class="eqno">(10)<a class="headerlink" href="#equation-f12-correction" title="Link to this equation">¶</a></span>\[\Delta E_\mathrm{F12/3C(FIX)} = T^{ij}_{kl} \left( 2\Tilde{V}^{ij}_{kl} + \Tilde{B}^{ij}_{kl,mn} T^{ij}_{mn} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Tilde{V}^{ij}_{kl}\)</span> and <span class="math notranslate nohighlight">\(\Tilde{B}^{ij}_{kl,mn}\)</span> are</p>
<div class="math notranslate nohighlight" id="equation-tilde-intermediates">
<span class="eqno">(11)<a class="headerlink" href="#equation-tilde-intermediates" title="Link to this equation">¶</a></span>\[\begin{split}\Tilde{V}^{ij}_{kl} &amp;= V^{ij}_{kl} - \frac{C^{kl}_{ab} G^{ij}_{ab}}{\epsilon_a + \epsilon_b - \epsilon_i - \epsilon_j} \\
\Tilde{B}^{ij}_{kl,mn} &amp;= B_{kl,mn} - (\epsilon_i + \epsilon_j)X_{kl,mn} - \frac{C^{mn}_{ab} C^{kl}_{ab}}{\epsilon_a + \epsilon_b - \epsilon_i - \epsilon_j}\end{split}\]</div>
<p>With the slow convergence of the conventional doubles energy handled, the primary source of error then comes from the basis set
incompleteness error from the HF reference. When the CABS is utilized, the relaxation of the HF orbitals in the presence of the
CABS needs to be accounted for. This is done using the what’s termed the CABS singles correction. The CABS singles correction
is reminiscent of the singles correction in MP2 without a RHF or UHF reference,</p>
<div class="math notranslate nohighlight" id="equation-cabs-singles">
<span class="eqno">(12)<a class="headerlink" href="#equation-cabs-singles" title="Link to this equation">¶</a></span>\[\Delta E_\mathrm{CABS Singles} = \frac{|F_i^\alpha|^2}{\epsilon_\alpha - \epsilon_i}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> runs over all virtual orbitals, OBS virtuals and CABS.</p>
<p>Therefore, the most accurate MP2-F12/3C(FIX) energy is given by</p>
<div class="math notranslate nohighlight" id="equation-mp2-f12-3c-fix">
<span class="eqno">(13)<a class="headerlink" href="#equation-mp2-f12-3c-fix" title="Link to this equation">¶</a></span>\[E_\mathrm{MP2-F12/3C(FIX)} = E_\mathrm{MP2} + \Delta E_\mathrm{F12} + \Delta E_\mathrm{CABS Singles}\]</div>
</section>
<section id="recommendations">
<h2>Recommendations<a class="headerlink" href="#recommendations" title="Link to this heading">¶</a></h2>
<p>MP2-F12 is a complicated theory but the implemented module should be simple to use. All keywords are
appropriately documented in the Appendix <a class="reference internal" href="autodir_options_c/module__f12.html#apdx-f12"><span class="std std-ref">F12</span></a> and care should be taken to read through
them before changing defaults. Some basic recommendations for running the module are included below:</p>
<ul class="simple">
<li><p>MP2-F12 runs much faster with density-fitted integrals. Unless high accuracy is needed, DF requires much
less computational resources and still provides quality results. If DF is chosen, the HF and MP2 modules
are also set to run DF. Choose a DF basis set with at least triple-zeta quality as
<span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span>‘s <a class="reference internal" href="scf.html#sec-scf"><span class="std std-ref">DF-SCF</span></a> module performs poorly with lower quality DF basis sets.
This module utilizes robust density-fitting <a class="reference internal" href="bibliography.html#dunlap-2000-2113" id="id4"><span>[Dunlap:2000:2113]</span></a> so energies may differ from other programs.
The default <a class="reference internal" href="autodoc_glossary_options_c.html#term-MP2_TYPE-F12"><span class="xref std std-term">MP2_TYPE</span></a> is <code class="docutils literal notranslate"><span class="pre">DF</span></code>.</p></li>
<li><p>The length-scale parameter <code class="docutils literal notranslate"><span class="pre">F12_BETA</span></code> has been fiddled with in many past studies and they have determined
that the exponents 0.9, 1.0, and 1.0 <span class="math notranslate nohighlight">\(a_0^{-1}\)</span> are recommended for cc-pVXZ-F12 where X = D, T, and Q,
respectively, while those for aug-cc-pVXZ where X = D, T, and Q are 1.1, 1.2, and 1.4 <span class="math notranslate nohighlight">\(a_0^{-1}\)</span>.
The default value is set to 1.0 <span class="math notranslate nohighlight">\(a_0^{-1}\)</span> to allow flexibility of use.</p></li>
<li><p>MP2-F12 likes threads. The module was developed with threading in mind and the formation of the
integrals and the tensor contractions rely on the threads for efficiency.</p></li>
<li><p>MP2-F12 is memory greedy. The core algorithm has been developed to compute the integrals on-the-fly but
the size of some integrals cannot be avoided. Care should be taken to choose whether the core or disk
algorithm is chosen, <a class="reference internal" href="autodoc_glossary_options_c.html#term-F12_SUBTYPE-F12"><span class="xref std std-term">F12_SUBTYPE</span></a> .</p></li>
<li><p>Like most wavefunction methods, freezing the core is good for both efficiency and correctness purposes.</p></li>
<li><p>MP2-F12 is not symmetry aware.</p></li>
<li><p>MP2-F12 cannot use Psi4’s Schwarz screening due to the presence of mixed basis sets. This is a work
in progress but siginificantly increases the computational prefactor.</p></li>
<li><p>At the moment, the MP2-F12 code is only compatible with RHF references.</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="index.html">
    <img class="logo" src="_static/psi4square.png" alt="Logo"/>
  </a></p>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel"
                                       aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/></div>
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">MP2-F12: Explicitly Correlated MP2</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#theory">Theory</a></li>
<li><a class="reference internal" href="#recommendations">Recommendations</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="cc.html" title="CC: Coupled Cluster Theory"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="dlpnomp2.html" title="DLPNO-MP2: Domain-Based Local Pair Natural Orbital MP2"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/mp2f12.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/3e88889">1.11a1.dev15</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="methods.html" >Theoretical Methods: SCF to FCI</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">MP2-F12: Explicitly Correlated MP2</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2026, The Psi4 Project.
      Last updated on Monday, 05 January 2026 07:21PM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>