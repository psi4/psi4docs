
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Evaluation of One-Electron Properties — oeprop()</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css?v=c7cf8c76" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script src="_static/documentation_options.js?v=0a908d79"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'oeprop';</script>
    <link rel="icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Vibrational and Thermochemical Analysis" href="thermo.html" />
    <link rel="prev" title="Geometry Optimization" href="optking.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Tuesday, 26 September 2023 02:05AM"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/psi4square.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/psi4square.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
        </div>
      
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Evaluation of One-Electron Properties — <code class="xref py py-func docutils literal notranslate"><span class="pre">oeprop()</span></code></a><ul>
<li><a class="reference internal" href="#basic-keywords">Basic Keywords</a></li>
<li><a class="reference internal" href="#properties-evaluated-on-a-grid">Properties evaluated on a grid</a></li>
<li><a class="reference internal" href="#minimal-basis-iterative-stockholder">Minimal Basis Iterative Stockholder</a></li>
</ul>
</li>
</ul>

  </div></div>
        <div class="sidebar-primary-item">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="optking.html"
                          title="previous chapter">Geometry Optimization</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="thermo.html"
                          title="next chapter">Vibrational and Thermochemical Analysis</a></p>
  </div></div>
        <div class="sidebar-primary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/oeprop.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>
        <div class="sidebar-primary-item">
<div id="searchbox"></div></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="methods.html" class="nav-link">Theoretical Methods: SCF to FCI</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Evaluation...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="evaluation-of-one-electron-properties-w-w-oeprop">
<span id="sec-oeprop"></span><span id="index-0"></span><h1>Evaluation of One-Electron Properties — <a class="reference internal" href="api/psi4.driver.oeprop.html#psi4.driver.oeprop" title="psi4.driver.oeprop"><code class="xref py py-func docutils literal notranslate"><span class="pre">oeprop()</span></code></a><a class="headerlink" href="#evaluation-of-one-electron-properties-w-w-oeprop" title="Link to this heading">#</a></h1>
<p><em>Code author: Robert M. Parrish and Andrew C. Simmonett</em></p>
<p><em>Section author: Andrew C. Simmonett</em></p>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">psi4.</span></span><span class="sig-name descname"><span class="pre">oeprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/psi4/driver/p4util/util.html#oeprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Evaluate one-electron properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>wfn</strong> (<a class="reference internal" href="api/psi4.core.Wavefunction.html#psi4.core.Wavefunction" title="psi4.core.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a>) – set of molecule, basis, orbitals from which to compute properties</p></li>
<li><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/typing.html#typing.List" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – Arbitrary-number of properties to be computed from <em>wfn</em>.
See <a class="reference internal" href="#table-oe-features"><span class="std std-ref">Available One-Electron Properties</span></a>.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3.10/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – label prepended to all psivars computed</p></li>
</ul>
</dd>
<dt class="field-odd">Examples<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># [1] Moments with specific label</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">energy</span><span class="p">(</span><span class="s1">&#39;hf&#39;</span><span class="p">,</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oeprop</span><span class="p">(</span><span class="n">wfn</span><span class="p">,</span> <span class="s1">&#39;DIPOLE&#39;</span><span class="p">,</span> <span class="s1">&#39;QUADRUPOLE&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;H3O+ SCF&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<p><span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> is capable of computing a number of one-electron properties
summarized in the table below.</p>
<span id="table-oe-features"></span><table class="table" id="id2">
<caption><span class="caption-text">Current one-electron property capabilities of <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span></span><a class="headerlink" href="#id2" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Keyword</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Electric dipole moment</p></td>
<td><p>DIPOLE</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Electric quadrupole moment</p></td>
<td><p>QUADRUPOLE</p></td>
<td><p>Raw (traced) moments and traceless multipoles</p></td>
</tr>
<tr class="row-even"><td><p>All moments up order N</p></td>
<td><p>MULTIPOLE(N)</p></td>
<td><p>Only raw (traced) moments. Sets global variables e.g. “DIPOLE”, “32-POLE”</p></td>
</tr>
<tr class="row-odd"><td><p>Electrostatic potential, at nuclei</p></td>
<td><p>ESP_AT_NUCLEI</p></td>
<td><p>Sets global variables “ESP AT CENTER n”, n = 1 to natoms</p></td>
</tr>
<tr class="row-even"><td><p>Electrostatic potential, on grid</p></td>
<td><p>GRID_ESP</p></td>
<td><p>Generates V at each point in grid_esp.dat. See <a class="reference internal" href="#sec-oeprop-grid"><span class="std std-ref">Properties evaluated on a grid</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Electric field, on grid</p></td>
<td><p>GRID_FIELD</p></td>
<td><p>Generates {Ex,Ey,Ez} at each point grid_field.dat. See <a class="reference internal" href="#sec-oeprop-grid"><span class="std std-ref">Properties evaluated on a grid</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Molecular orbital extents</p></td>
<td><p>MO_EXTENTS</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Mulliken atomic charges</p></td>
<td><p>MULLIKEN_CHARGES</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Löwdin atomic charges</p></td>
<td><p>LOWDIN_CHARGES</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Wiberg bond indices</p></td>
<td><p>WIBERG_LOWDIN_INDICES</p></td>
<td><p>Uses (Löwdin) symmetrically orthogonalized orbitals</p></td>
</tr>
<tr class="row-even"><td><p>Mayer bond indices</p></td>
<td><p>MAYER_INDICES</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Natural orbital occupations</p></td>
<td><p>NO_OCCUPATIONS</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Stockholder Atomic Multipoles</p></td>
<td><p>MBIS_CHARGES</p></td>
<td><p>Generates atomic charges, dipoles, etc. See <a class="reference internal" href="#sec-oeprop-mbis"><span class="std std-ref">Minimal Basis Iterative Stockholder</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Hirshfeld volume ratios</p></td>
<td><p>MBIS_VOLUME_RATIOS</p></td>
<td><p>Generate the AIM to free atom volume ratios</p></td>
</tr>
</tbody>
</table>
<p>There are two ways the computation of one-electron properties can be requested.
Firstly, the properties can be evaluated from the last
computed one-particle density, using the following syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">oeprop</span><span class="p">(</span><span class="s2">&quot;MO_EXTENTS&quot;</span><span class="p">,</span> <span class="s2">&quot;MULTIPOLE(4)&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;hello!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that it is the user’s responsibility to ensure that the relaxed density
matrix is computed using the method of interest, which may require setting
additional keywords (see the method’s manual section for details). The named
argument, <em>title</em>, is completely optional and is prepended to any
globals variables set during the computation.  The unnamed arguments are the
properties to be computed.  These can appear in any order, and multiple
properties may be requested, as in the example above.  Note that, due to Python
syntax restrictions, the title argument must appear after the list of
properties to compute.  The available properties are shown in the table above.</p>
<p>The syntax above works well for computing properties using the SCF
wavefunction, however, may be difficult (or impossible) to use for some of the
correlated levels of theory. Alternatively, one-electron properties can be
computed using the built-in properties() function, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">properties</span><span class="p">(</span><span class="s1">&#39;ccsd&#39;</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dipole&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/psi4.driver.properties.html#psi4.driver.properties" title="psi4.driver.properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">properties()</span></code></a> function provides limited functionality, but is a lot easier to
use for correlated methods. For capabilities of <a class="reference internal" href="api/psi4.driver.properties.html#psi4.driver.properties" title="psi4.driver.properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">properties()</span></code></a> see the
corresponding section of the manual.</p>
<section id="basic-keywords">
<h2>Basic Keywords<a class="headerlink" href="#basic-keywords" title="Link to this heading">#</a></h2>
<p>Multipole moments may be computed at any origin, which is controlled by the
global <a class="reference internal" href="autodoc_glossary_options_c.html#term-PROPERTIES_ORIGIN-GLOBALS"><span class="xref std std-term">PROPERTIES_ORIGIN</span></a> keyword.  The keyword takes an array with
the following possible values:</p>
<span id="table-oe-origin"></span><table class="table" id="id3">
<caption><span class="caption-text">Allowed origin specifications</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>[x, y, z]</p></td>
<td><p>Origin is at the coordinates, in the same units as the geometry specification</p></td>
</tr>
<tr class="row-odd"><td><p>[“COM”]</p></td>
<td><p>Origin is at the center of mass</p></td>
</tr>
<tr class="row-even"><td><p>[“NUCLEAR_CHARGE”]</p></td>
<td><p>Origin is at the center of nuclear charge</p></td>
</tr>
</tbody>
</table>
</section>
<section id="properties-evaluated-on-a-grid">
<span id="sec-oeprop-grid"></span><h2>Properties evaluated on a grid<a class="headerlink" href="#properties-evaluated-on-a-grid" title="Link to this heading">#</a></h2>
<p>Certain properties may be evaluated a user-specified grid points.  The grid
points are completely arbitrary and are specified by providing a file called
grid.dat containing the x,y,z values separated with spaces for each point in order:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="n">y1</span> <span class="n">z1</span>
<span class="n">x2</span> <span class="n">y2</span> <span class="n">z2</span>
<span class="o">..........</span>
<span class="n">xn</span> <span class="n">yn</span> <span class="n">zn</span>
</pre></div>
</div>
<p>The grid.dat file is completely free form; any number of spaces and/or newlines
between entries is permitted.  The units of the coordinates in grid.dat are the
same as those used to specify the molecule’s geometry, and the output
quantities are always in atomic units.  The requested properties will be
written out in the same order as the grid point specification in grid.dat; see
the above table for the format and file name of the output.</p>
<p>The grid may be generated in the input file using standard Python loops.  By
capturing the wavefunction used to evaluate the one-electron properties, the
values at each grid point may be captured as Python arrays in the input file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">E</span><span class="p">,</span> <span class="n">wfn</span> <span class="o">=</span> <span class="n">prop</span><span class="p">(</span><span class="s1">&#39;scf&#39;</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GRID_ESP&quot;</span><span class="p">,</span> <span class="s2">&quot;GRID_FIELD&quot;</span><span class="p">],</span> <span class="n">return_wfn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">Vvals</span> <span class="o">=</span> <span class="n">wfn</span><span class="o">.</span><span class="n">oeprop</span><span class="o">.</span><span class="n">Vvals</span><span class="p">()</span>
<span class="n">Exvals</span> <span class="o">=</span> <span class="n">wfn</span><span class="o">.</span><span class="n">oeprop</span><span class="o">.</span><span class="n">Exvals</span><span class="p">()</span>
<span class="n">Eyvals</span> <span class="o">=</span> <span class="n">wfn</span><span class="o">.</span><span class="n">oeprop</span><span class="o">.</span><span class="n">Eyvals</span><span class="p">()</span>
<span class="n">Ezvals</span> <span class="o">=</span> <span class="n">wfn</span><span class="o">.</span><span class="n">oeprop</span><span class="o">.</span><span class="n">Ezvals</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example, the <em>Vvals</em> array contains the electrostatic potential at each
grid point, in the order that the grid was specified, while the <em>Exvals</em>,
<em>Eyvals</em> and <em>Ezvals</em> arrays contain the <em>x</em>, <em>y</em> and <em>z</em> components of the
electric field, respectively; all of these arrays can be iterated and
manipulated using standard Python syntax.  For a complete demonstration of this
utility, see the <a class="reference external" href="https://github.com/psi4/psi4/blob/master/samples/props4/input.dat">props4</a> test case.</p>
</section>
<section id="minimal-basis-iterative-stockholder">
<span id="sec-oeprop-mbis"></span><span id="index-1"></span><h2>Minimal Basis Iterative Stockholder<a class="headerlink" href="#minimal-basis-iterative-stockholder" title="Link to this heading">#</a></h2>
<p>The Minimal Basis Iterative Stockholder (MBIS) method is one of many procedures
that partitions a molecular one-particle density matrix into atomic electron densities.
Running MBIS in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> will calculate atomic valence charge widths, volume ratios,
atomic charges, as well as dipoles, quadrupoles, and octupoles.
Additionally, all expectation values of radial moments of n-th order (<span class="math notranslate nohighlight">\(&lt;r^n&gt;\)</span>)
are computed up to fourth order. Higher moments can be computed by specifying <a class="reference internal" href="autodoc_glossary_options_c.html#term-MAX_RADIAL_MOMENT-GLOBALS"><span class="xref std std-term">MAX_RADIAL_MOMENT</span></a>.
The volume ratios are computed as the ratio between the volume of the atomic density
(<span class="math notranslate nohighlight">\(&lt;r^3&gt;\)</span>) and the volume of the free atom computed using the same level
of theory, but with a potentially unrestricted reference.</p>
<p>The allowed number of iterations and convergence criteria for the stockholder
algorithm is controlled by <a class="reference internal" href="autodoc_glossary_options_c.html#term-MBIS_MAXITER-GLOBALS"><span class="xref std std-term">MBIS_MAXITER</span></a> and <a class="reference internal" href="autodoc_glossary_options_c.html#term-MBIS_D_CONVERGENCE-GLOBALS"><span class="xref std std-term">MBIS_D_CONVERGENCE</span></a>. Note
that the density is partitioned on a molecular quadrature grid, the details of which can be
controlled with the keywords <a class="reference internal" href="autodoc_glossary_options_c.html#term-MBIS_RADIAL_POINTS-GLOBALS"><span class="xref std std-term">MBIS_RADIAL_POINTS</span></a>, <a class="reference internal" href="autodoc_glossary_options_c.html#term-MBIS_SPHERICAL_POINTS-GLOBALS"><span class="xref std std-term">MBIS_SPHERICAL_POINTS</span></a>, and
<a class="reference internal" href="autodoc_glossary_options_c.html#term-MBIS_PRUNING_SCHEME-GLOBALS"><span class="xref std std-term">MBIS_PRUNING_SCHEME</span></a>. (Associated Paper: <a class="reference internal" href="bibliography.html#verstraelen-2016" id="id1"><span>[Verstraelen:2016]</span></a>)</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="optking.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Geometry Optimization</p>
      </div>
    </a>
    <a class="right-next"
       href="thermo.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Vibrational and Thermochemical Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-keywords">Basic Keywords</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-evaluated-on-a-grid">Properties evaluated on a grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimal-basis-iterative-stockholder">Minimal Basis Iterative Stockholder</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="_sources/oeprop.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2007-2023, The Psi4 Project.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>