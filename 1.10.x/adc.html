<!-- 
#
# @BEGIN LICENSE
#
# Psi4: an open-source quantum chemistry software package
#
# Copyright (c) 2007-2017 The Psi4 Developers.
#
# The copyrights for code used from other parties are included in
# the corresponding files.
#
# This file is part of Psi4.
#
# Psi4 is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation, version 3.
#
# Psi4 is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License along
# with Psi4; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
#
# @END LICENSE
# -->





<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ADC: Ab Initio Polarization Propagator</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=88a353b9" />
    <link rel="stylesheet" type="text/css" href="_static/psi4.css?v=5cda37dd" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script src="_static/documentation_options.js?v=03a09e7b"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    
    
     
        <script src="_static/jquery.cookie.js"></script>
    

    
     
        <script src="_static/cloud.base.js"></script>
    

    
     
        <script src="_static/cloud.js"></script>
    

    <link rel="icon" href="_static/favicon-psi4.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scalar relativistic Hamiltonians" href="relativistic.html" />
    <link rel="prev" title="F/I-SAPT: Functional Group and/or Intramolecular SAPT" href="fisapt.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="relativistic.html" title="Scalar relativistic Hamiltonians"
             accesskey="N"><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="fisapt.html" title="F/I-SAPT: Functional Group and/or Intramolecular SAPT"
             accesskey="P"><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             accesskey="C"><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/adc.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/f2492db">1.10</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="methods.html" accesskey="U">Theoretical Methods: SCF to FCI</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">ADC: Ab Initio Polarization Propagator</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="adc-ab-initio-polarization-propagator">
<span id="sec-adc"></span><span id="index-2"></span><span id="index-1"></span><span id="index-0"></span><h1>ADC: Ab Initio Polarization Propagator<a class="headerlink" href="#adc-ab-initio-polarization-propagator" title="Link to this heading">¶</a></h1>
<p><em>Section author: Michael F. Herbst</em></p>
<p><em>Module:</em> <a class="reference internal" href="autodir_options_c/module__adc.html#apdx-adc"><span class="std std-ref">Keywords</span></a>, <a class="reference internal" href="autodir_psivariables/module__adc.html#apdx-adc-psivar"><span class="std std-ref">PSI Variables</span></a></p>
<p>Algebraic-diagrammatic construction methods for the polarization propagator (ADC)
determine correlated excitation energies by investigating the pole structure
of said propagator. For this the propagator is expressed in a representation
constructed from so-called intermediate states, which in turn are based
upon a correlated Møller–Plesset (MP) ground state. The original derivation
of the ADC scheme was purely diagrammatic <a class="reference internal" href="bibliography.html#schirmer-1982" id="id1"><span>[Schirmer:1982]</span></a>
and the connect to the intermediate states was developed only later <a class="reference internal" href="bibliography.html#trofimov-2006" id="id2"><span>[Trofimov:2006]</span></a>.
In general <span class="math notranslate nohighlight">\(n\)</span>-th order ADC theory, ADC(<span class="math notranslate nohighlight">\(n\)</span>),
is constructed upon an <span class="math notranslate nohighlight">\(n\)</span>-th order MP ground state.
In this sense one can consider an ADC(<span class="math notranslate nohighlight">\(n\)</span>) treatment of excited states
consistent to an MP(<span class="math notranslate nohighlight">\(n\)</span>) perturbation expansion of the ground state.</p>
<p>In ADC methods the residue calculus of the propagator is translated into an eigenvalue
problem with respect to the so-called shifted Hamiltonian or ADC matrix.
Denoting this matrix as <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, the eigenproblem can be written
in terms of several blocks</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
\mathbf{A_{SS}} &amp; \mathbf{A_{SD}}\\
\mathbf{A_{DS}} &amp; \mathbf{A_{DD}}
\end{pmatrix}
\begin{pmatrix}
\mathbf{X_S}\\
\mathbf{X_D}
\end{pmatrix}
=\omega
\begin{pmatrix}
\mathbf{X_S}\\
\mathbf{X_D}
\end{pmatrix}\end{split}\]</div>
<p>where <em>S</em> refers to the single and <em>D</em> to the double excitation manifolds.
This matrix is typically sparse and thus may be diagonalised iteratively,
for example using Davidson’s method <a class="reference internal" href="bibliography.html#dreuw-2014-82" id="id3"><span>[Dreuw:2014:82]</span></a>. An alternative viewpoint
has been addressed for example in <a class="reference internal" href="bibliography.html#haettig-2002" id="id4"><span>[Haettig:2002]</span></a>, where ADC(2) is related
to other response theories such as CC2-LR, CIS(D) and CIS(D<span class="math notranslate nohighlight">\(_n\)</span>).
In this sense one may consider the ADC matrix the correlated response matrix
to a response problem based on CIS
and apply the simultaneous expansion method (SEM),
in which the σ-vectors (ADC matrix-vector products)
are constructed several times.</p>
<p>The structure and order of the blocks in the equation above
depend on the ADC level employed. With this also the computational cost changes.
The key computational step, namely the formation of the matrix-vector products
scales as <span class="math notranslate nohighlight">\({\cal O}(N^5)\)</span> for ADC(2) and <span class="math notranslate nohighlight">\({\cal O}(N^6)\)</span>
for ADC(2)-x and ADC(3). Several additional approximations,
such as frozen-core, frozen-virtual
may be applied to reduce the cost of the problem.
Using the core-valence separation (CVS) approximation
one may specifically target core-valence-excitations
at a substantial reduction in cost.
With the spin-flip modification few-reference ground states can
be tackled starting from a triplet reference by simultaneously
exciting an electron and flipping its spin.
A more detailed overview of such modifications gives <a class="reference internal" href="bibliography.html#dreuw-2014-82" id="id5"><span>[Dreuw:2014:82]</span></a>
and the <a class="reference external" href="https://adc-connect.org/latest/theory.html">adcc theory documentation</a>.</p>
<section id="available-adc-methods">
<h2>Available ADC methods<a class="headerlink" href="#available-adc-methods" title="Link to this heading">¶</a></h2>
<p><em>Section author: Michael F. Herbst</em></p>
<p>Several ADC methods are available in <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> for the computation of excited states,
see <a class="reference internal" href="#table-adcsummary"><span class="std std-ref">ADC capabilities of Psi4</span></a>.
The methods are available via an interface to the <a class="reference external" href="https://adc-connect.org">adcc</a> python module.
After a more general introduction, specific aspects of the implementation will be highlighted
in section <a class="reference internal" href="#sec-interfaceadcc"><span class="std std-ref">Interface to adcc</span></a>.</p>
<span id="table-adcsummary"></span><table class="docutils align-default" id="id8">
<caption><span class="caption-text">ADC capabilities of Psi4</span><a class="headerlink" href="#id8" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>References</p></th>
<th class="head"><p>Exc. Energies</p></th>
<th class="head"><p>Props</p></th>
<th class="head"><p>Supported values for kind keyword</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ADC(1)</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>any, singlet, triplet, spin_flip</p></td>
</tr>
<tr class="row-odd"><td><p>ADC(2)</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>any, singlet, triplet, spin_flip</p></td>
</tr>
<tr class="row-even"><td><p>ADC(2)-x</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>any, singlet, triplet, spin_flip</p></td>
</tr>
<tr class="row-odd"><td><p>ADC(3)</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td colspan="2"><p>yes   |  any, singlet, triplet, spin_flip</p></td>
</tr>
<tr class="row-even"><td><p>CVS-ADC(1)</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td colspan="2"><p>yes   |  any, singlet, triplet</p></td>
</tr>
<tr class="row-odd"><td><p>CVS-ADC(2)</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>any, singlet, triplet</p></td>
</tr>
<tr class="row-even"><td><p>CVS-ADC(2)-x</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>any, singlet, triplet</p></td>
</tr>
<tr class="row-odd"><td><p>CVS-ADC(3)</p></td>
<td><p>RHF, UHF</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>any, singlet, triplet</p></td>
</tr>
</tbody>
</table>
<p>The leftmost column of table <a class="reference internal" href="#table-adcsummary"><span class="std std-ref">ADC capabilities of Psi4</span></a> provides the supported ADC methods.
If only excitation energies are desired, one can simply pass one
of the listed method strings to the function <a class="reference internal" href="api/psi4.driver.energy.html#psi4.driver.energy" title="psi4.driver.energy"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy()</span></code></a>.
For example, <code class="docutils literal notranslate"><span class="pre">energy('adc(2)-x')</span></code> will compute
excitation energies at ADC(2)-x level.
Properties such as oscillator strengths, transition or state dipole moments
are available by calling the function <a class="reference internal" href="api/psi4.driver.properties.html#psi4.driver.properties" title="psi4.driver.properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">properties()</span></code></a>
with appropriate arguments.
Most commonly users will want to compute at least oscillator strengths
along with the excitation energies,
resulting in a call like <code class="docutils literal notranslate"><span class="pre">properties('adc(2)',</span> <span class="pre">properties=[&quot;oscillator_strength&quot;])</span></code>.</p>
</section>
<section id="running-adc-calculations">
<h2>Running ADC calculations<a class="headerlink" href="#running-adc-calculations" title="Link to this heading">¶</a></h2>
<p><em>Section author: Michael F. Herbst</em></p>
<p>Running an ADC calculation with <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> requires
the call to <a class="reference internal" href="api/psi4.driver.properties.html#psi4.driver.properties" title="psi4.driver.properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">properties()</span></code></a> as discussed above
as well as one or more mandatory keyword arguments.</p>
<p>The most important keyword argument is <a class="reference internal" href="autodoc_glossary_options_c.html#term-ROOTS_PER_IRREP-ADC"><span class="xref std std-term">ROOTS_PER_IRREP</span></a>,
which is an array with the number of excited states desired
for each irreducible representation. Most ADC methods
are only supported at C1 symmetry at the moment, such that
this option should in most cases be set to an array with a single
element only. For example one can run an ADC(2) calculation for 10
(singlet) excited states using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">roots_per_irrep</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">properties</span><span class="p">(</span><span class="s1">&#39;adc(2)&#39;</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;oscillator_strength&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">molecule</span></code> section was dropped for brevity.</p>
<p><strong>Selecting the excitation manifold.</strong>
To select between the possible excitation manifolds,
use the <a class="reference internal" href="autodoc_glossary_options_c.html#term-KIND-ADC"><span class="xref std std-term">KIND</span></a> keyword. For restricted references
by default only singlet excited states are computed,
corresponding to the keyword value <code class="docutils literal notranslate"><span class="pre">'singlet'</span></code>.
To compute triplet states, select <code class="docutils literal notranslate"><span class="pre">'triplet'</span></code>.
To compute both without making a spin distinction, select <code class="docutils literal notranslate"><span class="pre">'any'</span></code>.
The latter is default for unrestricted references.</p>
<p>The special <a class="reference internal" href="autodoc_glossary_options_c.html#term-KIND-ADC"><span class="xref std std-term">KIND</span></a> value <code class="docutils literal notranslate"><span class="pre">'spin_flip'</span></code> selects
a spin-flip computation where a simultaneous flip of spin
and excitation is performed. This is only available
for unrestricted references and not for <code class="docutils literal notranslate"><span class="pre">CVS-ADC(n)</span></code> methods,
see table <a class="reference internal" href="#table-adcsummary"><span class="std std-ref">ADC capabilities of Psi4</span></a>.</p>
<p><strong>Using the core-valence separation.</strong>
For tackling core-valence excitations using the <code class="docutils literal notranslate"><span class="pre">CVS-ADC(n)</span></code>
methods, the keyword argument <a class="reference internal" href="autodoc_glossary_options_c.html#term-NUM_CORE_ORBITALS-ADC"><span class="xref std std-term">NUM_CORE_ORBITALS</span></a>
is additionally required. It is used to specify the number of
(spatial) orbitals to put into the core space and thus select
as target orbitals for a core-valence excitation process.
A value of <code class="docutils literal notranslate"><span class="pre">2</span></code> indicates, for example,
that the two lowest-energy <span class="math notranslate nohighlight">\(\alpha\)</span> and the two
lowest-energy <span class="math notranslate nohighlight">\(\beta\)</span> orbitals are placed in the core space.
Since the implemented ADC procedures tackle the
lowest-energy excitations, the value should be specified
such that the targeted core orbital is just inside the core space.</p>
<p><em>Example:</em> Consider furane, <span class="math notranslate nohighlight">\(C_4H_4O\)</span>. In order to tackle
the oxygen 1s edge, <em>i.e</em> simulate a O 1s XAS spectrum, one may
just set <a class="reference internal" href="autodoc_glossary_options_c.html#term-NUM_CORE_ORBITALS-ADC"><span class="xref std std-term">NUM_CORE_ORBITALS</span></a> to <code class="docutils literal notranslate"><span class="pre">1</span></code>. This will select the
oxygen 1s orbital for the core space as it is energetically the lowest.
For C 1s core excitations the <a class="reference internal" href="autodoc_glossary_options_c.html#term-NUM_CORE_ORBITALS-ADC"><span class="xref std std-term">NUM_CORE_ORBITALS</span></a> value needs
to be set to <code class="docutils literal notranslate"><span class="pre">5</span></code>, such that both the O 1s and all four C 1s orbitals
are part of the core space.</p>
<p><strong>Other keywords and examples.</strong>
Apart from the mentioned keywords, the following are common:</p>
<section id="reference">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-REFERENCE-ADC"><span class="xref std std-term">REFERENCE</span></a><a class="headerlink" href="#reference" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Reference wavefunction type</p>
<ul class="simple">
<li><p><strong>Type</strong>: string</p></li>
<li><p><strong>Possible Values</strong>: RHF, UHF</p></li>
<li><p><strong>Default</strong>: RHF</p></li>
</ul>
</div></blockquote>
</section>
<section id="r-convergence">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-R_CONVERGENCE-ADC"><span class="xref std std-term">R_CONVERGENCE</span></a><a class="headerlink" href="#r-convergence" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Convergence threshold for ADC matrix diagonalisation. Negative values keep the * adcc default (1e-6)</p>
<ul class="simple">
<li><p><strong>Type</strong>: <a class="reference internal" href="notes_c.html#op-c-conv"><span class="std std-ref">conv double</span></a></p></li>
<li><p><strong>Default</strong>: -1</p></li>
</ul>
</div></blockquote>
</section>
<section id="num-guesses">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-NUM_GUESSES-ADC"><span class="xref std std-term">NUM_GUESSES</span></a><a class="headerlink" href="#num-guesses" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Number of guess vectors to generate and use. Negative values keep * the adcc default (currently 2 * ROOTS_PER_IRREP). This option is only available for the adcc backend.</p>
<ul class="simple">
<li><p><strong>Type</strong>: integer</p></li>
<li><p><strong>Default</strong>: -1</p></li>
</ul>
</div></blockquote>
</section>
<section id="cutoff-amps-print">
<h3><a class="reference internal" href="autodoc_glossary_options_c.html#term-CUTOFF_AMPS_PRINT-ADC"><span class="xref std std-term">CUTOFF_AMPS_PRINT</span></a><a class="headerlink" href="#cutoff-amps-print" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Tolerance for extracted or printed amplitudes. This option is only available for the adcc backend.</p>
<ul class="simple">
<li><p><strong>Type</strong>: double</p></li>
<li><p><strong>Default</strong>: 0.01</p></li>
</ul>
</div></blockquote>
<p>The full list is provided in appendix <a class="reference internal" href="autodir_psivariables/module__adc.html#apdx-adc-psivar"><span class="std std-ref">ADC</span></a>
and many more sample input files can be found in the adc and adcc
subfolders of <a class="extlink-source reference external" href="https://github.com/psi4/psi4/blob/master/samples">psi4/samples</a>.
Note, that not all keywords are supported by all backends.</p>
</section>
</section>
<section id="interface-to-adcc">
<span id="sec-interfaceadcc"></span><h2>Interface to adcc<a class="headerlink" href="#interface-to-adcc" title="Link to this heading">¶</a></h2>
<p><em>Code author: Michael F. Herbst</em></p>
<p><em>Section author: Michael F. Herbst</em></p>
<p>For most implemented ADC methods <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> relies
on an interface to the <a class="reference external" href="https://adc-connect.org">adcc</a> python package.
The approach of adcc is to directly diagonalise the
ADC matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> in an iterative diagonalisation
procedure, usually a Jacobi-preconditioned Davidson. Expensive parts
of the ADC matrix-vector product are precomputed and stored
in memory. This approach is general in the sense
that it can be applied to a large range of ADC methods and variants.
So far levels up to ADC(3) and CVS-ADC(3) are available
and additional approximations such as
<a class="reference internal" href="autodoc_glossary_options_c.html#term-FREEZE_CORE-GLOBALS"><span class="xref std std-term">FREEZE_CORE</span></a> and <a class="reference internal" href="autodoc_glossary_options_c.html#term-NUM_FROZEN_UOCC-GLOBALS"><span class="xref std std-term">NUM_FROZEN_UOCC</span></a>
are supported with all ADC methods using the adcc backend.</p>
<p>Currently adcc is only capable of performing in-core calculations,
for which, however, permutational symmetry and spin symmetry is taken
into account for both tensor computations and tensor storage.
Inside adcc some heuristic checks for overly excessive memory requirements
are implemented, resulting in a warning in case a
successful execution is unlikely. There are no guarantees for the memory
to be sufficient in case such a warning is not displayed.</p>
<p>More detailed documentation about adcc and its features can be found
at <a class="reference external" href="https://adc-connect.org">https://adc-connect.org</a>,
especially the <a class="reference external" href="https://adc-connect.org/latest/theory.html">theory section</a>.
If you are using adcc from <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> for your calculations,
please cite both <span style="font-family: Optima, sans-serif; text-transform: none;">P<span style="font-size: 82%;">SI</span>4</span> as well as adcc <a class="reference internal" href="bibliography.html#herbst2020" id="id7"><span>[Herbst2020]</span></a>
in your published work.</p>
<p><strong>The ADC wavefunction object.</strong>
After running the ADC calculation in adcc, the interface code sets
a number of variables in the returned <a class="reference internal" href="api/psi4.core.Wavefunction.html#psi4.core.Wavefunction" title="psi4.core.Wavefunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction</span></code></a>
in case they are computed.
In the following the <code class="docutils literal notranslate"><span class="pre">&lt;method&gt;</span></code> prefix refers to the ADC method (such as <code class="docutils literal notranslate"><span class="pre">adc(1)</span></code>,
<code class="docutils literal notranslate"><span class="pre">adc(3)</span></code>, <code class="docutils literal notranslate"><span class="pre">cvs-adc(2)-x</span></code>).</p>
<ul class="simple">
<li><p>Ground state energy terms like <code class="docutils literal notranslate"><span class="pre">MP2</span> <span class="pre">correlation</span> <span class="pre">energy</span></code>, <code class="docutils literal notranslate"><span class="pre">MP3</span> <span class="pre">correlation</span> <span class="pre">energy</span></code>,
<code class="docutils literal notranslate"><span class="pre">MP2</span> <span class="pre">total</span> <span class="pre">energy</span></code>, <code class="docutils literal notranslate"><span class="pre">MP3</span> <span class="pre">total</span> <span class="pre">energy</span></code>, <code class="docutils literal notranslate"><span class="pre">current</span> <span class="pre">correlation</span> <span class="pre">energy</span></code> and <code class="docutils literal notranslate"><span class="pre">current</span> <span class="pre">energy</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MP2</span> <span class="pre">dipole</span> <span class="pre">X</span></code> and the other components: Ground state dipole moments at MP(2) level.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">iterations</span></code>: The number of iterations the iterative solver required to converge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">excited</span> <span class="pre">states</span></code>: The number of excited states, which were computed.</p></li>
<li><p>More variables are summarized in <a class="reference internal" href="glossary_psivariables.html#apdx-psivariables-alpha"><span class="std std-ref">PSI Variables by Alpha</span></a>.</p></li>
</ul>
<p>The following attribute is set on returned wavefunctions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">adcc_state</span></code>: The <a class="reference external" href="https://adc-connect.org/q/excitedstates">adcc.ExcitedStates</a>
object used by adcc to store the ADC(n) excitation energies and all precomputed data
in the format used by adcc.
Provides direct access to analysis and plotting capabilities from adcc.
For example <code class="docutils literal notranslate"><span class="pre">adcc_state.plot_spectrum()</span></code> plots a broadened excited states spectrum
in matplotlib. See the <a class="reference external" href="https://adc-connect.org/latest/calculations.html">adcc calculations documentation</a>
for details.</p></li>
</ul>
<p><strong>Tips for convergence issues.</strong>
If you encounter convergence issues inside adcc, the following parameters
are worth tweaking:</p>
<ul class="simple">
<li><p><a class="reference internal" href="autodoc_glossary_options_c.html#term-MAX_NUM_VECS-ADC"><span class="xref std std-term">MAX_NUM_VECS</span></a>: Specifies the maximal number of subspace vectors
in the Jacobi-Davidson scheme before a restart occurs. The defaults are usually
good, but do not be shy to increase this value if you encounter convergence problems.</p></li>
<li><p><a class="reference internal" href="autodoc_glossary_options_c.html#term-NUM_GUESSES-ADC"><span class="xref std std-term">NUM_GUESSES</span></a>: By default adcc uses twice as many guess vectors as
states to be computed. Sometimes increasing this value by a few vectors can be helpful.
If you encounter a convergence to zero eigenvalues, than decreasing this parameter might
solve the problems.</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="index.html">
    <img class="logo" src="_static/psi4square.png" alt="Logo"/>
  </a></p>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" placeholder="&#xF002;" style="font-family:FontAwesome, Ariel"
                                       aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/></div>
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="sphinx-toc sphinxlocaltoc">
    <h3><a href="index.html">table of contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">ADC: Ab Initio Polarization Propagator</a><ul>
<li><a class="reference internal" href="#available-adc-methods">Available ADC methods</a></li>
<li><a class="reference internal" href="#running-adc-calculations">Running ADC calculations</a><ul>
<li><a class="reference internal" href="#reference"><span class="xref std std-term">REFERENCE</span></a></li>
<li><a class="reference internal" href="#r-convergence"><span class="xref std std-term">R_CONVERGENCE</span></a></li>
<li><a class="reference internal" href="#num-guesses"><span class="xref std std-term">NUM_GUESSES</span></a></li>
<li><a class="reference internal" href="#cutoff-amps-print"><span class="xref std std-term">CUTOFF_AMPS_PRINT</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#interface-to-adcc">Interface to adcc</a></li>
</ul>
</li>
</ul>

  </div>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >Index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="relativistic.html" title="Scalar relativistic Hamiltonians"
             ><i class="fa fa-long-arrow-right fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="fisapt.html" title="F/I-SAPT: Functional Group and/or Intramolecular SAPT"
             ><i class="fa fa-long-arrow-left fa-lg"></i></a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="index.html" title="Table Of Contents"
             ><i class="fa fa-book fa-lg"></i></a> &nbsp; &nbsp;</li>
    <li><a href="http://psicode.org/"><i class="fa fa-home fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4"><i class="fa fa-github fa-lg"></i></a></li>
    <li><a href="http://forum.psicode.org"><i class="fa fa-comments-o fa-lg"></i></a></li>
    <li><a href="http://github.com/psi4/psi4/edit/master/doc/sphinxman/source/adc.rst"><i class="fa fa-pencil fa-lg"></i></a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li><a href="http://github.com/psi4/psi4/tree/f2492db">1.10</a></li>
    <li style="color: #1a4162">&nbsp;&middot;&nbsp;</li>
    <li class="nav-item nav-item-0"><a href="index.html">
        <span style="font-family: Optima, sans-serif;">P<span style="font-size: 82%;">SI</span>4</span>
        </a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>

          <li class="nav-item nav-item-1"><a href="methods.html" >Theoretical Methods: SCF to FCI</a><i class="fa fa-angle-double-right" style="color: #a2a7b3; text-shadow: none;"></i></li>
        <li class="nav-item nav-item-this"><a href="">ADC: Ab Initio Polarization Propagator</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2007-2025, The Psi4 Project.
      Last updated on Sunday, 07 September 2025 02:48AM.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>